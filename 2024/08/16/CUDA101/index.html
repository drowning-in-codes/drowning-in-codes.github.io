<!doctypehtml><html lang=zh-CN><script defer src=/live2d-widget/autoload.js></script><meta charset=UTF-8><meta content=width=device-width,initial-scale=1,maximum-scale=2 name=viewport><meta content=#222 name=theme-color><meta content="Hexo 5.4.0" name=generator><link href=/images/blog_32px.png rel=apple-touch-icon sizes=180x180><link href=/images/blog_32px.png rel=icon sizes=32x32 type=image/png><link href=/images/blog_16px.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><meta content=EPrJAp11bJwHULpQUaSNSZ8_3RcvTsPDAEGOME4pl1w name=google-site-verification><!-- Google tag (gtag.js) --><!-- 
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VB21D8MKKW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VB21D8MKKW');
</script> --><!-- google adsense in head.swig --><script async crossorigin=anonymous src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4034523802263123></script><meta content=7226864CE87CE9DE8C008385273846FF name=msvalidate.01><meta content=code-fjFXVtiL7j name=baidu-site-verification><link href=/css/main.css rel=stylesheet><link as=style href=https://fonts.googleapis.com/css?family=Roboto%20Mono,Roboto:300,300italic,400,400italic,700,700italic|Roboto:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext onload=this.rel='stylesheet' rel=preload><link as=style href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css onload=this.rel='stylesheet' rel=preload><link href=https://fonts.googleapis.com/css?family=Noto+Serif+SC|Roboto&display=swap rel=stylesheet><link href=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/pace-js@1/pace.min.js></script><script id=hexo-configurations>var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.sekyoro.top","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","width":240,"display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"appID":"0F9LEEVW82","apiKey":"78839e9f9be09d081c5c4da81975cd19","indexName":"sekyoblog_sec","hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"manual","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};</script><link href=//cdn.bootcss.com/animate.css/3.5.0/animate.min.css rel=stylesheet><meta content=ä½œä¸ºæ—¢å¯¹AIåˆå¯¹sysã€hpcæ„Ÿå…´è¶£çš„äººæ¥è¯´,cudaç¼–ç¨‹åº”è¯¥æ˜¯ä¸å¯ä¸çœ‹çš„,æˆ‘ä¹Ÿæ—©æœ‰è€³é—».è¿™é‡Œç®€å•å­¦ä¹ ä¸€ä¸‹. name=description><meta content=article property=og:type><meta content=CUDA101 property=og:title><meta content=https://www.sekyoro.top/2024/08/16/CUDA101/index.html property=og:url><meta content=Sekyoroçš„åšå®¢å°å±‹ property=og:site_name><meta content=ä½œä¸ºæ—¢å¯¹AIåˆå¯¹sysã€hpcæ„Ÿå…´è¶£çš„äººæ¥è¯´,cudaç¼–ç¨‹åº”è¯¥æ˜¯ä¸å¯ä¸çœ‹çš„,æˆ‘ä¹Ÿæ—©æœ‰è€³é—».è¿™é‡Œç®€å•å­¦ä¹ ä¸€ä¸‹. property=og:description><meta content=zh_CN property=og:locale><meta content=https://media.geeksforgeeks.org/wp-content/uploads/20211007112954/UntitledDiagram1.jpg property=og:image><meta content=https://cuda-tutorial.readthedocs.io/en/latest/tutorials/tutorial02/01_parallel_thread.png property=og:image><meta content=https://cuda-tutorial.readthedocs.io/en/latest/tutorials/tutorial02/02_parallel_block.png property=og:image><meta content=2024-08-16T10:23:41.000Z property=article:published_time><meta content=2024-08-29T12:43:37.000Z property=article:modified_time><meta content=Sekyoro property=article:author><meta content=cuda property=article:tag><meta content=summary name=twitter:card><meta content=https://media.geeksforgeeks.org/wp-content/uploads/20211007112954/UntitledDiagram1.jpg name=twitter:image><link href=https://www.sekyoro.top/2024/08/16/CUDA101/ rel=canonical><script id=page-configurations>// https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };</script><title>CUDA101 | Sekyoroçš„åšå®¢å°å±‹</title><noscript><style>.use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }</style></noscript><link href=/atom.xml rel=alternate title=Sekyoroçš„åšå®¢å°å±‹ type=application/atom+xml><body itemscope itemtype=http://schema.org/WebPage><canvas style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" class=fireworks></canvas><script defer src=https://cdn.bootcss.com/animejs/2.2.0/anime.min.js></script><script defer src=/js/src/fireworks.js></script><div class="container use-motion"><div class=headband></div><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div aria-label=åˆ‡æ¢å¯¼èˆªæ  class=toggle><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <span class=logo-line-before><i></i></span> <h1 class=site-title>Sekyoroçš„åšå®¢å°å±‹</h1> <span class=logo-line-after><i></i></span> </a></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu" id=menu><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>å…³äº</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a><li class="menu-item menu-item-bangumis"><a href=/bangumis/ rel=section><i class="fa fa-film fa-fw"></i>è¿½ç•ª</a><li class="menu-item menu-item-resume"><a href=/resume/ rel=section><i class="fa fa-file-pdf fa-fw"></i>ç®€å†</a><li class="menu-item menu-item-materials"><a href=/materials/ rel=section><i class="fa fa-book fa-fw"></i>å­¦ä¹ èµ„æ–™</a><li class="menu-item menu-item-sitemap"><a href=/sitemap.xml rel=section><i class="fa fa-sitemap fa-fw"></i>ç«™ç‚¹åœ°å›¾</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>æœç´¢ </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container></div><span class=popup-btn-close> <i class="fa fa-times-circle"></i> </span></div><div class=algolia-results><div id=algolia-stats></div><div id=algolia-hits></div><div class=algolia-pagination id=algolia-pagination></div></div></div></div></div></header><a class="book-mark-link book-mark-link-fixed" role=button></a><main class=main><div class=main-inner><div class=content-wrap><div class="content post posts-expand"><article class=post-block itemscope itemtype=http://schema.org/Article lang=zh-CN><link href=https://www.sekyoro.top/2024/08/16/CUDA101/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=https://i.loli.net/2021/05/17/YqoavnXdGTpPO9R.jpg itemprop=image> <meta content=Sekyoro itemprop=name> <meta content=ä»€ä¹ˆä¹Ÿæ— æ³•èˆå¼ƒçš„äººï¼Œä»€ä¹ˆä¹Ÿåšä¸äº†. itemprop=description> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=Sekyoroçš„åšå®¢å°å±‹ itemprop=name> </span><header class=post-header><h1 itemprop="name headline" class=post-title>CUDA101</h1><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>å‘è¡¨äº</span> <time itemprop="dateCreated datePublished" title="åˆ›å»ºæ—¶é—´ï¼š2024-08-16 18:23:41" datetime=2024-08-16T18:23:41+08:00>2024-08-16</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-08-29 20:43:37" datetime=2024-08-29T20:43:37+08:00 itemprop=dateModified>2024-08-29</time> </span><span style="display: none;" class=post-meta-item id=busuanzi_container_page_pv title=é˜…è¯»æ¬¡æ•°> <span class=post-meta-item-icon> <i class="fa fa-eye"></i> </span> <span class=post-meta-item-text>é˜…è¯»æ¬¡æ•°ï¼š</span> <span id=busuanzi_value_page_pv></span> </span><br><span class=post-meta-item title=æœ¬æ–‡å­—æ•°> <span class=post-meta-item-icon> <i class="far fa-file-word"></i> </span> <span class=post-meta-item-text>æœ¬æ–‡å­—æ•°ï¼š</span> <span>6.7k</span> </span><span class=post-meta-item title=é˜…è¯»æ—¶é•¿> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>é˜…è¯»æ—¶é•¿ â‰ˆ</span> <span>6 åˆ†é’Ÿ</span> </span></div></header><div class=post-body itemprop=articleBody><p>ä½œä¸ºæ—¢å¯¹AIåˆå¯¹sysã€hpcæ„Ÿå…´è¶£çš„äººæ¥è¯´,cudaç¼–ç¨‹åº”è¯¥æ˜¯ä¸å¯ä¸çœ‹çš„,æˆ‘ä¹Ÿæ—©æœ‰è€³é—».è¿™é‡Œç®€å•å­¦ä¹ ä¸€ä¸‹.<br><span id=more></span><p>ç›®å‰AIå¤§æ¨¡å‹çš„æ¨ç†ä»¥åŠAI+HPCã€æ·±åº¦å­¦ä¹ ç³»ç»Ÿæ„å»ºç­‰éƒ½éœ€è¦äº†è§£cudaä»¥åŠä½¿ç”¨cudaç¼–ç¨‹,é€šè¿‡ä½¿ç”¨cudaã€c++ä»¥åŠpybindå†™ä¸€äº›æ·±åº¦å­¦ä¹ ç®—å­ç­‰æå‡è¿è¡Œé€Ÿåº¦éƒ½æ˜¯ä¸€äº›å¸¸è§åº”ç”¨é€”å¾„.<h2 id=ä»‹ç»CUDA><a class=headerlink href=#ä»‹ç»CUDA title=ä»‹ç»CUDA></a>ä»‹ç»CUDA</h2><blockquote><p><a href=https://www.geeksforgeeks.org/how-to-run-cuda-c-c-on-jupyter-notebook-in-google-colaboratory/ rel=noopener target=_blank>CUDA</a> stands for Compute Unified Device Architecture. It is an extension of C/C++ programming. CUDA is a programming language that uses the Graphical Processing Unit (GPU). It is a parallel computing platform and an API (Application Programming Interface) model, Compute Unified Device Architecture was developed by Nvidia. This allows computations to be performed in parallel while providing well-formed speed. Using CUDA, one can harness the power of the Nvidia GPU to perform common computing tasks, such as processing matrices and other linear algebra operations, rather than simply performing graphical calculations.</blockquote><p><img alt=img data-src=https://media.geeksforgeeks.org/wp-content/uploads/20211007112954/UntitledDiagram1.jpg style=zoom:67%;><ul><li>ä¸Šå›¾å±•ç¤ºäº†16ä¸ªå¹¶è¡Œ(æµ)å¤š(streaming multiprocessor)å¤„ç†å—(digrams)<li>æ¯ä¸ªå¹¶è¡Œå¤šå¤„ç†å—æœ‰8ä¸ªå¹¶è¡Œå¤„ç†å™¨(streanming processors),æ‰€ä»¥ä¸€å…±128ä¸ªå¹¶è¡Œå¤„ç†å™¨<li>æ¯ä¸ªå¹¶è¡Œå¤„ç†å™¨æœ‰ä¸€ä¸ªä¹˜åŠ å•å…ƒ (Multiplication and Addition Unit)å’Œä¸€ä¸ªåŠ å•å…ƒ(multiplication unit).<li>ä¸€å¼ GT200æ˜¾å¡æœ‰30ä¸ªå¹¶è¡Œå¤šå¤„ç†å™¨,æ¯ä¸ªå¤„ç†å™¨æœ‰8ä¸ªå¹¶è¡Œå¤„ç†å™¨,æ‰€ä»¥ä¸€å…±240ä¸ªå¹¶è¡Œå¤„ç†å™¨,æœ‰å¤šä½™1çš„TFLOPå¤„ç†èƒ½åŠ›<li>æ¯ä¸ªæµå¤„ç†å™¨éƒ½æ˜¯çº¿ç¨‹ï¼Œæ¯ä¸ªåº”ç”¨ç¨‹åºå¯ä»¥è¿è¡Œæ•°åƒä¸ªçº¿ç¨‹<li>G80å¡æœ‰16ä¸ªæµå¤šå¤„ç†å™¨(SMs)ï¼Œæ¯ä¸ªSMæœ‰8ä¸ªæµå¤„ç†å™¨(SPs)ï¼Œå³æ€»å…±128ä¸ªSPsï¼Œæ¯ä¸ªæµå¤šå¤„ç†å™¨æ”¯æŒ768ä¸ªçº¿ç¨‹(æ³¨æ„:ä¸æ˜¯æ¯ä¸ªSP)ã€‚<li>æœ€ç»ˆï¼Œæ¯ä¸ªæµå¼å¤šå¤„ç†å™¨æœ‰ 8 ä¸ª SP åï¼Œæ¯ä¸ª SP æœ€å¤šæ”¯æŒ <strong>768/8 = 96 ä¸ªçº¿ç¨‹</strong>ã€‚å¯åœ¨ 128 ä¸ª SP ä¸Šè¿è¡Œçš„çº¿ç¨‹æ€»æ•° - 128* 96 = 12 228 æ¬¡(=16*768)<li>å› æ­¤ï¼Œè¿™äº›å¤„ç†å™¨è¢«ç§°ä¸ºå¤§è§„æ¨¡å¹¶è¡Œå¤„ç†å™¨(massively parallel)ã€‚<li>G80 èŠ¯ç‰‡çš„å†…å­˜å¸¦å®½ä¸º 86.4GB/sã€‚<li>G80 èŠ¯ç‰‡çš„å†…å­˜å¸¦å®½ä¸º 86.4GB/sï¼Œä¸ CPU ä¹‹é—´çš„é€šä¿¡é€šé“ä¸º 8GB/sï¼ˆ4GB/s ä¸Šä¼ åˆ° CPU RAMï¼Œ4GB/s ä» CPU RAM ä¸‹è½½ï¼‰ã€‚</ul><h4 id=CUDAå·¥ä½œ><a class=headerlink href=#CUDAå·¥ä½œ title=CUDAå·¥ä½œ></a>CUDAå·¥ä½œ</h4><ul><li>GPU ä¸€æ¬¡è¿è¡Œä¸€ä¸ªå†…æ ¸ï¼ˆä¸€ç»„ä»»åŠ¡ï¼‰ã€‚<li>æ¯ä¸ªå†…æ ¸ç”±ç‹¬ç«‹çš„ ALU ç»„å—ç»„æˆã€‚<li>æ¯ä¸ªåŒºå—åŒ…å«çº¿ç¨‹ï¼Œçº¿ç¨‹æ˜¯è®¡ç®—çš„å±‚æ¬¡ã€‚<li>æ¯ä¸ªå—ä¸­çš„çº¿ç¨‹é€šå¸¸å…±åŒè®¡ç®—ä¸€ä¸ªå€¼ã€‚<li>åŒä¸€åŒºå—ä¸­çš„çº¿ç¨‹å¯ä»¥å…±äº«å†…å­˜ã€‚<li>åœ¨ CUDA ä¸­ï¼Œä» CPU å‘ GPU å‘é€ä¿¡æ¯é€šå¸¸æ˜¯è®¡ç®—ä¸­æœ€å…¸å‹çš„éƒ¨åˆ†ã€‚<li>å¯¹æ¯ä¸ªçº¿ç¨‹è€Œè¨€ï¼Œæœ¬åœ°å†…å­˜é€Ÿåº¦æœ€å¿«ï¼Œå…±äº«å†…å­˜æ¬¡ä¹‹ï¼Œå…¨å±€ã€é™æ€å’Œçº¹ç†å†…å­˜é€Ÿåº¦æœ€æ…¢ã€‚</ul><h4 id=CUDAä»¥åŠå·¥ä½œæµç¨‹><a class=headerlink href=#CUDAä»¥åŠå·¥ä½œæµç¨‹ title=CUDAä»¥åŠå·¥ä½œæµç¨‹></a>CUDAä»¥åŠå·¥ä½œæµç¨‹</h4><ul><li>å°†æ•°æ®åŠ è½½åˆ° CPU å†…å­˜<li>å°†æ•°æ®ä» CPU å¤åˆ¶åˆ° GPU å†…å­˜ - ä¾‹å¦‚ï¼ŒcudaMemcpy(â€¦, cudaMemcpyHostToDevice)<li>ä½¿ç”¨è®¾å¤‡å˜é‡è°ƒç”¨ GPU å†…æ ¸ - ä¾‹å¦‚ï¼Œkernel<<<>> (gpuVar)<li>å°†ç»“æœä» GPU å¤åˆ¶åˆ° CPU å†…å­˜ - ä¾‹å¦‚ï¼ŒcudaMemcpy(â€¦, cudaMemcpyDeviceToHost)<li>åœ¨ CPU ä¸Šä½¿ç”¨ç»“æœ</ul><h2 id=ç¼–å†™CUDAä»£ç ><a class=headerlink href=#ç¼–å†™CUDAä»£ç  title=ç¼–å†™CUDAä»£ç ></a>ç¼–å†™CUDAä»£ç </h2><p>éœ€è¦åœ¨Nvidiaæ˜¾å¡ä¸‹å®‰è£…cudatoolkit,ä»¥ä½¿ç”¨nvccç¼–è¯‘å™¨å’Œä¸€äº›åº“.<figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br></pre><td class=code><pre><span class=line>__global__ void cuda_hello(){</span><br><span class=line>    printf("Hello World from GPU!\n");</span><br><span class=line>}</span><br><span class=line></span><br><span class=line>int main() {</span><br><span class=line>    cuda_hello<<&LT1,1>>>(); </span><br><span class=line>    return 0;</span><br><span class=line>}</span><br></pre></table></figure><p>_<em>global_</em>è¯´æ˜ç¬¦è¡¨ç¤ºåœ¨è®¾å¤‡(GPU)ä¸Šè¿è¡Œçš„å‡½æ•°.è¿™æ ·çš„å‡½æ•°å¯ä»¥é€šè¿‡å®¿ä¸»ä»£ç è°ƒç”¨,ä¾‹å¦‚ç¤ºä¾‹ä¸­çš„main()å‡½æ•°,ä¹Ÿè¢«ç§°ä¸ºâ€œ<em>kernel</em>â€<p>å½“è°ƒç”¨å†…æ ¸æ—¶ï¼Œå®ƒçš„æ‰§è¡Œé…ç½®é€šè¿‡<<<â€¦>>>è¯­æ³•ï¼Œä¾‹å¦‚cuda_hello<<<1 ,1>>>()ã€‚åœ¨CUDAæœ¯è¯­ä¸­ï¼Œè¿™è¢«ç§°ä¸ºâ€œ<em>kernel launch</em>â€ <p>CPUå’ŒGPUæ˜¯ç‹¬ç«‹çš„å®ä½“ã€‚å®ƒä»¬éƒ½æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´ã€‚CPUä¸èƒ½ç›´æ¥è®¿é—®GPUå†…å­˜ï¼Œåä¹‹äº¦ç„¶ã€‚åœ¨CUDAæœ¯è¯­ä¸­ï¼ŒCPUå†…å­˜ç§°ä¸ºä¸»æœºå†…å­˜ï¼ŒGPUå†…å­˜ç§°ä¸ºè®¾å¤‡å†…å­˜ã€‚æŒ‡å‘CPUå’ŒGPUå†…å­˜çš„æŒ‡é’ˆåˆ†åˆ«ç§°ä¸ºä¸»æœºæŒ‡é’ˆå’Œè®¾å¤‡æŒ‡é’ˆ.</p> <p>å¯¹äºGPUå¯ä»¥è®¿é—®çš„æ•°æ®ï¼Œå®ƒå¿…é¡»å‘ˆç°åœ¨è®¾å¤‡å†…å­˜ä¸­ã€‚CUDAæä¾›äº†ç”¨äºåˆ†é…è®¾å¤‡å†…å­˜å’Œä¸»æœºä¸è®¾å¤‡å†…å­˜ä¹‹é—´æ•°æ®ä¼ è¾“çš„apiã€‚</p> <ol><li>åˆ†ä¸ºå®¿ä¸»å†…å­˜ç»™å®¿ä¸»æ•°æ®<li>åˆ†é…è®¾å¤‡å†…å­˜<li>å°†è¾“å…¥æ•°æ®ä»å®¿ä¸»å†…å­˜è½¬åˆ°è®¾å¤‡å†…å­˜<li>æ‰§è¡Œkernels(_<em>global\</em>_æ ‡è¯† )<li>å°†è¾“å‡ºä»è®¾å¤‡è½¬ç§»åˆ°å®¿ä¸»</ol> <p>CUDAæä¾›äº†å‡ ä¸ªç”¨äºåˆ†é…è®¾å¤‡å†…å­˜çš„å‡½æ•°ã€‚æœ€å¸¸è§çš„æ˜¯<code>cudaMalloc()</code>å’Œ<code>cudaFree()</code></p> <p>åˆ†é…äº†GPUå†…å­˜åéœ€è¦å°†cpuå†…å­˜ä¸Šçš„æ•°æ®copyåˆ°è®¾å¤‡ä¸Š,åˆ©ç”¨<code>cudaMemcpy</code></p> <p>ç„¶åè°ƒç”¨kernel(å†…æ ¸æ‰§è¡Œé…ç½®<<1 ,1>>>è¡¨ç¤ºå†…æ ¸å¯åŠ¨æ—¶åªæœ‰1ä¸ªçº¿ç¨‹),åœ¨è®¾å¤‡ä¸Šæ‰§è¡Œ,æœ€åè¿›è¡Œfree<code>cudaFree(void *devPtr);</code> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line>cudaMalloc(void **devPtr, size_t count);</span><br><span class=line>cudaFree(void *devPtr);</span><br><span class=line>cudaMemcpy(void *dst, void *src, size_t count, cudaMemcpyKind kind)</span><br></pre></table></figure> <h4 id=æ€§èƒ½è¯„ä¼°><a class=headerlink href=#æ€§èƒ½è¯„ä¼° title=æ€§èƒ½è¯„ä¼°></a>æ€§èƒ½è¯„ä¼°</h4><p>NVIDIAæä¾›äº†ä¸€ä¸ªåä¸ºnvprofçš„å‘½ä»¤è¡Œåˆ†æå™¨å·¥å…·ï¼Œå®ƒå¯ä»¥æ›´æ·±å…¥åœ°äº†è§£CUDAç¨‹åºçš„æ€§èƒ½ã€‚</p> <p>CUDAä½¿ç”¨å†…æ ¸æ‰§è¡Œé…ç½®<<<â€¦>>>å‘Šè¯‰CUDA<strong>è¿è¡Œæ—¶åœ¨GPUä¸Šå¯åŠ¨å¤šå°‘çº¿ç¨‹</strong></p> <p>CUDAå°†çº¿ç¨‹ç»„ç»‡æˆä¸€ä¸ªç§°ä¸ºâ€œthread blockâ€çš„ç»„ã€‚å†…æ ¸å¯ä»¥å¯åŠ¨å¤šä¸ªçº¿ç¨‹å—ï¼Œç»„ç»‡æˆä¸€ä¸ªâ€œgridâ€ç»“æ„ã€‚</p> <figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line><<< <span class=string>M , T >>></span></span><br></pre></table></figure> <p>è¡¨ç¤ºå¯åŠ¨Mä¸ªçº¿ç¨‹å—,æ¯ä¸ªçº¿ç¨‹å—åŒ…æ‹¬Tä¸ªçº¿ç¨‹.</p> <h4 id=thread><a class=headerlink href=#thread title=thread></a>thread</h4><p>CUDAä¸ºè®¿é—®çº¿ç¨‹ä¿¡æ¯æä¾›äº†å†…ç½®å˜é‡ã€‚å…¶ä¸­çš„<code>threadIdx.x</code>å’Œ<code>blockDim.x</code>åˆ†åˆ«è¡¨ç¤º,ä¸€ä¸ªå—å†…çº¿ç¨‹çš„ç´¢å¼•ä»¥åŠä¸€ä¸ªå—ä¸­çº¿ç¨‹æ•°é‡.</p> <p>å‡è®¾åœ¨ä¸€ä¸ªå—å†…çš„å¤šä¸ªçº¿ç¨‹æ‰§è¡Œå¹¶è¡Œç¨‹åº.</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br></pre><td class=code><pre><span class=line>__global__ void vector_add(float *out, float *a, float *b, int n) {</span><br><span class=line>    int index = 0;</span><br><span class=line>    int stride = 1</span><br><span class=line>    for(int i = index; i < n; i += stride){</span><br><span class=line>        out[i] = a[i] + b[i];</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure> <p><img alt="parallel thread" data-src=https://cuda-tutorial.readthedocs.io/en/latest/tutorials/tutorial02/01_parallel_thread.png></p> <p>å‡è®¾Nä¸ªæ•°æ®,ä¸€å…±256ä¸ªçº¿ç¨‹,é‚£ä¹ˆå¯¹äºç¬¬kä¸ªçº¿ç¨‹,å®ƒä¼šæ‰§è¡ŒN/256æ¬¡iteration,æ¯æ¬¡æ‰§è¡Œkernelä¸­çš„ä»£ç </p> <h4 id=thread-blocks><a title="thread blocks" class=headerlink href=#thread-blocks></a>thread blocks</h4><p>CUDA gpuæœ‰å‡ ä¸ªå¹¶è¡Œå¤„ç†å™¨ï¼Œç§°ä¸ºæµå¤šå¤„ç†å™¨æˆ–SMsã€‚æ¯ä¸ªSMç”±å¤šä¸ªå¹¶è¡Œå¤„ç†å™¨ç»„æˆï¼Œå¯ä»¥è¿è¡Œå¤šä¸ªå¹¶å‘çº¿ç¨‹å—ã€‚ä¸ºäº†åˆ©ç”¨CUDA gpuï¼Œå†…æ ¸åº”è¯¥å¯åŠ¨å¤šä¸ªçº¿ç¨‹å—ã€‚</p> <p>å¯¹äºblock,æœ‰<code>blockIdx.x</code>ä»¥åŠ<code>gridDim.x</code>åˆ†åˆ«è¡¨ç¤ºå—ç´¢å¼•å’Œå—çš„æ•°é‡.</p> <p><img alt="parallel block" data-src=https://cuda-tutorial.readthedocs.io/en/latest/tutorials/tutorial02/02_parallel_block.png></p> <p>è¦å°†çº¿ç¨‹åˆ†é…ç»™ç‰¹å®šå…ƒç´ ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“æ¯ä¸ªçº¿ç¨‹çš„å”¯ä¸€ç´¢å¼•ã€‚è¯¥æŒ‡æ•°å¯è®¡ç®—å¦‚ä¸‹</p> <figure class="highlight llvm"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>int tid <span class=operator>=</span> blockIdx.<span class=keyword>x</span> * blockDim.<span class=keyword>x</span> + threadaddx.<span class=keyword>x</span></span><br></pre></table></figure> <p>ä¸ºäº†åˆ©ç”¨å¹¶è¡Œå¤šçº¿ç¨‹çš„ä¼˜åŠ¿(å¦åˆ™å°±æ˜¯å¤šä¸ªçº¿ç¨‹è®¡ç®—ç›¸åŒçš„ä»£ç ),éœ€è¦å°†å¯¹åº”çš„æ•°æ®ç´¢å¼•ä¿®æ”¹ä¸ºçº¿ç¨‹çš„ç´¢å¼•.</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br></pre><td class=code><pre><span class=line>#include &LTiostream></span><br><span class=line>#define N 100000</span><br><span class=line>__global__ void addOfblocks(int n, float *x, float *y) {</span><br><span class=line>  int idx = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class=line>  int stride = blockDim.x * gridDim.x;</span><br><span class=line>  for (int i = idx; i < n; i += stride) y[i] = x[i] + y[i];</span><br><span class=line>}</span><br><span class=line>__global__ void addOfThreads(int n, float *x, float *y) {</span><br><span class=line>  int idx = threadIdx.x;</span><br><span class=line>  int stride = blockDim.x;</span><br><span class=line>  for (int i = idx; i < n; i += blockDim) y[i] = x[i] + y[i];</span><br><span class=line>}</span><br><span class=line>int main() {</span><br><span class=line>  float *a, *out;</span><br><span class=line></span><br><span class=line>  cudaMallocManaged(&a, N * sizeof(float));</span><br><span class=line>  cudaMallocManaged(&out, N * sizeof(float));</span><br><span class=line>  for (int i = 0; i < N; i++) {</span><br><span class=line>    a[i] = 2;</span><br><span class=line>    b[i] = 4;</span><br><span class=line>  }</span><br><span class=line></span><br><span class=line>  add<<&LT2, 4>>>(N, a, b);</span><br><span class=line>  cudaDeviceSynchronize();</span><br><span class=line></span><br><span class=line>  cudaFree(a);</span><br><span class=line>  cudaFree(b);</span><br><span class=line>  return 0;</span><br><span class=line>}</span><br></pre></table></figure> <h2 id=ä¸€äº›ä¾‹å­><a class=headerlink href=#ä¸€äº›ä¾‹å­ title=ä¸€äº›ä¾‹å­></a>ä¸€äº›ä¾‹å­</h2><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br></pre><td class=code><pre><span class=line>#include &LTiostream></span><br><span class=line>#define N 10000000</span><br><span class=line>__global__ void vector_add(float* out, float* a, float* b, int n) {</span><br><span class=line>  int stride = 1;</span><br><span class=line>  for (int i = 0; i < n; i += stride) {</span><br><span class=line>    out[i] = a[i] + b[i];</span><br><span class=line>  }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line>__global__ void cuda_hello() {</span><br><span class=line>  printf("Hello from block %d, thread %d\n", blockDim.x, threadIdx.x);</span><br><span class=line>}</span><br><span class=line>int main() {</span><br><span class=line>  cuda_hello<<&LT1, 4>>>();</span><br><span class=line>  float *a, *b, *out;</span><br><span class=line>  float *d_a, *d_b, *d_out;</span><br><span class=line>  a = (float*)malloc(N * sizeof(float));</span><br><span class=line>  b = (float*)malloc(N * sizeof(float));</span><br><span class=line>  for (int i = 0; i < N; i++) {</span><br><span class=line>    a[i] = 2;</span><br><span class=line>  }</span><br><span class=line>  for (int i = 0; i < N; i++) {</span><br><span class=line>    b[i] = 4;</span><br><span class=line>  }</span><br><span class=line>  out = (float*)malloc(N * sizeof(float));</span><br><span class=line>  cudaMalloc((void**)&d_b, sizeof(float) * N);</span><br><span class=line>  cudaMemcpy(d_b, b, sizeof(float) * N, cudaMemcpyHostToDevice);</span><br><span class=line></span><br><span class=line>  cudaMalloc((void**)&d_out, sizeof(float) * N);</span><br><span class=line>  cudaMemcpy(d_out, out, sizeof(float) * N, cudaMemcpyHostToDevice);</span><br><span class=line></span><br><span class=line>  cudaMalloc((void**)&d_a, sizeof(float) * N);</span><br><span class=line>  cudaMemcpy(d_a, a, sizeof(float) * N, cudaMemcpyHostToDevice);</span><br><span class=line>  vector_add<<&LT1, 1>>>(d_out, d_a, d_b, N);</span><br><span class=line>  cudaMemcpy(out, d_out, sizeof(float) * N, cudaMemcpyDeviceToHost);</span><br><span class=line>  printf("out[0] = %f\n", out[0]);</span><br><span class=line>  cudaFree(d_a);</span><br><span class=line>  free(a);</span><br><span class=line>  return 0;</span><br><span class=line>}</span><br></pre></table></figure> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br></pre><td class=code><pre><span class=line>#include &LTmath.h></span><br><span class=line></span><br><span class=line>#include &LTiostream></span><br><span class=line>// Kernel function to add the elements of two arrays</span><br><span class=line>__global__ void add(int n, float *x, float *y) {</span><br><span class=line>  int idx = threadIdx.x;</span><br><span class=line>  int stride = blockDim.x;</span><br><span class=line>  for (int i = idx; i < n; i+=stride) y[i] = x[i] + y[i];</span><br><span class=line>}</span><br><span class=line></span><br><span class=line>int main(void) {</span><br><span class=line>  int N = 1 << 20;</span><br><span class=line>  float *x, *y;</span><br><span class=line></span><br><span class=line>  // Allocate Unified Memory â€“ accessible from CPU or GPU</span><br><span class=line>  cudaMallocManaged(&x, N * sizeof(float));</span><br><span class=line>  cudaMallocManaged(&y, N * sizeof(float));</span><br><span class=line></span><br><span class=line>  // initialize x and y arrays on the host</span><br><span class=line>  for (int i = 0; i < N; i++) {</span><br><span class=line>    x[i] = 1.0f;</span><br><span class=line>    y[i] = 2.0f;</span><br><span class=line>  }</span><br><span class=line></span><br><span class=line>  // Run kernel on 1M elements on the GPU</span><br><span class=line>  add<<&LT1, 1>>>(N, x, y);</span><br><span class=line></span><br><span class=line>  // Wait for GPU to finish before accessing on host</span><br><span class=line>  cudaDeviceSynchronize();</span><br><span class=line></span><br><span class=line>  // Check for errors (all values should be 3.0f)</span><br><span class=line>  float maxError = 0.0f;</span><br><span class=line>  for (int i = 0; i < N; i++) maxError = fmax(maxError, fabs(y[i] - 3.0f));</span><br><span class=line>  std::cout << "Max error: " << maxError << std::endl;</span><br><span class=line></span><br><span class=line>  // Free memory</span><br><span class=line>  cudaFree(x);</span><br><span class=line>  cudaFree(y);</span><br><span class=line></span><br><span class=line>  return 0;</span><br><span class=line>}</span><br></pre></table></figure> <h3 id=å­¦ä¹ èµ„æ–™><a class=headerlink href=#å­¦ä¹ èµ„æ–™ title=å­¦ä¹ èµ„æ–™></a>å­¦ä¹ èµ„æ–™</h3><ol><li><a href=https://github.com/cuda-mode/lectures?tab=readme-ov-file rel=noopener target=_blank>cuda-mode/lectures: Material for cuda-mode lectures (github.com)</a><li><a href=https://github.com/CodedK/CUDA-by-Example-source-code-for-the-book-s-examples-/tree/master rel=noopener target=_blank>CodedK/CUDA-by-Example-source-code-for-the-book-s-examples-: CUDA by Example, written by two senior members of the CUDA software platform team, shows programmers how to employ this new technology. The authors introduce each area of CUDA development through working examples. (github.com)</a><li><a href=https://gist.github.com/diorahman/648478c2c5c24d819f0f rel=noopener target=_blank>CUDA Books: Self taught (github.com)</a> maybe this is what all we need.<li><a href=https://developer.nvidia.com/blog/even-easier-introduction-cuda/ rel=noopener target=_blank>An Even Easier Introduction to CUDA | NVIDIA Technical Blog</a><li><a href=https://github.com/whutbd/cuda-learn-note?tab=readme-ov-file rel=noopener target=_blank>whutbd/cuda-learn-note: ğŸ‰CUDA ç¬”è®° / é«˜é¢‘é¢è¯•é¢˜æ±‡æ€» / C++ç¬”è®°ï¼Œä¸ªäººç¬”è®°ï¼Œæ›´æ–°éšç¼˜: sgemmã€sgemvã€warp reduceã€block reduceã€dot productã€elementwiseã€softmaxã€layernormã€rmsnormã€hist etc. (github.com)</a><li><a href=https://cuda-tutorial.readthedocs.io/en/latest/tutorials/tutorial01/ rel=noopener target=_blank>Tutorial 01: Say Hello to CUDA - CUDA Tutorial (cuda-tutorial.readthedocs.io)</a></ol> <link href=/css/spoiler.css rel=stylesheet><script async src=/js/spoiler.js></script> <div><div><div style="text-align:center;color: #ccc;font-size:14px;">-------------æœ¬æ–‡ç»“æŸ<i class="fa fa-paw"></i>æ„Ÿè°¢æ‚¨çš„é˜…è¯»-------------</div></div></div> <div class=reward-container><div>æ„Ÿè°¢é˜…è¯».</div><button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">æ‰“èµ</button><div style="display: none;" id=qr><div style="display: inline-block;"><img alt="Sekyoro å¾®ä¿¡æ”¯ä»˜" src=/images/wechatpay.png><p>å¾®ä¿¡æ”¯ä»˜</div></div></div> <div><ul class=post-copyright><li class=post-copyright-author><strong>æœ¬æ–‡ä½œè€…ï¼š </strong>Sekyoro<li class=post-copyright-link><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href=https://www.sekyoro.top/2024/08/16/CUDA101/ title=CUDA101>https://www.sekyoro.top/2024/08/16/CUDA101/</a><li class=post-copyright-license><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ rel=noopener target=_blank><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</ul></div> <div class=followme><p>æ¬¢è¿å…³æ³¨æˆ‘çš„å…¶å®ƒå‘å¸ƒæ¸ é“<div class=social-list><div class=social-item><a class=social-link href=/images/wxqrcode.png target=_blank> <span class=icon> <i class="fab fa-weixin"></i> </span> <span class=label>WeChat</span> </a></div><div class=social-item><a class=social-link href=/images/website.png target=_blank> <span class=icon> <i class="fa fa-user"></i> </span> <span class=label>PersonalWebsite</span> </a></div><div class=social-item><a class=social-link href=https://my-astro-git-main-drowning-in-codes.vercel.app target=_blank> <span class=icon> <i class="fas fa-share"></i> </span> <span class=label>æ‚é±¼åˆ†äº«</span> </a></div><div class=social-item><a class=social-link href=/atom.xml target=_blank> <span class=icon> <i class="fa fa-rss"></i> </span> <span class=label>RSS</span> </a></div></div></div> <footer class=post-footer><div class=post-tags><a href=/tags/cuda/ rel=tag><i class="fa fa-tag"></i> cuda</a></div><div class=post-nav><div class=post-nav-item><a href=/2024/08/11/typst%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/ rel=prev title=typstå­¦ä¹ ä¸å·¥å…·ä½¿ç”¨> <i class="fa fa-chevron-left"></i> typstå­¦ä¹ ä¸å·¥å…·ä½¿ç”¨ </a></div><div class=post-nav-item><a title="dive deeper into functional programming" href=/2024/08/17/dive-deeper-into-functional-programming/ rel=next> dive deeper into functional programming <i class="fa fa-chevron-right"></i> </a></div></div></footer> <!-- è¯„è®ºåŒº --> <div class=comments><div data-id=city data-uid=MTAyMC81MzE5Ny8yOTY3Mg== id=lv-container></div></div> <script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script> <div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div> <aside class=sidebar><div class=sidebar-inner><!-- canvasç²’å­æ—¶é’Ÿ --><div><canvas id=canvas style=width:60%;>å½“å‰æµè§ˆå™¨ä¸æ”¯æŒcanvasï¼Œè¯·æ›´æ¢æµè§ˆå™¨åå†è¯•</canvas></div><script>(function(){

   var digit=
    [
        [
            [0,0,1,1,1,0,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,0,1,1,0],
            [0,0,1,1,1,0,0]
        ],//0
        [
            [0,0,0,1,1,0,0],
            [0,1,1,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [1,1,1,1,1,1,1]
        ],//1
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,1,1],
            [1,1,1,1,1,1,1]
        ],//2
        [
            [1,1,1,1,1,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//3
        [
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,0],
            [0,0,1,1,1,1,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,1,1,0],
            [1,1,1,1,1,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,1]
        ],//4
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,1,1,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//5
        [
            [0,0,0,0,1,1,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//6
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0]
        ],//7
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//8
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,1,1,0,0,0,0]
        ],//9
        [
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0]
        ]//:
    ];

var canvas = document.getElementById('canvas');

if(canvas.getContext){
    var cxt = canvas.getContext('2d');
    //å£°æ˜canvasçš„å®½é«˜
    var H = 100,W = 700;
    canvas.height = H;
    canvas.width = W;
    cxt.fillStyle = '#f00';
    cxt.fillRect(10,10,50,50);

    //å­˜å‚¨æ—¶é—´æ•°æ®
    var data = [];
    //å­˜å‚¨è¿åŠ¨çš„å°çƒ
    var balls = [];
    //è®¾ç½®ç²’å­åŠå¾„
    var R = canvas.height/20-1;
    (function(){
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        //å­˜å‚¨æ—¶é—´æ•°å­—ï¼Œç”±åä½å°æ—¶ã€ä¸ªä½å°æ—¶ã€å†’å·ã€åä½åˆ†é’Ÿã€ä¸ªä½åˆ†é’Ÿã€å†’å·ã€åä½ç§’é’Ÿã€ä¸ªä½ç§’é’Ÿè¿™7ä¸ªæ•°å­—ç»„æˆ
        data.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
    })();

    /*ç”Ÿæˆç‚¹é˜µæ•°å­—*/
    function renderDigit(index,num){
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    cxt.beginPath();
                    cxt.arc(14*(R+2)*index + j*2*(R+1)+(R+1),i*2*(R+1)+(R+1),R,0,2*Math.PI);
                    cxt.closePath();
                    cxt.fill();
                }
            }
        }
    }

    /*æ›´æ–°æ—¶é’Ÿ*/
    function updateDigitTime(){
        var changeNumArray = [];
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        var NewData = [];
        NewData.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
        for(var i = data.length-1; i >=0 ; i--){
            //æ—¶é—´å‘ç”Ÿå˜åŒ–
            if(NewData[i] !== data[i]){
                //å°†å˜åŒ–çš„æ•°å­—å€¼å’Œåœ¨dataæ•°ç»„ä¸­çš„ç´¢å¼•å­˜å‚¨åœ¨changeNumArrayæ•°ç»„ä¸­
                changeNumArray.push(i+'_'+(Number(data[i])+1)%10);
            }
        }
        //å¢åŠ å°çƒ
        for(var i = 0; i< changeNumArray.length; i++){
            addBalls.apply(this,changeNumArray[i].split('_'));
        }
        data = NewData.concat();
    }

    /*æ›´æ–°å°çƒçŠ¶æ€*/
    function updateBalls(){
        for(var i = 0; i < balls.length; i++){
            balls[i].stepY += balls[i].disY;
            balls[i].x += balls[i].stepX;
            balls[i].y += balls[i].stepY;
            if(balls[i].x > W + R || balls[i].y > H + R){
                balls.splice(i,1);
                i--;
            }
        }
    }

    /*å¢åŠ è¦è¿åŠ¨çš„å°çƒ*/
    function addBalls(index,num){
        var numArray = [1,2,3];
        var colorArray =  ["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"];
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    var ball = {
                        x:14*(R+2)*index + j*2*(R+1)+(R+1),
                        y:i*2*(R+1)+(R+1),
                        stepX:Math.floor(Math.random() * 4 -2),
                        stepY:-2*numArray[Math.floor(Math.random()*numArray.length)],
                        color:colorArray[Math.floor(Math.random()*colorArray.length)],
                        disY:1
                    };
                    balls.push(ball);
                }
            }
        }
    }

    /*æ¸²æŸ“*/
    function render(){
        //é‡ç½®ç”»å¸ƒå®½åº¦ï¼Œè¾¾åˆ°æ¸…ç©ºç”»å¸ƒçš„æ•ˆæœ
        canvas.height = 100;
        //æ¸²æŸ“æ—¶é’Ÿ
        for(var i = 0; i < data.length; i++){
            renderDigit(i,data[i]);
        }
        //æ¸²æŸ“å°çƒ
        for(var i = 0; i < balls.length; i++){
            cxt.beginPath();
            cxt.arc(balls[i].x,balls[i].y,R,0,2*Math.PI);
            cxt.fillStyle = balls[i].color;
            cxt.closePath();
            cxt.fill();
        }
    }

    clearInterval(oTimer);
    var oTimer = setInterval(function(){
        //æ›´æ–°æ—¶é’Ÿ
        updateDigitTime();
        //æ›´æ–°å°çƒçŠ¶æ€
        updateBalls();
        //æ¸²æŸ“
        render();
    },50);
}

})();</script><!-- require APlayer --><link href=https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js></script><!-- require MetingJS --><script src=/js/meting-js.js></script><ul class="sidebar-nav motion-element"><li class=sidebar-nav-toc>æ–‡ç« ç›®å½•<li class=sidebar-nav-overview>ç«™ç‚¹æ¦‚è§ˆ</ul><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class=nav><li class="nav-item nav-level-2"><a class=nav-link href=#%E4%BB%8B%E7%BB%8DCUDA><span class=nav-number>1.</span> <span class=nav-text>ä»‹ç»CUDA</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#CUDA%E5%B7%A5%E4%BD%9C><span class=nav-number>1.0.1.</span> <span class=nav-text>CUDAå·¥ä½œ</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#CUDA%E4%BB%A5%E5%8F%8A%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B><span class=nav-number>1.0.2.</span> <span class=nav-text>CUDAä»¥åŠå·¥ä½œæµç¨‹</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E7%BC%96%E5%86%99CUDA%E4%BB%A3%E7%A0%81><span class=nav-number>2.</span> <span class=nav-text>ç¼–å†™CUDAä»£ç </span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%80%A7%E8%83%BD%E8%AF%84%E4%BC%B0><span class=nav-number>2.0.1.</span> <span class=nav-text>æ€§èƒ½è¯„ä¼°</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#thread><span class=nav-number>2.0.2.</span> <span class=nav-text>thread</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#thread-blocks><span class=nav-number>2.0.3.</span> <span class=nav-text>thread blocks</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E4%B8%80%E4%BA%9B%E4%BE%8B%E5%AD%90><span class=nav-number>3.</span> <span class=nav-text>ä¸€äº›ä¾‹å­</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99><span class=nav-number>3.1.</span> <span class=nav-text>å­¦ä¹ èµ„æ–™</span></a></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop=author itemscope itemtype=http://schema.org/Person><img alt=Sekyoro class=site-author-image itemprop=image src=https://i.loli.net/2021/05/17/YqoavnXdGTpPO9R.jpg><p class=site-author-name itemprop=name>Sekyoro<div class=site-description itemprop=description>ä»€ä¹ˆä¹Ÿæ— æ³•èˆå¼ƒçš„äººï¼Œä»€ä¹ˆä¹Ÿåšä¸äº†.</div></div><div class="site-state-wrap motion-element"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>242</span> <span class=site-state-item-name>æ—¥å¿—</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>16</span> <span class=site-state-item-name>åˆ†ç±»</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>214</span> <span class=site-state-item-name>æ ‡ç­¾</span></a></div></nav></div><div class="links-of-author motion-element"><span class=links-of-author-item> <a title="Personal Website â†’ http://proanimer.com" href=http://proanimer.com/ rel=noopener target=_blank><i class="fab fa-internet-explorer fa-fw"></i>Personal Website</a> </span><span class=links-of-author-item> <a title="GitHub â†’ https://github.com/drowning-in-codes" href=https://github.com/drowning-in-codes rel=noopener target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item> <a title="E-Mail â†’ mailto:bukalala174@gmail.com" href=mailto:bukalala174@gmail.com rel=noopener target=_blank><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span><span class=links-of-author-item> <a title="wxPublicAccount â†’ https://mp.weixin.qq.com/s?__biz=Mzg3ODY1MDkzMg==&mid=2247483770&idx=1&sn=fdf88faab01d5c219ac609570a21c9d6&chksm=cf113221f866bb373938cfca03cf095ff4fe1e4dc37d68ef5de4cd4876ee1260fca0c015a4d6&token=1096259873&lang=zh_CN#rd" href=https://mp.weixin.qq.com/s?__biz=Mzg3ODY1MDkzMg==&mid=2247483770&idx=1&sn=fdf88faab01d5c219ac609570a21c9d6&chksm=cf113221f866bb373938cfca03cf095ff4fe1e4dc37d68ef5de4cd4876ee1260fca0c015a4d6&token=1096259873&lang=zh_CN#rd rel=noopener target=_blank><i class="fab fa-weixin fa-fw"></i>wxPublicAccount</a> </span><span class=links-of-author-item> <a title="RSS â†’ /atom.xml" href=/atom.xml><i class="fa fa-rss fa-fw"></i>RSS</a> </span><span class=links-of-author-item> <a title="CSDN â†’ https://blog.csdn.net/aqwca" href=https://blog.csdn.net/aqwca rel=noopener target=_blank><i class="fa fa-handshake fa-fw"></i>CSDN</a> </span><span class=links-of-author-item> <a title="æ‚é±¼åˆ†äº« â†’ https://my-astro-git-main-drowning-in-codes.vercel.app" href=https://my-astro-git-main-drowning-in-codes.vercel.app/ rel=noopener target=_blank><i class="fas fa-share fa-fw"></i>æ‚é±¼åˆ†äº«</a> </span></div><div class="links-of-blogroll motion-element"><div class=links-of-blogroll-title><i class="fa fa-link fa-fw"></i> å‹æƒ…é“¾æ¥</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=http://myqhs.top/ rel=noopener target=_blank title=http://myqhs.top/>myqhs</a><li class=links-of-blogroll-item><a href=https://www.lllomh.com/ rel=noopener target=_blank title=https://www.lllomh.com/>èŠˆæ¸¡</a><li class=links-of-blogroll-item><a href=https://protool-ten.vercel.app/ rel=noopener target=_blank title=https://protool-ten.vercel.app/>protools</a></ul></div><div class="motion-element announcement"><div class=title></div><p class=content><p class=date></div></div><meting-js id=6856787487 order=random server=netease type=playlist> </meting-js><div class=widget-wrap><h3 class=widget-title style=margin:0>æ–‡ç« è¯äº‘</h3><div class="widget tagcloud" id=myCanvasContainer><canvas height=250 id=resCanvas style=width:100% width=250><ul class=tag-list itemprop=keywords><li class=tag-list-item><a class=tag-list-link href=/tags/cuda/ rel=tag>cuda</a><span class=tag-list-count>1</span></ul></canvas></div></div><script id=clustrmaps src=https://clustrmaps.com/map_v2.js?d=xQdGTxqARTBiNIwX2aUban-ixkj2s6VaZQWo-aVCgY8&cl=ffffff&w=a></script><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i><span>0%</span></div><!-- è¾¹æ  --></div></aside> <div id=sidebar-dimmer></div> <footer class=footer><div class=footer-inner><div class=copyright>Â© Wed Apr 08 2020 08:00:00 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´) â€“ <span itemprop=copyrightYear>2025</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>Sekyoro</span><span class=post-meta-divider>|</span><span class=post-meta-item-icon> <i class="fa fa-chart-area"></i> </span><span title=ç«™ç‚¹æ€»å­—æ•°>2.8m</span><span class=post-meta-divider>|</span><span class=post-meta-item-icon> <i class="fa fa-coffee"></i> </span><span title=ç«™ç‚¹é˜…è¯»æ—¶é•¿>42:10</span></div><script async src=https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js></script><span id=busuanzi_container_site_pv>æ€»è®¿é—®é‡<span id=busuanzi_value_site_pv></span>æ¬¡</span><span class=post-meta-divider>|</span><span id=busuanzi_container_site_uv>æ€»è®¿å®¢æ•°<span id=busuanzi_value_site_uv></span>äºº</span><span class=post-meta-divider>|</span><!-- ä¸è’œå­è®¡æ•°åˆå§‹å€¼çº æ­£ --><script>$(document).ready(function() {

    var int = setInterval(fixCount, 50);  // 50mså‘¨æœŸæ£€æµ‹å‡½æ•°
    var countOffset = 20000;  // åˆå§‹åŒ–é¦–æ¬¡æ•°æ®

    function fixCount() {            
       if (document.getElementById("busuanzi_container_site_pv").style.display != "none")
        {
            $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + countOffset); 
            clearInterval(int);
        }                  
        if ($("#busuanzi_container_site_pv").css("display") != "none")
        {
            $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + countOffset); // åŠ ä¸Šåˆå§‹æ•°æ® 
            clearInterval(int); // åœæ­¢æ£€æµ‹
        }  
    }
       	
});</script><div><span id=timeDate>è½½å…¥å¤©æ•°...</span><span id=times>è½½å…¥æ—¶åˆ†ç§’...</span><script>var now = new Date();
    function createtime() {
        var grt= new Date("04/08/2021 20:00:00");
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "æœ¬ç«™å·²å®‰å…¨è¿è¡Œ "+dnum+" å¤© ";
        document.getElementById("times").innerHTML = hnum + " å°æ—¶ " + mnum + " åˆ† " + snum + " ç§’";
    }
setInterval("createtime()",250);</script></div><div class=busuanzi-count><script async data-pjax src=https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><span style="display: none;" class=post-meta-item id=busuanzi_container_site_uv> <span class=post-meta-item-icon> <i class="fa fa-user"></i> </span> <span class=site-uv title=æ€»è®¿å®¢é‡> <span id=busuanzi_value_site_uv></span> </span> </span><span class=post-meta-divider>|</span><span style="display: none;" class=post-meta-item id=busuanzi_container_site_pv> <span class=post-meta-item-icon> <i class="fa fa-eye"></i> </span> <span class=site-pv title=æ€»è®¿é—®é‡> <span id=busuanzi_value_site_pv></span> </span> </span></div></div></footer> <script color=0,0,255 count=99 opacity=0.5 src=/lib/canvas-nest/canvas-nest.min.js zindex=-1></script> <script src=/lib/anime.min.js></script> <script src=https://cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0/pjax.min.js></script> <script src=https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js></script> <script src=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js></script> <script src=https://cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js></script> <script src=https://cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js></script> <script src=https://cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js></script> <script src=/js/utils.js></script> <script src=/js/motion.js></script> <script src=/js/schemes/pisces.js></script> <script src=/js/next-boot.js></script> <script src=/js/bookmark.js></script> <script>var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax',
	'.widget-wrap'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
 
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});</script> <script data-pjax>(function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();</script> <script src=https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js></script> <script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js></script> <script src=/js/algolia-search.js></script> <script data-pjax>document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});</script> <div id=pjax><script charset=utf-8 defer src=/js/outdate.js></script></div> <script charset=utf-8 defer src=/js/tagcanvas.js></script> <script charset=utf-8 defer src=/js/tagcloud.js></script> <script>NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});</script> <script>var OriginTitile = document.title;
  var titleTime;
  document.addEventListener("visibilitychange", function() {
    if (document.hidden) {
      document.title = "(ã¤ã‚§âŠ‚)æˆ‘è—å¥½äº†å“¦~" + OriginTitile;
      clearTimeout(titleTime);
    } else {
      document.title = "(*Â´âˆ‡ï½€*) è¢«ä½ å‘ç°å•¦~" + OriginTitile;
      titleTime = setTimeout(function() {
        document.title = OriginTitile;
      }, 2000);
    }
  });</script> <script src=/js/src/activate-power-mode.min.js></script> <script>POWERMODE.colorful = true;
    POWERMODE.shake = false;
    document.body.addEventListener('input', POWERMODE);</script> 