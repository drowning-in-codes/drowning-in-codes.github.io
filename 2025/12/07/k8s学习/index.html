<!doctypehtml><html lang=zh-CN><script defer src=/live2d-widget/autoload.js></script><meta charset=UTF-8><meta content=width=device-width,initial-scale=1,maximum-scale=2 name=viewport><meta content=#222 name=theme-color><meta content="Hexo 5.4.0" name=generator><link href=/images/blog_32px.png rel=apple-touch-icon sizes=180x180><link href=/images/blog_32px.png rel=icon sizes=32x32 type=image/png><link href=/images/blog_16px.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><meta content=EPrJAp11bJwHULpQUaSNSZ8_3RcvTsPDAEGOME4pl1w name=google-site-verification><!-- Google tag (gtag.js) --><!-- 
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VB21D8MKKW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VB21D8MKKW');
</script> --><!-- google adsense in head.swig --><script async crossorigin=anonymous src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4034523802263123></script><meta content=7226864CE87CE9DE8C008385273846FF name=msvalidate.01><meta content=code-fjFXVtiL7j name=baidu-site-verification><link href=/css/main.css rel=stylesheet><link as=style href=https://fonts.googleapis.com/css?family=Roboto%20Mono,Roboto:300,300italic,400,400italic,700,700italic|Roboto:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext onload=this.rel='stylesheet' rel=preload><link as=style href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css onload=this.rel='stylesheet' rel=preload><link href=https://fonts.googleapis.com/css?family=Noto+Serif+SC|Roboto&display=swap rel=stylesheet><link href=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/pace-js@1/pace.min.js></script><script id=hexo-configurations>var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.sekyoro.top","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","width":240,"display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"appID":"0F9LEEVW82","apiKey":"78839e9f9be09d081c5c4da81975cd19","indexName":"sekyoblog_sec","hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"manual","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};</script><link href=//cdn.bootcss.com/animate.css/3.5.0/animate.min.css rel=stylesheet><meta content=Kubernetes核心概念与基本使用 name=description><meta content=article property=og:type><meta content=k8s学习 property=og:title><meta content=https://www.sekyoro.top/2025/12/07/k8s%E5%AD%A6%E4%B9%A0/index.html property=og:url><meta content=Sekyoro的博客小屋 property=og:site_name><meta content=Kubernetes核心概念与基本使用 property=og:description><meta content=zh_CN property=og:locale><meta content=https://kubernetes.io/docs/tutorials/kubernetes-basics/public/images/module_01_cluster.svg property=og:image><meta content=https://kubernetes.io/images/docs/kubernetes-cluster-architecture.svg property=og:image><meta content=https://kubernetes.io/docs/tutorials/kubernetes-basics/public/images/module_05_scaling2.svg property=og:image><meta content=https://kubernetes.io/docs/tutorials/kubernetes-basics/public/images/module_06_rollingupdates1.svg property=og:image><meta content=2025-12-07T04:15:54.000Z property=article:published_time><meta content=2025-12-10T15:11:19.045Z property=article:modified_time><meta content=Sekyoro property=article:author><meta content=k8s property=article:tag><meta content=summary name=twitter:card><meta content=https://kubernetes.io/docs/tutorials/kubernetes-basics/public/images/module_01_cluster.svg name=twitter:image><link href=https://www.sekyoro.top/2025/12/07/k8s%E5%AD%A6%E4%B9%A0/ rel=canonical><script id=page-configurations>// https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };</script><title>k8s学习 | Sekyoro的博客小屋</title><noscript><style>.use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }</style></noscript><link href=/atom.xml rel=alternate title=Sekyoro的博客小屋 type=application/atom+xml><body itemscope itemtype=http://schema.org/WebPage><canvas style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" class=fireworks></canvas><script defer src=https://cdn.bootcss.com/animejs/2.2.0/anime.min.js></script><script defer src=/js/src/fireworks.js></script><div class="container use-motion"><div class=headband></div><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <span class=logo-line-before><i></i></span> <h1 class=site-title>Sekyoro的博客小屋</h1> <span class=logo-line-after><i></i></span> </a></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu" id=menu><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>关于</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-bangumis"><a href=/bangumis/ rel=section><i class="fa fa-film fa-fw"></i>追番</a><li class="menu-item menu-item-resume"><a href=/resume/ rel=section><i class="fa fa-file-pdf fa-fw"></i>简历</a><li class="menu-item menu-item-materials"><a href=/materials/ rel=section><i class="fa fa-book fa-fw"></i>学习资料</a><li class="menu-item menu-item-sitemap"><a href=/sitemap.xml rel=section><i class="fa fa-sitemap fa-fw"></i>站点地图</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container></div><span class=popup-btn-close> <i class="fa fa-times-circle"></i> </span></div><div class=algolia-results><div id=algolia-stats></div><div id=algolia-hits></div><div class=algolia-pagination id=algolia-pagination></div></div></div></div></div></header><a class="book-mark-link book-mark-link-fixed" role=button></a><main class=main><div class=main-inner><div class=content-wrap><div class="content post posts-expand"><article class=post-block itemscope itemtype=http://schema.org/Article lang=zh-CN><link href=https://www.sekyoro.top/2025/12/07/k8s%E5%AD%A6%E4%B9%A0/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=https://i.loli.net/2021/05/17/YqoavnXdGTpPO9R.jpg itemprop=image> <meta content=Sekyoro itemprop=name> <meta content=什么也无法舍弃的人，什么也做不了. itemprop=description> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=Sekyoro的博客小屋 itemprop=name> </span><header class=post-header><h1 itemprop="name headline" class=post-title>k8s学习</h1><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2025-12-07 12:15:54" datetime=2025-12-07T12:15:54+08:00>2025-12-07</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2025-12-10 23:11:19" datetime=2025-12-10T23:11:19+08:00 itemprop=dateModified>2025-12-10</time> </span><span style="display: none;" class=post-meta-item id=busuanzi_container_page_pv title=阅读次数> <span class=post-meta-item-icon> <i class="fa fa-eye"></i> </span> <span class=post-meta-item-text>阅读次数：</span> <span id=busuanzi_value_page_pv></span> </span><br><span class=post-meta-item title=本文字数> <span class=post-meta-item-icon> <i class="far fa-file-word"></i> </span> <span class=post-meta-item-text>本文字数：</span> <span>17k</span> </span><span class=post-meta-item title=阅读时长> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>阅读时长 ≈</span> <span>15 分钟</span> </span></div></header><div class=post-body itemprop=articleBody><div class=post-tags><a href=/tags/k8s/ rel=tag># k8s</a></div><p>Kubernetes核心概念与基本使用<br><span id=more></span><h1 id=基本概念><a class=headerlink href=#基本概念 title=基本概念></a>基本概念</h1><p><strong>Kubernetes 是一个生产级别的开源平台， 可编排在计算机集群内和跨计算机集群的应用容器的部署（调度）和执行。</strong><p><strong>Kubernetes 协调一个高可用计算机集群，每个计算机互相连接之后作为同一个工作单元运行。</strong> Kubernetes 中的抽象允许你将容器化的应用部署到集群，而无需将它们绑定到某个特定的独立计算机。 为了使用这种新的部署模型，需要以将应用与单个主机解耦的方式打包：它们需要被容器化。 与过去的那种应用直接以包的方式深度与主机集成的部署模型相比，容器化应用更灵活、更可用。 <strong>Kubernetes 以更高效的方式跨集群自动分布和调度应用容器。</strong> Kubernetes 是一个开源平台，并且可应用于生产环境。<p>一个 Kubernetes 集群包含两种类型的资源：<ul><li><strong>控制面（Control Plane）</strong> 调度整个集群<li><strong>节点（Nodes）</strong> 负责运行应用</ul><p>Kubernetes 集群由一个<strong>控制平面</strong>和<strong>一组用于运行容器化应用的工作机器</strong>组成， 这些工作机器称作节点（Node）。每个集群至少需要一个工作节点来运行 Pod。<p><img alt=img data-src=https://kubernetes.io/docs/tutorials/kubernetes-basics/public/images/module_01_cluster.svg style=zoom:67%;><p>工作节点托管着组成应用负载的 Pod。控制平面管理集群中的工作节点和 Pod。 在生产环境中，控制平面通常跨多台计算机运行，而一个集群通常运行多个节点，以提供容错和高可用。<p><img alt="控制平面（kube-apiserver、etcd、kube-controller-manager、kube-scheduler）和多个节点。每个节点运行 kubelet 和 kube-proxy。" data-src=https://kubernetes.io/images/docs/kubernetes-cluster-architecture.svg><h2 id=控制平面><a class=headerlink href=#控制平面 title=控制平面></a>控制平面</h2><p>有些地方又叫做Kubernetes Master,是K8s集群中的核心组件，负责集群的管理和控制。<p>控制平面组件会为集群做出全局决策，比如资源的调度。 以及检测和响应集群事件，例如当不满足 Deployment 的 <code>replicas</code> 字段时，要启动新的 <a href=https://kubernetes.io/zh-cn/docs/concepts/workloads/pods/ rel=noopener target=_blank>Pod</a>）。<p>控制平面组件可以在集群中的任何节点上运行。 然而，为了简单起见，安装脚本通常会<strong>在同一个计算机上启动所有控制平面组件</strong>， <strong>并且不会在此计算机上运行用户容器。</strong><p>包括以下组件：<ul><li><p><strong>etcd</strong>：一个分布式键值存储系统，用于存储集群状态。</p><li><p><strong>API Server</strong>：集群的入口点，提供RESTful API接口。</p><li><p><strong>Controller Manager</strong>：负责集群中各种资源的监控和自动修复。</p> <p>controller manager又包括<code>kube-scheduler</code> ， 负责监视新创建的、未指定运行节点的 Pod， 并选择节点来让 Pod 在上面运行。从逻辑上讲， 每个controller都是一个单独的进程， 但是为了降低复杂性，它们都被编译到同一个可执行文件，并在同一个进程中运行。</p> <p>还包括cloud-controller-manager 嵌入了特定于云平台的控制逻辑。 云控制器管理器（Cloud Controller Manager）允许将你的集群连接到云提供商的 API 之上， 并将与该云平台交互的组件同与你的集群交互的组件分离开来。</p></ul><p>控制器有许多不同类型。以下是一些例子：<p>Node 控制器：负责在节点出现故障时进行通知和响应<p>Job 控制器：监测代表一次性任务的 Job 对象，然后创建 Pod 来运行这些任务直至完成<p>EndpointSlice 控制器：填充 EndpointSlice 对象（以提供 Service 和 Pod 之间的链接）。<p>ServiceAccount 控制器：为新的命名空间创建默认的 ServiceAccount。<ul><li><strong>Scheduler</strong>：负责将Pod调度到合适的节点上。</ul><h2 id=节点组件><a class=headerlink href=#节点组件 title=节点组件></a>节点组件</h2><p>Kubernetes Node是集群中的工作节点，负责运行Pod。每个Node节点包括以下组件：<ul><li><strong>Kubelet</strong>：负责Pod的生命周期管理，包括Pod的创建、启动、停止和删除。<li><strong>Container Runtime</strong>：用于运行容器的环境，如Docker。<li><strong>Kube-Proxy</strong>：负责网络代理，实现Pod之间的通信。</ul><p>Pod是Kubernetes中的基本部署单元，包含一个或多个容器。Pod在Kubernetes集群中负责运行应用程序。<p>控制平面组件会为集群做出全局决策，比如资源的调度。 以及检测和响应集群事件，例如当不满足 Deployment 的 <code>replicas</code> 字段时，要启动新的 <a href=https://kubernetes.io/zh-cn/docs/concepts/workloads/pods/ rel=noopener target=_blank>Pod</a>）。<p>控制平面组件可以在集群中的任何节点上运行。 然而，为了简单起见，安装脚本通常会在同一个计算机上启动所有控制平面组件， 并且不会在此计算机上运行用户容器。 请参阅<a href=https://kubernetes.io/zh-cn/docs/setup/production-environment/tools/kubeadm/high-availability/ rel=noopener target=_blank>使用 kubeadm 构建高可用性集群</a>中关于跨多机器安装控制平面的示例。<h3 id=节点><a class=headerlink href=#节点 title=节点></a>节点</h3><p>Kubernetes 通过将容器放入在节点（Node）上运行的 Pod 中来执行<a href=https://kubernetes.io/zh-cn/docs/concepts/workloads/ rel=noopener target=_blank>工作负载</a>。 节点可以是一个虚拟机或者物理机器，取决于所在的集群配置。 每个节点包含运行 <a href=https://kubernetes.io/zh-cn/docs/concepts/workloads/pods/ rel=noopener target=_blank>Pod</a> 所需的服务； 这些节点由<a href=https://kubernetes.io/zh-cn/docs/reference/glossary/?all=true#term-control-plane rel=noopener target=_blank>控制面</a>负责管理。<p>通常集群中会有若干个节点；而在一个学习所用或者资源受限的环境中，你的集群中也可能只有一个节点。一个 Pod 总是运行在某个 <strong>Node（节点）</strong> 上。节点是 Kubernetes 中工作机器， 可以是虚拟机或物理计算机，具体取决于集群。每个 Node 都由控制面管理。 节点可以有多个 Pod，Kubernetes 控制面会自动处理在集群中的节点上调度 Pod。 控制面的自动调度考量了每个节点上的可用资源。<p><strong>节点上的组件包括kubelet、容器运行时以及kube-proxy</strong>。<h3 id=Pod><a class=headerlink href=#Pod title=Pod></a>Pod</h3><p>Pod 是一个或多个应用容器（例如 Docker）的组合，并且包含共享的存储（卷）、IP 地址和有关如何运行它们的信息。<p>Pod 是 Kubernetes 抽象出来的，表示一组一个或多个应用容器（如 Docker）， 以及这些容器的一些共享资源。这些资源包括：<ul><li>卷形式的共享存储<li>集群内唯一的 IP 地址，用于联网<li>有关每个容器如何运行的信息，例如容器镜像版本或要使用的特定端口</ul><p><strong>Pod</strong> 是可以<strong>在 Kubernetes 中创建和管理的、最小的可部署的计算单元</strong>。<strong>只有容器紧耦合并且需要共享磁盘等资源时，才应将其编排在一个 Pod 中。</strong><p><strong>Pod</strong>（就像在鲸鱼荚或者豌豆荚中）是一组（一个或多个)容器； 这些容器共享存储、网络、以及怎样运行这些容器的规约。 Pod 中的内容总是并置（colocated）的并且一同调度，在共享的上下文中运行。 Pod 所建模的是特定于应用的“逻辑主机”，其中包含一个或多个应用容器， 这些容器相对紧密地耦合在一起。 在非云环境中，在相同的物理机或虚拟机上运行的应用类似于在同一逻辑主机上运行的云应用。<p>除了应用容器，Pod 还可以包含在 Pod 启动期间运行的Init容器。 也可以注入<a href=https://kubernetes.io/zh-cn/docs/concepts/workloads/pods/ephemeral-containers/ rel=noopener target=_blank>临时性容器</a>来调试正在运行的 Pod。<p>Pod 的<strong>共享上下文包括一组 Linux 名字空间、控制组（CGroup）</strong>和可能一些其他的隔离方面， 即用来隔离容器的技术。 在 Pod 的上下文中，每个独立的应用可能会进一步实施隔离。<p>Kubernetes 集群中的 Pod 主要有两种用法：<ul><li><p><strong>运行单个容器的 Pod</strong>。”每个 Pod 一个容器”模型是最常见的 Kubernetes 用例； 在这种情况下，可以将 Pod 看作单个容器的包装器，并且 Kubernetes 直接管理 Pod，而不是容器。</p><li><p><strong>运行多个协同工作的容器的 Pod</strong>。 Pod 可以封装由紧密耦合且需要共享资源的多个并置容器组成的应用。 这些位于同一位置的容器构成一个内聚单元。</p> <p>将多个并置、同管的容器组织到一个 Pod 中是一种相对高级的使用场景。 只有在一些场景中，容器之间紧密关联时你才应该使用这种模式。</p></ul><h3 id=容器><a class=headerlink href=#容器 title=容器></a>容器</h3><p>每个运行的容器都是可重复的； 包含依赖环境在内的标准，意味着无论你在哪里运行它都会得到相同的行为。<p>容器将应用程序从底层的主机设施中解耦。 这使得在不同的云或 OS 环境中部署更加容易。<p>Kubernetes 集群中的每个节点都会运行容器， 这些容器构成分配给该节点的Pod。 单个 Pod 中的容器会在共同调度下，于同一位置运行在相同的节点上<h2 id=容器技术和虚拟机差别><a class=headerlink href=#容器技术和虚拟机差别 title=容器技术和虚拟机差别></a>容器技术和虚拟机差别</h2><p><strong>Docker（容器技术）</strong> 和 <strong>虚拟机（VM）</strong> 的区别是理解现代云计算架构的基础。<p>虽然它们的目的都是提<strong>供隔离的环境来运行应用程序</strong>，但它们的底层架构和资源使用方式有着根本性的不同。<p>最大的区别在于它们如何与底层硬件和操作系统（Host OS）交互。<div class=table-container><table><thead><tr><th><strong>特性</strong><th><strong>Docker 容器 (Container)</strong><th><strong>虚拟机 (VM)</strong><tbody><tr><td><strong>隔离级别</strong><td><strong>进程级隔离</strong> (共享内核)<td><strong>硬件级隔离</strong> (完全虚拟化)<tr><td><strong>操作系统</strong><td><strong>共享宿主机操作系统内核</strong><td>包含<strong>完整的独立操作系统</strong> (Guest OS)<tr><td><strong>启动速度</strong><td>极快（秒级甚至毫秒级）<td>慢（需要启动整个操作系统）<tr><td><strong>资源占用</strong><td>极低（只包含应用和必需的库）<td>很高（每个 VM 都要占用大量 CPU、内存和磁盘）<tr><td><strong>核心组件</strong><td><strong>Docker Engine</strong> (容器运行时)<td><strong>Hypervisor</strong> (VMM, 如 VMware, VirtualBox)<tr><td><strong>大小</strong><td>几十到几百 MB<td>几 GB 到几十 GB</table></div><p>VM 的原理是完全虚拟化硬件。<p><strong>Hypervisor (管理程序)</strong>：这是一个软件层，直接运行在物理硬件或宿主操作系统之上。<p><strong>完整 OS</strong>：每个虚拟机都包含一个<strong>完整的、独立的操作系统</strong>（Guest OS），包括自己的内核、驱动、系统库和应用。<p><strong>硬件模拟</strong>：Hypervisor 负责模拟所有硬件（CPU、内存、网卡、磁盘），让 Guest OS 以为自己独占了硬件。<p><strong>总结</strong>：VM 提供了强大的隔离性，但代价是<strong>巨大的资源开销</strong>，因为你需要同时运行两个或更多的完整操作系统<p><strong>Docker 的原理是操作系统级虚拟化（或容器化）。</strong><ul><li><strong>共享内核</strong>：所有容器都<strong>共享宿主机的操作系统内核</strong>。容器只是宿主机上的一个隔离进程。<li><strong>精简文件系统</strong>：容器只打包应用程序运行时所需的文件、库和依赖项，不包含整个操作系统。<li><strong>Docker Engine</strong>：Docker 引擎负责管理容器的生命周期，并使用 Linux 内核的两个核心技术来实现隔离和资源限制：<ul><li><strong>Namespaces (命名空间)</strong>：实现进程、网络、用户等资源的隔离。<li><strong>Cgroups (控制组)</strong>：实现对 CPU、内存、I/O 等资源的限制和配额。</ul><li><strong>总结</strong>：容器非常轻量，启动速度快，资源利用率高，但隔离性略低于 VM（如果内核存在安全漏洞，所有容器都可能受到影响）。</ul><p><strong>容器镜像</strong><p>容器镜像是一个随时可以运行的软件包， 包含运行应用程序所需的一切：代码和它需要的所有运行时、应用程序和系统库，以及一些基本设置的默认值。<p>容器旨在设计成无状态且<a href=https://glossary.cncf.io/immutable-infrastructure/ rel=noopener target=_blank>不可变的</a>： 你不应更改已经运行的容器的代码。如果有一个容器化的应用程序需要修改， 正确的流程是：先构建包含更改的新镜像，再基于新构建的镜像重新运行容器。<p><strong>容器运行时</strong><p>这个基础组件使 Kubernetes 能够有效运行容器。 它负责管理 Kubernetes 环境中容器的执行和生命周期。<p>可以允许集群为一个 Pod 选择其默认的容器运行时。如果你需要在集群中使用多个容器运行时， 你可以为一个 Pod 指定 <a href=https://kubernetes.io/zh-cn/docs/concepts/containers/runtime-class/ rel=noopener target=_blank>RuntimeClass</a>， 以确保 Kubernetes 会使用特定的容器运行时来运行这些容器。<p><strong>每个 Pod 内部部署什么容器，完全取决于你的应用需求，但它通常包含：</strong><ol><li><strong>一个主要的业务容器（Main Container）。</strong><li><strong>零个或多个辅助容器（Sidecar, Init Containers）</strong></ol><p>主容器 (Main Container)<p>这是 Pod 的<strong>核心</strong>，它运行你的应用程序的实际业务逻辑。<ul><li><strong>数量：</strong> 通常是 <strong>1 个</strong>。<li><strong>示例：</strong><ul><li>一个 Java Spring Boot 应用服务器。<li>一个 NGINX Web 服务器。<li>一个 Python Flask API 服务。<li>一个 Node.js 后端应用</ul></ul><p>辅助容器（尤其是 Sidecar 模式）是 Pod 设计的强大之处。它们<strong>与主容器共享网络和存储空间，但执行不同的辅助任务。</strong><p>A. Sidecar 容器 (最常见)<p>Sidecar 容器是与主容器同时运行的辅助容器，用于增强或扩展主容器的功能，而不必修改主容器的代码。<ul><li><strong>数量：</strong> 0 个或多个。<li><strong>运行时间：</strong> 与主容器的生命周期相同（同时启动，同时终止）。<li><strong>常见作用：</strong><ul><li><strong>日志收集：</strong> Sidecar 容器运行一个日志代理（如 Fluentd、Logstash），监控主容器的日志文件并将其转发到集中的日志系统。<li><strong>服务网格代理 (如 Istio/Envoy)：</strong> Sidecar 容器作为网络代理，处理主容器所有的入站和出站流量，实现安全、路由、监控等功能。<li><strong>监控采集：</strong> Sidecar 容器运行一个 Prometheus Exporter，专门暴露主容器的性能指标。<li><strong>数据同步：</strong> Sidecar 容器负责定期从外部系统同步配置或证书文件。</ul></ul><p>B. Init 容器 (初始化容器)<p>Init 容器在任何主容器启动<strong>之前</strong>运行，并且必须成功完成才能让主容器启动。它们用于执行设置和准备工作。<ul><li><strong>数量：</strong> 0 个或多个。<li><strong>运行时间：</strong> 串行运行（一个接一个），并在主容器启动前完成。<li><strong>常见作用：</strong><ul><li><strong>等待依赖：</strong> 等待外部数据库或服务启动并可用。<li><strong>环境准备：</strong> 从配置服务器下载配置文件、脚本或证书。<li><strong>权限设置：</strong> 在共享卷上设置正确的文件权限。</ul></ul><p>每个节点上的多个 Pod 可以有<strong>完全不同</strong>的容器配置。例如：<ul><li><p><strong>Node 1</strong> 可能运行一个 <strong>Web Pod</strong>（主容器 + Envoy Sidecar）。</p><li><p><strong>Node 2</strong> 可能运行一个 <strong>DB Pod</strong>（主容器 + Init 容器用于数据初始化）</p></ul><p>数据库（如 MySQL, PostgreSQL）和 Redis 这种重量级、有状态的服务， <strong>一般不会</strong> <strong>作为辅助容器 (Sidecar) 部署在业务 Pod 内部。它们通常会被部署为</strong>独立的、单容器 Pod 或 StatefulSet<strong>，位于集群的</strong>独立节点上。<p>集群包含多个运行着 Kubernetes 代理程序、 由控制平台管理的一组节点（物理机或虚拟机）。 Kubernetes v1.34 单个集群支持的最大节点数为 5,000。 更具体地说，Kubernetes 设计为满足以下<strong>所有</strong>标准的配置：<ul><li>每个节点的 Pod 数量不超过 110<li>节点数不超过 5,000<li>Pod 总数不超过 150,000<li>容器总数不超过 300,000</ul><h2 id=Minikube><a class=headerlink href=#Minikube title=Minikube></a>Minikube</h2><p>Minikube,k3s 和 Kind (Kubernetes IN Docker) 等都是用于在本地机器上运行 Kubernetes 集群的工具<p>常用的 NGINX Web 服务器 Deployment 示例<p>Deployment 是用于管理<strong>无状态应用</strong>（Stateless Application）的标准控制器。<p>在无状态应用中，所有的 Pod 副本都是<strong>完全相同的</strong>，并且<strong>可以互相替换</strong>。Pod 本身不保存任何需要持久化的数据，它们通常从外部数据库或存储中获取数据。<p>Deployment 和 StatefulSet 是“管理者”和“指导者”，而 Pod 是它们管理的“工作单位”<figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br></pre><td class=code><pre><span class=line><span class=comment># my-app-deployment.yaml</span></span><br><span class=line></span><br><span class=line><span class=attr>apiVersion:</span> <span class=string>apps/v1</span></span><br><span class=line><span class=attr>kind:</span> <span class=string>Deployment</span></span><br><span class=line><span class=attr>metadata:</span></span><br><span class=line>  <span class=attr>name:</span> <span class=string>my-nginx-deployment</span> <span class=comment># Deployment 的名称</span></span><br><span class=line>  <span class=attr>labels:</span></span><br><span class=line>    <span class=attr>app:</span> <span class=string>my-nginx</span></span><br><span class=line><span class=attr>spec:</span></span><br><span class=line>  <span class=comment># 1. 副本设置</span></span><br><span class=line>  <span class=attr>replicas:</span> <span class=number>3</span> <span class=comment># 期望运行的 Pod 副本数量</span></span><br><span class=line>  <span class=comment># 2. 选择器：匹配哪些 Pod 属于这个 Deployment</span></span><br><span class=line>  <span class=attr>selector:</span></span><br><span class=line>    <span class=attr>matchLabels:</span></span><br><span class=line>      <span class=attr>app:</span> <span class=string>my-nginx</span></span><br><span class=line>  <span class=comment># 3. Pod 模板</span></span><br><span class=line>  <span class=attr>template:</span></span><br><span class=line>    <span class=attr>metadata:</span></span><br><span class=line>      <span class=attr>labels:</span></span><br><span class=line>        <span class=attr>app:</span> <span class=string>my-nginx</span> <span class=comment># 这个标签非常关键，用于 Service 选择 Pod</span></span><br><span class=line>    <span class=attr>spec:</span></span><br><span class=line>      <span class=attr>containers:</span></span><br><span class=line>      <span class=bullet>-</span> <span class=attr>name:</span> <span class=string>nginx-container</span> <span class=comment># 容器的名称</span></span><br><span class=line>        <span class=attr>image:</span> <span class=string>nginx:latest</span>   <span class=comment># 容器使用的镜像</span></span><br><span class=line>        <span class=attr>ports:</span></span><br><span class=line>        <span class=bullet>-</span> <span class=attr>containerPort:</span> <span class=number>80</span>   <span class=comment># 容器暴露的端口</span></span><br><span class=line>        <span class=comment># 资源请求（可选但推荐）</span></span><br><span class=line>        <span class=attr>resources:</span></span><br><span class=line>          <span class=attr>limits:</span></span><br><span class=line>            <span class=attr>memory:</span> <span class=string>"128Mi"</span></span><br><span class=line>            <span class=attr>cpu:</span> <span class=string>"500m"</span></span><br><span class=line>          <span class=attr>requests:</span></span><br><span class=line>            <span class=attr>memory:</span> <span class=string>"64Mi"</span></span><br><span class=line>            <span class=attr>cpu:</span> <span class=string>"250m"</span></span><br></pre></table></figure><p>Kubernetes <a href=https://kubernetes.io/zh-cn/docs/concepts/workloads/controllers/deployment/ rel=noopener target=_blank><strong>Deployment</strong></a> 检查 Pod 的健康状况，并在 Pod 中的容器终止的情况下重新启动新的容器。 Deployment 是管理 Pod 创建和扩展的推荐方法。<h2 id=部署应用><a class=headerlink href=#部署应用 title=部署应用></a>部署应用</h2><h3 id=利用minikube创建Deployment><a class=headerlink href=#利用minikube创建Deployment title=利用minikube创建Deployment></a>利用minikube创建Deployment</h3><p>Deployment 指挥 Kubernetes 如何创建和更新应用的实例。 <strong>创建 Deployment 后，Kubernetes 控制平面将 Deployment 中包含的应用实例调度到集群中的各个节点上</strong>。<p>创建应用实例后，Kubernetes Deployment 控制器会持续监视这些实例。 如果托管实例的节点关闭或被删除，则 Deployment 控制器会将该实例替换为集群中另一个节点上的实例。 <strong>这提供了一种自我修复机制来解决机器故障维护问题。</strong><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line><span class=meta>#</span><span class=bash> 运行包含 Web 服务器的测试容器镜像</span></span><br><span class=line>kubectl create deployment hello-node --image=registry.k8s.io/e2e-test-images/agnhost:2.53 -- /agnhost netexec --http-port=8080</span><br></pre></table></figure><p><code>kubectl create deployment</code> 是一个<strong>快捷命令</strong>，而 <code>kubectl apply -f xx.yaml</code> 是管理集群资源（包括 Deployment）的<strong>标准、推荐方式</strong><p>查看Deployment:<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line>kubectl get pods //查看pods</span><br><span class=line>kubectl get deployments</span><br><span class=line>kubectl get events // 查看集群事件</span><br><span class=line>kubectl get services</span><br><span class=line>kubectl config view //查看 kubectl 配置</span><br></pre></table></figure><p>创建 Deployment 时，Kubernetes 创建了一个 <strong>Pod</strong> 来托管你的应用实例。 Pod 是 Kubernetes 抽象出来的，表示一组一个或多个应用容器（如 Docker）， 以及这些容器的一些共享资源。这些资源包括：<ul><li><strong>卷形式的共享存储</strong><li><strong>集群内唯一的 IP 地址</strong>，用于联网<li>有关<strong>每个容器如何运行的信息</strong>，例如容器镜像版本或要使用的特定端口</ul><p>Pod 为特定于应用的“逻辑主机”建模，并且可以包含相对紧耦合的不同应用容器。 例如，Pod 可能既包含带有 Node.js 应用的容器，也包含另一个不同的容器， 用于提供 Node.js 网络服务器要发布的数据。Pod 中的容器共享 IP 地址和端口， 始终位于同一位置并且共同调度，并在同一节点上的共享上下文中运行。<h2 id=利用minikbe创建Service><a class=headerlink href=#利用minikbe创建Service title=利用minikbe创建Service></a>利用minikbe创建Service</h2><p>Kubernetes 中的Service是一种抽象概念，它定义的是 Pod 的一个逻辑集合和一种用来访问 Pod 的协议。 Service 使从属 Pod 之间的松耦合成为可能。<p>和所有 Kubernetes 对象清单一样，Service 用 YAML 或者 JSON 来定义。 Service 下的一组 Pod 通常由一个<strong>标签选择算符</strong>来标记 （请参阅下面的说明来了解为什么你可能想要一个 spec 中不包含 <code>selector</code> 的 Service）。<p>默认情况下，Pod 只能通过 Kubernetes 集群中的内部 IP 地址访问。 要使得容器可以从 Kubernetes 虚拟网络的外部访问，必须将 Pod 通过 Kubernetes <a href=https://kubernetes.io/zh-cn/docs/concepts/services-networking/service/ rel=noopener target=_blank><strong>Service</strong></a> 公开出来。<p>Service 的作用是为一组 Pod 提供一个<strong>稳定、不变</strong>的网络入口。这非常关键，因为 <strong>Pod 的 IP 地址是临时的、不稳定的。Service 负责跟踪 Pod 的变化，并将请求自动转发到健康的 Pod 副本上</strong>。<figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br></pre><td class=code><pre><span class=line><span class=attr>apiVersion:</span> <span class=string>v1</span></span><br><span class=line><span class=attr>kind:</span> <span class=string>Service</span></span><br><span class=line><span class=attr>metadata:</span></span><br><span class=line>  <span class=attr>name:</span> <span class=string>my-web-service</span>  <span class=comment># Service 的名称</span></span><br><span class=line>  <span class=attr>labels:</span></span><br><span class=line>    <span class=attr>app:</span> <span class=string>my-web</span></span><br><span class=line><span class=attr>spec:</span></span><br><span class=line>  <span class=comment># 关键：Service如何找到它要暴露的Pod</span></span><br><span class=line>  <span class=attr>selector:</span></span><br><span class=line>    <span class=attr>app:</span> <span class=string>my-nginx</span>      <span class=comment># 必须与目标 Deployment/Pod 的标签匹配</span></span><br><span class=line>  </span><br><span class=line>  <span class=comment># 关键：Service 的类型，决定了如何被访问</span></span><br><span class=line>  <span class=attr>type:</span> <span class=string>LoadBalancer</span>   <span class=comment># 常见的类型：ClusterIP, NodePort, LoadBalancer</span></span><br><span class=line>  </span><br><span class=line>  <span class=comment># 关键：端口配置</span></span><br><span class=line>  <span class=attr>ports:</span></span><br><span class=line>    <span class=bullet>-</span> <span class=attr>protocol:</span> <span class=string>TCP</span></span><br><span class=line>      <span class=attr>port:</span> <span class=number>80</span>        <span class=comment># Service 暴露给外部或集群内部的端口</span></span><br><span class=line>      <span class=attr>targetPort:</span> <span class=number>80</span>  <span class=comment># Service 转发到的 Pod 容器的端口</span></span><br><span class=line>      <span class=comment># nodePort: 30000 (如果 type 为 NodePort，可以指定或让K8s自动分配)</span></span><br></pre></table></figure><p><code>type</code> 字段是创建 Service 时最重要的决定，它定义了 Service 的访问方式：<div class=table-container><table><thead><tr><th><strong>Service Type</strong><th><strong>访问方式</strong><th><strong>访问范围</strong><th><strong>典型用途</strong><tbody><tr><td><strong>ClusterIP</strong> (默认)<td>Service 分配一个集群内部 IP (Cluster IP)。<td><strong>集群内部</strong>。只能从集群内部的 Pod 或 Node 访问。<td>集群内部组件通信（如 Web-API 连 Database）。<tr><td><strong>NodePort</strong><td>在每个节点上打开一个固定的端口。<td><strong>集群外部</strong>。可以通过 <code>任何节点 IP:NodePort</code> 访问。<td>测试环境或自建集群中简单暴露服务。<tr><td><strong>LoadBalancer</strong><td>在云环境中（如 AWS, GKE, Azure）自动创建<strong>云平台负载均衡器</strong>。<td><strong>集群外部</strong>。提供一个外部 IP 地址和负载均衡能力。<td>生产环境中暴露 Web 服务。<tr><td><strong>ExternalName</strong><td>将服务映射到 DNS 名称。<td><strong>集群内部</strong>。用于代理外部服务。<td>将集群内服务重定向到集群外的数据库或服务</table></div><h2 id=kubectl基础><a class=headerlink href=#kubectl基础 title=kubectl基础></a>kubectl基础</h2><p>kubectl 命令的常见格式是：<code>kubectl action resource</code>。<p>这会对指定的<strong>资源</strong>（类似 <code>node</code> 或 <code>deployment</code>）执行指定的<strong>操作</strong>（类似 <code>create</code>、<code>describe</code> 或 <code>delete</code>）。 你可以在子命令之后使用 <code>--help</code> 获取可能参数相关的更多信息 （例如：<code>kubectl get nodes --help</code>）。<p>通过运行 <code>kubectl version</code> 命令，查看 kubectl 是否被配置为与你的集群通信。<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>kubectl create deployment kubernetes-bootcamp --image=gcr.io/google-samples/kubernetes-bootcamp:v1</span><br></pre></table></figure><p>创建deployment<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>kubectl proxy</span><br></pre></table></figure><p>在 Kubernetes 内运行的Pod]运行在一个私有的、隔离的网络上。 默认这些 Pod 可以从同一 Kubernetes 集群内的其他 Pod 和服务看到，但超出这个网络后则看不到。 当我们使用 <code>kubectl</code> 时，我们通过 API 端点交互与应用进行通信。<ul><li><code>kubectl get</code> - 列出资源<li><code>kubectl describe</code> - 显示有关资源的详细信息<li><code>kubectl logs</code> - 打印 Pod 中容器的日志<li><code>kubectl exec</code> - 在 Pod 中的容器上执行命令</ul><p>扩缩应用<p>Deployment 仅创建了一个 Pod 用于运行这个应用。当流量增加时，需要扩容应用满足用户需求。<p>扩缩是通过改变 Deployment 中的副本数量来实现的<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>kubectl get deployments</span><br></pre></table></figure><p>输出应该类似这样：<figure class="highlight apache"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line><span class=attribute>NAME</span>                  READY   UP-TO-DATE   AVAILABLE   AGE</span><br><span class=line><span class=attribute>kubernetes</span>-bootcamp   <span class=number>1</span>/<span class=number>1</span>     <span class=number>1</span>            <span class=number>1</span>           <span class=number>11</span>m</span><br></pre></table></figure><p>我们应该有 1 个 Pod。如果没有，请重新运行命令。结果显示：<ul><li><strong>NAME</strong> 列出了集群中的 Deployment 的名称。<li><strong>READY</strong> 显示当前副本数与期望副本数的比例。<li><strong>UP-TO-DATE</strong> 显示已更新至期望状态的副本数。<li><strong>AVAILABLE</strong> 显示可用的 Pod 的数量。<li><strong>AGE</strong> 显示应用已运行的时间。</ul><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>kubectl scale deployments/kubernetes-bootcamp --replicas=4</span><br></pre></table></figure><p>进行扩缩容<p><img alt=img data-src=https://kubernetes.io/docs/tutorials/kubernetes-basics/public/images/module_05_scaling2.svg style=zoom:50%;><h2 id=负载均衡><a class=headerlink href=#负载均衡 title=负载均衡></a>负载均衡</h2><p>使用副本后，使用 <code>curl</code> 访问对外公开的 IP 和端口。多次执行访问命令，每个请求都命中了不同的 Pod，这证明负载均衡正在工作<h2 id=滚动更新><a class=headerlink href=#滚动更新 title=滚动更新></a>滚动更新</h2><p>滚动更新通过增量式更新 Pod 实例并替换为新的实例，允许在 Deployment 更新过程中实现零停机<p>用户希望应用程序始终可用，而开发人员则需要每天多次部署它们的新版本。 在 Kubernetes 中，这些是通过滚动更新（Rolling Update）完成的。<p><strong>滚动更新</strong>允许通过<strong>使用新的实例逐步更新 Pod 实例，实现零停机的 Deployment 更新</strong>。 新的 Pod 将被调度到具有可用资源的节点上。<p><img alt=img data-src=https://kubernetes.io/docs/tutorials/kubernetes-basics/public/images/module_06_rollingupdates1.svg style=zoom:67%;><p>如果 Deployment 的访问是公开的，Service 在更新期间仅将流量负载均衡到可用的 Pod。<p>与应用程序规模扩缩类似，如果 Deployment 的访问是公开的，Service 在更新期间仅将流量负载均衡到可用的 Pod。可用的 Pod 是指对应用的用户可用的实例。<p>滚动更新允许以下操作：<ul><li>将应用程序从一个环境升级到另一个环境（通过容器镜像更新）<li>回滚到以前的版本<li>持续集成和持续交付应用程序，无需停机</ul><p>要列出你的 Deployment，可以运行 <code>get deployments</code> 子命令：<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>kubectl get deployments</span><br></pre></table></figure><p>要列出正在运行的 Pod，可以运行 <code>get pods</code> 子命令：<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>kubectl get pods</span><br></pre></table></figure><p>要查看应用程序当前的镜像版本，可以运行 <code>describe pods</code> 子命令， 然后查找 <code>Image</code> 字段：<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>kubectl describe pods</span><br></pre></table></figure><p>要将应用程序的镜像版本更新为 v2，可以使用 <code>set image</code> 子命令， 后面跟着 Deployment 名称和新版本的镜像：<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>kubectl set image deployments/kubernetes-bootcamp kubernetes-bootcamp=docker.io/jocatalin/kubernetes-bootcamp:v2</span><br></pre></table></figure><p>此命令通知 Deployment 为应用程序使用不同的镜像，并启动滚动更新。 要检查新 Pod 的状态，并查看旧 Pod 的终止状况，可以使用 <code>get pods</code> 子命令：<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>kubectl get pods</span><br></pre></table></figure><p>要回滚 Deployment 到你上一次工作版本的更新，可以运行 <code>rollout undo</code> 子命令：<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>kubectl rollout undo deployments/kubernetes-bootcamp</span><br></pre></table></figure><p><code>rollout undo</code> 命令会恢复 Deployment 到先前的已知状态（<code>v2</code> 的镜像）。 更新是有版本控制的，你可以恢复 Deployment 到任何先前已知状态。<h2 id=配置><a class=headerlink href=#配置 title=配置></a>配置</h2><p>很多应用<strong>在其初始化或运行期间要依赖一些配置信息</strong>。 大多数时候，存在要调整配置参数所设置的数值的需求。 ConfigMap 是 Kubernetes 的一种机制，可让你将配置数据注入到应用的Pod内部。<p>ConfigMap 概念允许你将配置清单与镜像内容分离，以保持容器化的应用程序的可移植性<p>从字面量创建ConfigMap<p>使用 <code>kubectl create configmap</code> 命令基于字面量创建一个 ConfigMap：<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>kubectl create configmap fruits --from-literal=fruits=apples</span><br></pre></table></figure><p>可以<strong>从目录</strong>和<strong>文件</strong>以及<strong>字面值</strong>都能创建ConfiMap<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br></pre><td class=code><pre><span class=line><span class=meta>#</span><span class=bash> 将示例文件下载到 `configure-pod-container/configmap/` 目录</span></span><br><span class=line>wget https://kubernetes.io/examples/configmap/game.properties -O configure-pod-container/configmap/game.properties</span><br><span class=line>wget https://kubernetes.io/examples/configmap/ui.properties -O configure-pod-container/configmap/ui.properties</span><br><span class=line><span class=meta></span></span><br><span class=line><span class=meta>#</span><span class=bash> 创建 ConfigMap</span></span><br><span class=line>kubectl create configmap game-config --from-file=configure-pod-container/configmap/</span><br><span class=line>kubectl create configmap game-config-2 --from-file=configure-pod-container/configmap/game.properties</span><br><span class=line>kubectl create configmap special-config --from-literal=special.how=very --from-literal=special.type=charm</span><br></pre></table></figure><p>编辑配置文件<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>kubectl edit configmaps special-config</span><br></pre></table></figure><p>查看配置文件<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre><td class=code><pre><span class=line>kubectl get configmaps special-config -o yaml</span><br><span class=line>apiVersion: v1</span><br><span class=line>data:</span><br><span class=line>  special.how: very</span><br><span class=line>  special.type: charm</span><br><span class=line>kind: ConfigMap</span><br><span class=line>metadata:</span><br><span class=line>  creationTimestamp: "2025-12-10T13:35:12Z"</span><br><span class=line>  name: special-config</span><br><span class=line>  namespace: default</span><br><span class=line>  resourceVersion: "10165"</span><br><span class=line>  uid: ecdc4d73-0b2a-406b-ae65-b19a64977c56</span><br></pre></table></figure><p>删除配置文件<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>kubectl delete configmap special-config</span><br></pre></table></figure><h3 id=卷挂载的ConfigMap><a class=headerlink href=#卷挂载的ConfigMap title=卷挂载的ConfigMap></a>卷挂载的ConfigMap</h3><p>实现这一目标需要三个步骤：<strong>创建 ConfigMap</strong>、<strong>定义 Deployment 中的 Volume</strong>、<strong>定义容器中的 Volume Mount</strong>。<p>首先创建一个包含多个配置文件的 ConfigMap<figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br></pre><td class=code><pre><span class=line><span class=attr>apiVersion:</span> <span class=string>v1</span></span><br><span class=line><span class=attr>kind:</span> <span class=string>ConfigMap</span></span><br><span class=line><span class=attr>metadata:</span></span><br><span class=line>  <span class=attr>name:</span> <span class=string>game-config</span> <span class=comment># ConfigMap 名称</span></span><br><span class=line><span class=attr>data:</span></span><br><span class=line>  <span class=comment># 配置项 1: 作为一个文件挂载</span></span><br><span class=line>  <span class=attr>game.properties:</span> <span class=string>|</span></span><br><span class=line><span class=string>    server.port=8080</span></span><br><span class=line><span class=string>    debug.mode=false</span></span><br><span class=line><span class=string>    version=1.2.0</span></span><br><span class=line><span class=string></span></span><br><span class=line>  <span class=comment># 配置项 2: 作为一个文件挂载</span></span><br><span class=line>  <span class=attr>ui.properties:</span> <span class=string>|</span></span><br><span class=line><span class=string>    theme=dark</span></span><br><span class=line><span class=string>    language=zh-cn</span></span><br></pre></table></figure><p>创建Deployement,在 Deployment 的 Pod 模板中进行配置：<ol><li>在 <code>spec.volumes</code> 中定义一个卷（Volume），类型为 <code>configMap</code>，并引用我们创建的 <code>game-config</code>。<li>在 <code>spec.containers</code> 的 <code>volumeMounts</code> 中，指定这个卷应该挂载到容器内的哪个路径</ol><figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br></pre><td class=code><pre><span class=line><span class=attr>apiVersion:</span> <span class=string>apps/v1</span></span><br><span class=line><span class=attr>kind:</span> <span class=string>Deployment</span></span><br><span class=line><span class=attr>metadata:</span></span><br><span class=line>  <span class=attr>name:</span> <span class=string>game-server-deployment</span></span><br><span class=line><span class=attr>spec:</span></span><br><span class=line>  <span class=attr>replicas:</span> <span class=number>1</span></span><br><span class=line>  <span class=attr>selector:</span></span><br><span class=line>    <span class=attr>matchLabels:</span></span><br><span class=line>      <span class=attr>app:</span> <span class=string>game-server</span></span><br><span class=line>  <span class=attr>template:</span> <span class=comment># 创建pod</span></span><br><span class=line>    <span class=attr>metadata:</span></span><br><span class=line>      <span class=attr>labels:</span></span><br><span class=line>        <span class=attr>app:</span> <span class=string>game-server</span></span><br><span class=line>    <span class=attr>spec:</span></span><br><span class=line>      <span class=attr>containers:</span></span><br><span class=line>      <span class=bullet>-</span> <span class=attr>name:</span> <span class=string>game-container</span></span><br><span class=line>        <span class=attr>image:</span> <span class=string>your-game-image:latest</span> <span class=comment># 替换为您的应用镜像</span></span><br><span class=line>        <span class=attr>ports:</span></span><br><span class=line>        <span class=bullet>-</span> <span class=attr>containerPort:</span> <span class=number>8080</span></span><br><span class=line>        </span><br><span class=line>        <span class=comment># 2. 定义容器中的卷挂载点 (Volume Mount)</span></span><br><span class=line>        <span class=attr>volumeMounts:</span></span><br><span class=line>        <span class=bullet>-</span> <span class=attr>name:</span> <span class=string>config-volume</span>      <span class=comment># 必须匹配下面 volumes 中定义的卷名称</span></span><br><span class=line>          <span class=attr>mountPath:</span> <span class=string>/etc/config</span>   <span class=comment># 挂载到容器内的路径</span></span><br><span class=line>        </span><br><span class=line>      <span class=comment># 1. 定义 Pod 中的卷 (Volume)</span></span><br><span class=line>      <span class=attr>volumes:</span></span><br><span class=line>      <span class=bullet>-</span> <span class=attr>name:</span> <span class=string>config-volume</span>        <span class=comment># 卷的名称</span></span><br><span class=line>        <span class=attr>configMap:</span></span><br><span class=line>          <span class=attr>name:</span> <span class=string>game-config</span>        <span class=comment># 引用上面创建的 ConfigMap 名称</span></span><br><span class=line>          <span class=comment># 3. (可选) 指定权限</span></span><br><span class=line>          <span class=attr>defaultMode:</span> <span class=number>0644</span></span><br></pre></table></figure><p>在 Pod 上<strong>作为卷挂载的 ConfigMap 所发生的变更将在后续的 kubelet 同步后</strong>无缝生效。<p><strong>配置为 Pod 环境变量的 ConfigMap 所发生变更将在后续的 Pod 上线</strong>操作后生效。<p>尽管 ConfigMap 中的键的取值已经变更，Pod 中的环境变量仍然显示先前的值。 这是因为当源数据变更时，在 Pod 内运行的进程的环境变量<strong>不会</strong>被更新； 如果你想强制更新，需要让 Kubernetes 替换现有的 Pod。新 Pod 将使用更新的信息来运行。<p>你可以触发该替换。使用 <a href=https://kubernetes.io/zh-cn/docs/reference/kubectl/generated/kubectl_rollout/ rel=noopener target=_blank><code>kubectl rollout</code></a> 为 Deployment 执行上线操作：<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line><span class=meta>#</span><span class=bash> 触发上线操作</span></span><br><span class=line>kubectl rollout restart deployment configmap-env-var</span><br><span class=line><span class=meta></span></span><br><span class=line><span class=meta>#</span><span class=bash> 等待上线操作完成</span></span><br><span class=line>kubectl rollout status deployment configmap-env-var --watch=true</span><br></pre></table></figure><h3 id=环境变量注入><a class=headerlink href=#环境变量注入 title=环境变量注入></a>环境变量注入</h3><p>通过 <strong>ConfigMap</strong> 将配置数据注入到容器的<strong>环境变量</strong>中。<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br></pre><td class=code><pre><span class=line>apiVersion: v1</span><br><span class=line>kind: ConfigMap</span><br><span class=line>metadata:</span><br><span class=line>  name: fruits # 必须与 Deployment 中引用的 name: fruits 匹配</span><br><span class=line>data:</span><br><span class=line><span class=meta>  #</span><span class=bash> 键：fruits (必须与 Deployment 中引用的 key: fruits 匹配)</span></span><br><span class=line>  fruits: "Apple, Banana, Orange, Grapes" </span><br><span class=line>  </span><br><span class=line><span class=meta>  #</span><span class=bash> 您也可以添加其他键值对，但它们不会被这个 Deployment 引用</span></span><br><span class=line><span class=meta>  #</span><span class=bash> color: <span class=string>"Red"</span></span></span><br></pre></table></figure><p>创建ConfigMap文件<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>kubectl apply -f fruits-configmap.yaml</span><br></pre></table></figure><p>Deployment文件<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br></pre><td class=code><pre><span class=line>apiVersion: apps/v1</span><br><span class=line>kind: Deployment</span><br><span class=line>metadata:</span><br><span class=line>  name: configmap-env-var</span><br><span class=line>  labels:</span><br><span class=line>    app.kubernetes.io/name: configmap-env-var</span><br><span class=line>spec:</span><br><span class=line>  replicas: 3</span><br><span class=line>  selector:</span><br><span class=line>    matchLabels:</span><br><span class=line>      app.kubernetes.io/name: configmap-env-var</span><br><span class=line>  template:</span><br><span class=line>    metadata:</span><br><span class=line>      labels:</span><br><span class=line>        app.kubernetes.io/name: configmap-env-var</span><br><span class=line>    spec:</span><br><span class=line>      containers:</span><br><span class=line>        - name: alpine</span><br><span class=line>          image: alpine:3</span><br><span class=line>          env:</span><br><span class=line>            - name: FRUITS</span><br><span class=line>              valueFrom:</span><br><span class=line>                configMapKeyRef:</span><br><span class=line>                  key: fruits</span><br><span class=line>                  name: fruits</span><br><span class=line>          command:</span><br><span class=line>            - /bin/sh</span><br><span class=line>            - -c</span><br><span class=line>            - while true; do echo "$(date) The basket is full of $FRUITS";</span><br><span class=line>                sleep 10; done;</span><br><span class=line>          ports:</span><br><span class=line>            - containerPort: 80</span><br></pre></table></figure><p><code>env</code> 属性用于设置容器的环境变量。当定义一个环境变量时，通常会直接使用 <code>value</code> 属性来指定一个静态值。<p>然而，<code>valueFrom</code> 属性提供了一种更动态的方式来设置环境变量的值，它可以从集群内的其他资源（如 ConfigMap、Secret、或 Pod/Node 的字段）中获取数据。这在您不希望将敏感信息（如密码）或配置值直接硬编码到 Pod 定义中时非常有用。<figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre><td class=code><pre><span class=line><span class=attr>spec:</span></span><br><span class=line>  <span class=attr>containers:</span></span><br><span class=line>  <span class=bullet>-</span> <span class=attr>name:</span> <span class=string>my-app</span></span><br><span class=line>    <span class=attr>image:</span> <span class=string>my-registry/my-app:latest</span></span><br><span class=line>    <span class=attr>env:</span></span><br><span class=line>    <span class=comment># 使用 value 属性设置一个静态的环境变量</span></span><br><span class=line>    <span class=bullet>-</span> <span class=attr>name:</span> <span class=string>APP_ENVIRONMENT</span> </span><br><span class=line>      <span class=attr>value:</span> <span class=string>"production"</span>   <span class=comment># 环境变量 APP_ENVIRONMENT 的值被硬编码为 "production"</span></span><br><span class=line>    </span><br><span class=line>    <span class=comment># 使用 value 属性设置另一个静态变量</span></span><br><span class=line>    <span class=bullet>-</span> <span class=attr>name:</span> <span class=string>TIMEOUT_SECONDS</span></span><br><span class=line>      <span class=attr>value:</span> <span class=string>"30"</span></span><br></pre></table></figure><figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br></pre><td class=code><pre><span class=line><span class=attr>env:</span></span><br><span class=line><span class=bullet>-</span> <span class=attr>name:</span> <span class=string>LOG_LEVEL</span></span><br><span class=line>  <span class=attr>valueFrom:</span></span><br><span class=line>    <span class=attr>configMapKeyRef:</span></span><br><span class=line>      <span class=attr>name:</span> <span class=string>app-config</span>       <span class=comment># 引用 ConfigMap 的名称</span></span><br><span class=line>      <span class=attr>key:</span> <span class=string>log_level</span>         <span class=comment># 引用 ConfigMap 中要使用的键</span></span><br><span class=line>      <span class=attr>optional:</span> <span class=literal>false</span>        <span class=comment># (可选) 如果 ConfigMap 或 key 不存在，是否允许启动</span></span><br></pre></table></figure><h3 id=边车容器><a class=headerlink href=#边车容器 title=边车容器></a>边车容器</h3><p>边车容器是<strong>与主应用程序容器在同一Pod内一起运行的辅助容器</strong>。这些容器通过提供额外的服务或功能（如日志记录、监控、安全或数据同步）来增强或扩展主<strong>应用容器</strong>的功能， 而<strong>无需直接修改主应用程序代码。</strong><p>Kubernetes将边车容器作为Init容器的一个特例来实现， Pod 启动后，边车容器仍保持运行状态。 本文档使用术语”常规 Init 容器”来明确指代仅在 Pod 启动期间运行的容器。<p>如果你的集群启用了 <code>SidecarContainers</code> 特性门控，你可以为 Pod 的 <code>initContainers</code> 字段中列出的容器指定 <code>restartPolicy</code>。 这些可重新启动的<strong>边车（Sidecar）</strong> 容器独立于其他 Init 容器以及同一 Pod 内的主应用容器， 这些容器可以启动、停止和重新启动，而不会影响主应用容器和其他 Init 容器。<h2 id=无状态应用><a class=headerlink href=#无状态应用 title=无状态应用></a>无状态应用</h2><h3 id=公开外部IP地址><a class=headerlink href=#公开外部IP地址 title=公开外部IP地址></a>公开外部IP地址</h3><figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br></pre><td class=code><pre><span class=line><span class=attr>apiVersion:</span> <span class=string>apps/v1</span></span><br><span class=line><span class=attr>kind:</span> <span class=string>Deployment</span></span><br><span class=line><span class=attr>metadata:</span></span><br><span class=line>  <span class=attr>labels:</span></span><br><span class=line>    <span class=attr>app.kubernetes.io/name:</span> <span class=string>load-balancer-example</span></span><br><span class=line>  <span class=attr>name:</span> <span class=string>hello-world</span></span><br><span class=line><span class=attr>spec:</span></span><br><span class=line>  <span class=attr>replicas:</span> <span class=number>5</span></span><br><span class=line>  <span class=attr>selector:</span></span><br><span class=line>    <span class=attr>matchLabels:</span></span><br><span class=line>      <span class=attr>app.kubernetes.io/name:</span> <span class=string>load-balancer-example</span></span><br><span class=line>  <span class=attr>template:</span></span><br><span class=line>    <span class=attr>metadata:</span></span><br><span class=line>      <span class=attr>labels:</span></span><br><span class=line>        <span class=attr>app.kubernetes.io/name:</span> <span class=string>load-balancer-example</span></span><br><span class=line>    <span class=attr>spec:</span></span><br><span class=line>      <span class=attr>containers:</span></span><br><span class=line>      <span class=bullet>-</span> <span class=attr>image:</span> <span class=string>gcr.io/google-samples/hello-app:2.0</span></span><br><span class=line>        <span class=attr>name:</span> <span class=string>hello-world</span></span><br><span class=line>        <span class=attr>ports:</span></span><br><span class=line>        <span class=bullet>-</span> <span class=attr>containerPort:</span> <span class=number>8080</span></span><br><span class=line></span><br></pre></table></figure><p>创建一个Deployment对象和一个关联的ReplicaSet对象。 ReplicaSet 有五个Pod， 每个都运行 Hello World 应用。<figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>kubectl apply -f https://k8s.io/examples/service/load-balancer-example.yaml</span><br></pre></table></figure><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br></pre><td class=code><pre><span class=line><span class=meta>#</span><span class=bash>显示有关 Deployment 的信息</span></span><br><span class=line>kubectl get deployments hello-world</span><br><span class=line>kubectl describe deployments hello-world</span><br><span class=line><span class=meta>#</span><span class=bash>显示有关 ReplicaSet 对象的信息</span></span><br><span class=line>kubectl get replicasets</span><br><span class=line>kubectl describe replicasets</span><br><span class=line><span class=meta>#</span><span class=bash>创建公开 Deployment 的 Service 对象</span></span><br><span class=line>kubectl expose deployment hello-world --type=LoadBalancer --name=my-service</span><br><span class=line><span class=meta>#</span><span class=bash>显示有关 Service 的信息</span></span><br><span class=line>kubectl get services my-service</span><br><span class=line><span class=meta>#</span><span class=bash> 显示有关 Service 的详细信息</span></span><br><span class=line>kubectl describe services my-service</span><br><span class=line><span class=meta>#</span><span class=bash> 显示节点信息</span></span><br><span class=line>kubectl get pods --output=wide</span><br></pre></table></figure><h2 id=有状态应用><a class=headerlink href=#有状态应用 title=有状态应用></a>有状态应用</h2><blockquote><p>StatefulSet 运行一组 Pod，并为每个 Pod 保留一个稳定的标识。 这可用于<strong>管理需要持久化存储或稳定、唯一网络标识的应用</strong></blockquote><p>StatefulSet 是用来管理有状态应用的工作负载 API 对象。<p>StatefulSet 用来管理某Pod集合的部署和扩缩， 并为这些 Pod 提供持久存储和持久标识符。<p>和Deplopyment 类似， StatefulSet 管理基于相同容器规约的一组 Pod。但和 Deployment 不同的是， StatefulSet 为<strong>它们的每个 Pod 维护了一个有粘性的 ID。这些 Pod 是基于相同的规约来创建的， 但是不能相互替换：无论怎么调度，每个 Pod 都有一个永久不变的 ID</strong>。<p>StatefulSet 对于需要满足以下一个或多个需求的应用程序很有价值：<ul><li>稳定的、唯一的网络标识符。<li>稳定的、持久的存储。<li>有序的、优雅的部署和扩缩。<li>有序的、自动的滚动更新。</ul><figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br></pre><td class=code><pre><span class=line><span class=attr>apiVersion:</span> <span class=string>v1</span></span><br><span class=line><span class=attr>kind:</span> <span class=string>Service</span></span><br><span class=line><span class=attr>metadata:</span></span><br><span class=line>  <span class=attr>name:</span> <span class=string>nginx</span></span><br><span class=line>  <span class=attr>labels:</span></span><br><span class=line>    <span class=attr>app:</span> <span class=string>nginx</span></span><br><span class=line><span class=attr>spec:</span></span><br><span class=line>  <span class=attr>ports:</span></span><br><span class=line>  <span class=bullet>-</span> <span class=attr>port:</span> <span class=number>80</span></span><br><span class=line>    <span class=attr>name:</span> <span class=string>web</span></span><br><span class=line>  <span class=attr>clusterIP:</span> <span class=string>None</span></span><br><span class=line>  <span class=attr>selector:</span></span><br><span class=line>    <span class=attr>app:</span> <span class=string>nginx</span></span><br></pre></table></figure><figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br></pre><td class=code><pre><span class=line><span class=attr>apiVersion:</span> <span class=string>apps/v1</span></span><br><span class=line><span class=attr>kind:</span> <span class=string>StatefulSet</span></span><br><span class=line><span class=attr>metadata:</span></span><br><span class=line>  <span class=attr>name:</span> <span class=string>web</span></span><br><span class=line><span class=attr>spec:</span></span><br><span class=line>  <span class=attr>serviceName:</span> <span class=string>"nginx"</span></span><br><span class=line>  <span class=attr>replicas:</span> <span class=number>2</span></span><br><span class=line>  <span class=attr>selector:</span></span><br><span class=line>    <span class=attr>matchLabels:</span></span><br><span class=line>      <span class=attr>app:</span> <span class=string>nginx</span></span><br><span class=line>  <span class=attr>template:</span></span><br><span class=line>    <span class=attr>metadata:</span></span><br><span class=line>      <span class=attr>labels:</span></span><br><span class=line>        <span class=attr>app:</span> <span class=string>nginx</span></span><br><span class=line>    <span class=attr>spec:</span></span><br><span class=line>      <span class=attr>containers:</span></span><br><span class=line>      <span class=bullet>-</span> <span class=attr>name:</span> <span class=string>nginx</span></span><br><span class=line>        <span class=attr>image:</span> <span class=string>registry.k8s.io/nginx-slim:0.21</span></span><br><span class=line>        <span class=attr>ports:</span></span><br><span class=line>        <span class=bullet>-</span> <span class=attr>containerPort:</span> <span class=number>80</span></span><br><span class=line>          <span class=attr>name:</span> <span class=string>web</span></span><br><span class=line>        <span class=attr>volumeMounts:</span></span><br><span class=line>        <span class=bullet>-</span> <span class=attr>name:</span> <span class=string>www</span></span><br><span class=line>          <span class=attr>mountPath:</span> <span class=string>/usr/share/nginx/html</span></span><br><span class=line>  <span class=attr>volumeClaimTemplates:</span></span><br><span class=line>  <span class=bullet>-</span> <span class=attr>metadata:</span></span><br><span class=line>      <span class=attr>name:</span> <span class=string>www</span></span><br><span class=line>    <span class=attr>spec:</span></span><br><span class=line>      <span class=attr>accessModes:</span> [ <span class=string>"ReadWriteOnce"</span> ]</span><br><span class=line>      <span class=attr>resources:</span></span><br><span class=line>        <span class=attr>requests:</span></span><br><span class=line>          <span class=attr>storage:</span> <span class=string>1Gi</span></span><br><span class=line></span><br></pre></table></figure><p>StatefulSet 默认以严格的顺序创建其 Pod。<p>对于一个拥有 <strong>n</strong> 个副本的 StatefulSet，Pod 被部署时是按照 <strong>{0..n-1}</strong> 的序号顺序创建的。 在第一个终端中使用 <code>kubectl get</code> 检查输出<h2 id=参考资料><a class=headerlink href=#参考资料 title=参考资料></a>参考资料</h2><ol><li><a href=https://kubernetes.io/zh-cn/docs/concepts/architecture/ rel=noopener target=_blank>Kubernetes 架构 | Kubernetes</a><li><a href=https://www.oryoy.com/news/k8s-ru-men-zhi-nan-ruan-yi-feng-qin-shou-qing-song-zhang-wo-rong-qi-bian-pai-he-xin-ji-qiao.html rel=noopener target=_blank>K8s入门指南：阮一峰亲授，轻松掌握容器编排核心技巧 - 云原生实践</a><li><a href=https://www.ruanyifeng.com/blog/2024/09/tke-appfabric.html rel=noopener target=_blank>白话多集群：工具和应用助手 - 阮一峰的网络日志</a><li><a href=https://www.bilibili.com/video/BV1Se411r7vY/?spm_id_from=333.337.search-card.all.click&vd_source=177ef88aa6608bc3652c72d71b0aa098 rel=noopener target=_blank>Kubernetes一小时轻松入门_哔哩哔哩_bilibili</a></ol><p>在线环境:<ul><li><a href=https://killercoda.com/learn rel=noopener target=_blank>Killercoda Interactive Environments</a><li><a href=https://labs.play-with-k8s.com/ rel=noopener target=_blank>Play with Kubernetes</a></ul><link href=/css/spoiler.css rel=stylesheet><script async src=/js/spoiler.js></script></div><div><div><div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><div class=reward-container><div>感谢阅读.</div><button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">打赏</button><div style="display: none;" id=qr><div style="display: inline-block;"><img alt="Sekyoro 微信支付" src=/images/wechatpay.png><p>微信支付</div></div></div><div><ul class=post-copyright><li class=post-copyright-author><strong>本文作者： </strong>Sekyoro<li class=post-copyright-link><strong>本文链接：</strong> <a href=https://www.sekyoro.top/2025/12/07/k8s%E5%AD%A6%E4%B9%A0/ title=k8s学习>https://www.sekyoro.top/2025/12/07/k8s学习/</a><li class=post-copyright-license><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ rel=noopener target=_blank><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</ul></div><div class=followme><p>欢迎关注我的其它发布渠道<div class=social-list><div class=social-item><a class=social-link href=/images/wxqrcode.png target=_blank> <span class=icon> <i class="fab fa-weixin"></i> </span> <span class=label>WeChat</span> </a></div><div class=social-item><a class=social-link href=/images/website.png target=_blank> <span class=icon> <i class="fa fa-user"></i> </span> <span class=label>PersonalWebsite</span> </a></div><div class=social-item><a class=social-link href=https://my-astro-git-main-drowning-in-codes.vercel.app target=_blank> <span class=icon> <i class="fas fa-share"></i> </span> <span class=label>杂鱼分享</span> </a></div><div class=social-item><a class=social-link href=/atom.xml target=_blank> <span class=icon> <i class="fa fa-rss"></i> </span> <span class=label>RSS</span> </a></div></div></div><footer class=post-footer><div class=post-tags><a href=/tags/k8s/ rel=tag><i class="fa fa-tag"></i> k8s</a></div><div class=post-nav><div class=post-nav-item><a href=/2025/12/06/Java%E8%BF%9B%E9%98%B6%E7%9F%A5%E8%AF%86/ rel=prev title=Java进阶知识> <i class="fa fa-chevron-left"></i> Java进阶知识 </a></div><div class=post-nav-item><a href=/2025/12/30/%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99%E6%9E%84%E5%BB%BA%E6%8C%87%E5%8D%97/ rel=next title=博客网站构建指南> 博客网站构建指南 <i class="fa fa-chevron-right"></i> </a></div></div></footer></article></div><!-- 评论区 --><div class=comments><div data-id=city data-uid=MTAyMC81MzE5Ny8yOTY3Mg== id=lv-container></div></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class=sidebar><div class=sidebar-inner><!-- canvas粒子时钟 --><div><canvas id=canvas style=width:60%;>当前浏览器不支持canvas，请更换浏览器后再试</canvas></div><script>(function(){

   var digit=
    [
        [
            [0,0,1,1,1,0,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,0,1,1,0],
            [0,0,1,1,1,0,0]
        ],//0
        [
            [0,0,0,1,1,0,0],
            [0,1,1,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [1,1,1,1,1,1,1]
        ],//1
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,1,1],
            [1,1,1,1,1,1,1]
        ],//2
        [
            [1,1,1,1,1,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//3
        [
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,0],
            [0,0,1,1,1,1,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,1,1,0],
            [1,1,1,1,1,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,1]
        ],//4
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,1,1,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//5
        [
            [0,0,0,0,1,1,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//6
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0]
        ],//7
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//8
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,1,1,0,0,0,0]
        ],//9
        [
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0]
        ]//:
    ];

var canvas = document.getElementById('canvas');

if(canvas.getContext){
    var cxt = canvas.getContext('2d');
    //声明canvas的宽高
    var H = 100,W = 700;
    canvas.height = H;
    canvas.width = W;
    cxt.fillStyle = '#f00';
    cxt.fillRect(10,10,50,50);

    //存储时间数据
    var data = [];
    //存储运动的小球
    var balls = [];
    //设置粒子半径
    var R = canvas.height/20-1;
    (function(){
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        //存储时间数字，由十位小时、个位小时、冒号、十位分钟、个位分钟、冒号、十位秒钟、个位秒钟这7个数字组成
        data.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
    })();

    /*生成点阵数字*/
    function renderDigit(index,num){
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    cxt.beginPath();
                    cxt.arc(14*(R+2)*index + j*2*(R+1)+(R+1),i*2*(R+1)+(R+1),R,0,2*Math.PI);
                    cxt.closePath();
                    cxt.fill();
                }
            }
        }
    }

    /*更新时钟*/
    function updateDigitTime(){
        var changeNumArray = [];
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        var NewData = [];
        NewData.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
        for(var i = data.length-1; i >=0 ; i--){
            //时间发生变化
            if(NewData[i] !== data[i]){
                //将变化的数字值和在data数组中的索引存储在changeNumArray数组中
                changeNumArray.push(i+'_'+(Number(data[i])+1)%10);
            }
        }
        //增加小球
        for(var i = 0; i< changeNumArray.length; i++){
            addBalls.apply(this,changeNumArray[i].split('_'));
        }
        data = NewData.concat();
    }

    /*更新小球状态*/
    function updateBalls(){
        for(var i = 0; i < balls.length; i++){
            balls[i].stepY += balls[i].disY;
            balls[i].x += balls[i].stepX;
            balls[i].y += balls[i].stepY;
            if(balls[i].x > W + R || balls[i].y > H + R){
                balls.splice(i,1);
                i--;
            }
        }
    }

    /*增加要运动的小球*/
    function addBalls(index,num){
        var numArray = [1,2,3];
        var colorArray =  ["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"];
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    var ball = {
                        x:14*(R+2)*index + j*2*(R+1)+(R+1),
                        y:i*2*(R+1)+(R+1),
                        stepX:Math.floor(Math.random() * 4 -2),
                        stepY:-2*numArray[Math.floor(Math.random()*numArray.length)],
                        color:colorArray[Math.floor(Math.random()*colorArray.length)],
                        disY:1
                    };
                    balls.push(ball);
                }
            }
        }
    }

    /*渲染*/
    function render(){
        //重置画布宽度，达到清空画布的效果
        canvas.height = 100;
        //渲染时钟
        for(var i = 0; i < data.length; i++){
            renderDigit(i,data[i]);
        }
        //渲染小球
        for(var i = 0; i < balls.length; i++){
            cxt.beginPath();
            cxt.arc(balls[i].x,balls[i].y,R,0,2*Math.PI);
            cxt.fillStyle = balls[i].color;
            cxt.closePath();
            cxt.fill();
        }
    }

    clearInterval(oTimer);
    var oTimer = setInterval(function(){
        //更新时钟
        updateDigitTime();
        //更新小球状态
        updateBalls();
        //渲染
        render();
    },50);
}

})();</script><!-- require APlayer --><link href=https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js></script><!-- require MetingJS --><script src=/js/meting-js.js></script><ul class="sidebar-nav motion-element"><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link href=#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5><span class=nav-number>1.</span> <span class=nav-text>基本概念</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%8E%A7%E5%88%B6%E5%B9%B3%E9%9D%A2><span class=nav-number>1.1.</span> <span class=nav-text>控制平面</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E8%8A%82%E7%82%B9%E7%BB%84%E4%BB%B6><span class=nav-number>1.2.</span> <span class=nav-text>节点组件</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E8%8A%82%E7%82%B9><span class=nav-number>1.2.1.</span> <span class=nav-text>节点</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Pod><span class=nav-number>1.2.2.</span> <span class=nav-text>Pod</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%AE%B9%E5%99%A8><span class=nav-number>1.2.3.</span> <span class=nav-text>容器</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF%E5%92%8C%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B7%AE%E5%88%AB><span class=nav-number>1.3.</span> <span class=nav-text>容器技术和虚拟机差别</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Minikube><span class=nav-number>1.4.</span> <span class=nav-text>Minikube</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E9%83%A8%E7%BD%B2%E5%BA%94%E7%94%A8><span class=nav-number>1.5.</span> <span class=nav-text>部署应用</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%88%A9%E7%94%A8minikube%E5%88%9B%E5%BB%BADeployment><span class=nav-number>1.5.1.</span> <span class=nav-text>利用minikube创建Deployment</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%88%A9%E7%94%A8minikbe%E5%88%9B%E5%BB%BAService><span class=nav-number>1.6.</span> <span class=nav-text>利用minikbe创建Service</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#kubectl%E5%9F%BA%E7%A1%80><span class=nav-number>1.7.</span> <span class=nav-text>kubectl基础</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1><span class=nav-number>1.8.</span> <span class=nav-text>负载均衡</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%BB%9A%E5%8A%A8%E6%9B%B4%E6%96%B0><span class=nav-number>1.9.</span> <span class=nav-text>滚动更新</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E9%85%8D%E7%BD%AE><span class=nav-number>1.10.</span> <span class=nav-text>配置</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%8D%B7%E6%8C%82%E8%BD%BD%E7%9A%84ConfigMap><span class=nav-number>1.10.1.</span> <span class=nav-text>卷挂载的ConfigMap</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E6%B3%A8%E5%85%A5><span class=nav-number>1.10.2.</span> <span class=nav-text>环境变量注入</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E8%BE%B9%E8%BD%A6%E5%AE%B9%E5%99%A8><span class=nav-number>1.10.3.</span> <span class=nav-text>边车容器</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%97%A0%E7%8A%B6%E6%80%81%E5%BA%94%E7%94%A8><span class=nav-number>1.11.</span> <span class=nav-text>无状态应用</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%85%AC%E5%BC%80%E5%A4%96%E9%83%A8IP%E5%9C%B0%E5%9D%80><span class=nav-number>1.11.1.</span> <span class=nav-text>公开外部IP地址</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%9C%89%E7%8A%B6%E6%80%81%E5%BA%94%E7%94%A8><span class=nav-number>1.12.</span> <span class=nav-text>有状态应用</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99><span class=nav-number>1.13.</span> <span class=nav-text>参考资料</span></a></ol></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop=author itemscope itemtype=http://schema.org/Person><img alt=Sekyoro class=site-author-image itemprop=image src=https://i.loli.net/2021/05/17/YqoavnXdGTpPO9R.jpg><p class=site-author-name itemprop=name>Sekyoro<div class=site-description itemprop=description>什么也无法舍弃的人，什么也做不了.</div></div><div class="site-state-wrap motion-element"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>259</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>16</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>220</span> <span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class=links-of-author-item> <a title="Personal Website → http://proanimer.com" href=http://proanimer.com/ rel=noopener target=_blank><i class="fab fa-internet-explorer fa-fw"></i>Personal Website</a> </span><span class=links-of-author-item> <a title="GitHub → https://github.com/drowning-in-codes" href=https://github.com/drowning-in-codes rel=noopener target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item> <a title="E-Mail → mailto:bukalala174@gmail.com" href=mailto:bukalala174@gmail.com rel=noopener target=_blank><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span><span class=links-of-author-item> <a title="wxPublicAccount → https://mp.weixin.qq.com/s?__biz=Mzg3ODY1MDkzMg==&mid=2247483770&idx=1&sn=fdf88faab01d5c219ac609570a21c9d6&chksm=cf113221f866bb373938cfca03cf095ff4fe1e4dc37d68ef5de4cd4876ee1260fca0c015a4d6&token=1096259873&lang=zh_CN#rd" href=https://mp.weixin.qq.com/s?__biz=Mzg3ODY1MDkzMg==&mid=2247483770&idx=1&sn=fdf88faab01d5c219ac609570a21c9d6&chksm=cf113221f866bb373938cfca03cf095ff4fe1e4dc37d68ef5de4cd4876ee1260fca0c015a4d6&token=1096259873&lang=zh_CN#rd rel=noopener target=_blank><i class="fab fa-weixin fa-fw"></i>wxPublicAccount</a> </span><span class=links-of-author-item> <a title="RSS → /atom.xml" href=/atom.xml><i class="fa fa-rss fa-fw"></i>RSS</a> </span><span class=links-of-author-item> <a title="CSDN → https://blog.csdn.net/aqwca" href=https://blog.csdn.net/aqwca rel=noopener target=_blank><i class="fa fa-handshake fa-fw"></i>CSDN</a> </span><span class=links-of-author-item> <a title="杂鱼分享 → https://my-astro-git-main-drowning-in-codes.vercel.app" href=https://my-astro-git-main-drowning-in-codes.vercel.app/ rel=noopener target=_blank><i class="fas fa-share fa-fw"></i>杂鱼分享</a> </span></div><div class="links-of-blogroll motion-element"><div class=links-of-blogroll-title><i class="fa fa-link fa-fw"></i> 友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=http://myqhs.top/ rel=noopener target=_blank title=http://myqhs.top/>myqhs</a><li class=links-of-blogroll-item><a href=https://www.lllomh.com/ rel=noopener target=_blank title=https://www.lllomh.com/>芈渡</a><li class=links-of-blogroll-item><a href=https://protool-ten.vercel.app/ rel=noopener target=_blank title=https://protool-ten.vercel.app/>protools</a></ul></div><div class="motion-element announcement"><div class=title></div><p class=content><p class=date></div></div><meting-js id=6856787487 order=random server=netease type=playlist> </meting-js><div class=widget-wrap><h3 class=widget-title style=margin:0>文章词云</h3><div class="widget tagcloud" id=myCanvasContainer><canvas height=250 id=resCanvas style=width:100% width=250><ul class=tag-list itemprop=keywords><li class=tag-list-item><a class=tag-list-link href=/tags/k8s/ rel=tag>k8s</a><span class=tag-list-count>1</span></ul></canvas></div></div><script id=clustrmaps src=https://clustrmaps.com/map_v2.js?d=xQdGTxqARTBiNIwX2aUban-ixkj2s6VaZQWo-aVCgY8&cl=ffffff&w=a></script><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i><span>0%</span></div><!-- 边栏 --></div></aside><div id=sidebar-dimmer></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© Wed Apr 08 2020 08:00:00 GMT+0800 (中国标准时间) – <span itemprop=copyrightYear>2026</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>Sekyoro</span><span class=post-meta-divider>|</span><span class=post-meta-item-icon> <i class="fa fa-chart-area"></i> </span><span title=站点总字数>4.3m</span><span class=post-meta-divider>|</span><span class=post-meta-item-icon> <i class="fa fa-coffee"></i> </span><span title=站点阅读时长>64:52</span></div><script async src=https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js></script><span id=busuanzi_container_site_pv>总访问量<span id=busuanzi_value_site_pv></span>次</span><span class=post-meta-divider>|</span><span id=busuanzi_container_site_uv>总访客数<span id=busuanzi_value_site_uv></span>人</span><span class=post-meta-divider>|</span><!-- 不蒜子计数初始值纠正 --><script>document.addEventListener("DOMContentLoaded", function() {
    var int = setInterval(fixCount, 50);  // 50ms周期检测函数
    var countOffset = 20000;  // 初始化首次数据

    function fixCount() {
        var pvContainer = document.getElementById("busuanzi_container_site_pv");
        if (pvContainer && pvContainer.style.display !== "none") {
            var pvElement = document.getElementById("busuanzi_value_site_pv");
            if (pvElement) {
                pvElement.innerHTML = parseInt(pvElement.innerHTML) + countOffset;
                clearInterval(int);
            }
        }
        
        var uvContainer = document.getElementById("busuanzi_container_site_uv");
        if (uvContainer && window.getComputedStyle(uvContainer).display !== "none")
        {
            var uvElement = document.getElementById("busuanzi_value_site_uv");
            if (uvElement) {
                uvElement.innerHTML = parseInt(uvElement.innerHTML) + countOffset; // 加上初始数据 
                clearInterval(int); // 停止检测
            }
        }
    }
});</script><div><span id=timeDate>载入天数...</span><span id=times>载入时分秒...</span><script>var now = new Date();
    function createtime() {
        var grt= new Date("04/08/2021 20:00:00");
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
    }
setInterval("createtime()",250);</script></div><div class=busuanzi-count><script async data-pjax src=https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><span style="display: none;" class=post-meta-item id=busuanzi_container_site_uv> <span class=post-meta-item-icon> <i class="fa fa-user"></i> </span> <span class=site-uv title=总访客量> <span id=busuanzi_value_site_uv></span> </span> </span><span class=post-meta-divider>|</span><span style="display: none;" class=post-meta-item id=busuanzi_container_site_pv> <span class=post-meta-item-icon> <i class="fa fa-eye"></i> </span> <span class=site-pv title=总访问量> <span id=busuanzi_value_site_pv></span> </span> </span></div></div></footer></div><script color=0,0,255 count=99 opacity=0.5 src=/lib/canvas-nest/canvas-nest.min.js zindex=-1></script><script src=/lib/anime.min.js></script><script src=https://cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0/pjax.min.js></script><script src=https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js></script><script src=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js></script><script src=https://cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js></script><script src=https://cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js></script><script src=https://cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/schemes/pisces.js></script><script src=/js/next-boot.js></script><script src=/js/bookmark.js></script><script>var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax',
	 '.widget-wrap'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
 
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
  
  // Reinitialize TagCanvas for tag cloud
  if (typeof TagCanvas !== 'undefined' && document.getElementById('resCanvas')) {
    try {
      TagCanvas.textFont = 'Trebuchet MS, Helvetica';
      TagCanvas.textColour = '#333';
      TagCanvas.textHeight = 20;
      TagCanvas.outlineColour = '#E2E1D1';
      TagCanvas.maxSpeed = 0.3;
      TagCanvas.freezeActive = true;
      TagCanvas.outlineMethod = 'block';
      TagCanvas.minBrightness = 0.2;
      TagCanvas.depth = 0.92;
      TagCanvas.pulsateTo = 0.6;
      TagCanvas.initial = [0.1,-0.1];
      TagCanvas.decel = 0.98;
      TagCanvas.reverse = true;
      TagCanvas.hideTags = false;
      TagCanvas.shadow = '#ccf';
      TagCanvas.shadowBlur = 3;
      TagCanvas.weight = false;
      TagCanvas.imageScale = null;
      TagCanvas.fadeIn = 1000;
      TagCanvas.clickToFront = 600;
      TagCanvas.lock = false;
      TagCanvas.Start('resCanvas');
      TagCanvas.tc['resCanvas'].Wheel(true);
    } catch(e) {
      console.log('TagCanvas initialization failed:', e);
    }
  }
});</script><script data-pjax>(function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();</script><script src=https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js></script><script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js></script><script src=/js/algolia-search.js></script><script data-pjax>document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});</script><div id=pjax><script charset=utf-8 defer src=/js/outdate.js></script></div><script charset=utf-8 defer src=/js/tagcanvas.js></script><script charset=utf-8 defer src=/js/tagcloud.js></script><script>NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});</script><script>var OriginTitile = document.title;
  var titleTime;
  document.addEventListener("visibilitychange", function() {
    if (document.hidden) {
      document.title = "(つェ⊂)我藏好了哦~" + OriginTitile;
      clearTimeout(titleTime);
    } else {
      document.title = "(*´∇｀*) 被你发现啦~" + OriginTitile;
      titleTime = setTimeout(function() {
        document.title = OriginTitile;
      }, 2000);
    }
  });</script><script src=/js/src/activate-power-mode.min.js></script><script>POWERMODE.colorful = true;
    POWERMODE.shake = false;
    document.body.addEventListener('input', POWERMODE);</script>