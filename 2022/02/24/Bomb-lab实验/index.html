<!doctypehtml><html lang=zh-CN><script defer src=/live2d-widget/autoload.js></script><meta charset=UTF-8><meta content=width=device-width,initial-scale=1,maximum-scale=2 name=viewport><meta content=#222 name=theme-color><meta content="Hexo 5.4.0" name=generator><link href=/images/blog_32px.png rel=apple-touch-icon sizes=180x180><link href=/images/blog_32px.png rel=icon sizes=32x32 type=image/png><link href=/images/blog_16px.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><meta content=EPrJAp11bJwHULpQUaSNSZ8_3RcvTsPDAEGOME4pl1w name=google-site-verification><!-- Google tag (gtag.js) --><!-- 
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VB21D8MKKW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VB21D8MKKW');
</script> --><!-- google adsense in head.swig --><script async crossorigin=anonymous src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4034523802263123></script><meta content=7226864CE87CE9DE8C008385273846FF name=msvalidate.01><meta content=code-fjFXVtiL7j name=baidu-site-verification><link href=/css/main.css rel=stylesheet><link as=style href=https://fonts.googleapis.com/css?family=Roboto%20Mono,Roboto:300,300italic,400,400italic,700,700italic|Roboto:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext onload=this.rel='stylesheet' rel=preload><link as=style href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css onload=this.rel='stylesheet' rel=preload><link href=https://fonts.googleapis.com/css?family=Noto+Serif+SC|Roboto&display=swap rel=stylesheet><link href=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/pace-js@1/pace.min.js></script><script id=hexo-configurations>var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.sekyoro.top","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","width":240,"display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"appID":"0F9LEEVW82","apiKey":"78839e9f9be09d081c5c4da81975cd19","indexName":"sekyoblog_sec","hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"manual","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};</script><link href=//cdn.bootcss.com/animate.css/3.5.0/animate.min.css rel=stylesheet><meta content=csapp的第二个实验.之前稀里糊涂的做过,但是并不是太懂.现在重做一下. name=description><meta content=article property=og:type><meta content="Bomb lab实验" property=og:title><meta content=https://www.sekyoro.top/2022/02/24/Bomb-lab%E5%AE%9E%E9%AA%8C/index.html property=og:url><meta content=Sekyoro的博客小屋 property=og:site_name><meta content=csapp的第二个实验.之前稀里糊涂的做过,但是并不是太懂.现在重做一下. property=og:description><meta content=zh_CN property=og:locale><meta content=http://cdn.sekyoro.top/imgs/093711.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093713.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/065644.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/065645.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093715.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093718.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093721.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093724.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093729.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/065647.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/065648.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093732.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/065650.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/065651.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093736.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093738.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/065652.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/065654.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093741.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093745.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/065657.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093748.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093803.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093808.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093811.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093813.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093815.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093817.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/065659.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093818.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093821.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093822.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093824.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093826.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093827.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093829.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093831.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093832.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093836.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/065701.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093840.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093844.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093846.png property=og:image><meta content=http://cdn.sekyoro.top/imgs/093854.png property=og:image><meta content=2022-02-24T07:27:22.000Z property=article:published_time><meta content=2022-04-01T09:52:58.000Z property=article:modified_time><meta content=Sekyoro property=article:author><meta content=csapp property=article:tag><meta content="bomb lab" property=article:tag><meta content=summary name=twitter:card><meta content=http://cdn.sekyoro.top/imgs/093711.png name=twitter:image><link href=https://www.sekyoro.top/2022/02/24/Bomb-lab%E5%AE%9E%E9%AA%8C/ rel=canonical><script id=page-configurations>// https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };</script><title>Bomb lab实验 | Sekyoro的博客小屋</title><noscript><style>.use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }</style></noscript><link href=/atom.xml rel=alternate title=Sekyoro的博客小屋 type=application/atom+xml><body itemscope itemtype=http://schema.org/WebPage><canvas style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" class=fireworks></canvas><script defer src=https://cdn.bootcss.com/animejs/2.2.0/anime.min.js></script><script defer src=/js/src/fireworks.js></script><div class="container use-motion"><div class=headband></div><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <span class=logo-line-before><i></i></span> <h1 class=site-title>Sekyoro的博客小屋</h1> <span class=logo-line-after><i></i></span> </a></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu" id=menu><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>关于</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-bangumis"><a href=/bangumis/ rel=section><i class="fa fa-film fa-fw"></i>追番</a><li class="menu-item menu-item-resume"><a href=/resume/ rel=section><i class="fa fa-file-pdf fa-fw"></i>简历</a><li class="menu-item menu-item-materials"><a href=/materials/ rel=section><i class="fa fa-book fa-fw"></i>学习资料</a><li class="menu-item menu-item-sitemap"><a href=/sitemap.xml rel=section><i class="fa fa-sitemap fa-fw"></i>站点地图</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container></div><span class=popup-btn-close> <i class="fa fa-times-circle"></i> </span></div><div class=algolia-results><div id=algolia-stats></div><div id=algolia-hits></div><div class=algolia-pagination id=algolia-pagination></div></div></div></div></div></header><a class="book-mark-link book-mark-link-fixed" role=button></a><main class=main><div class=main-inner><div class=content-wrap><div class="content post posts-expand"><article class=post-block itemscope itemtype=http://schema.org/Article lang=zh-CN><link href=https://www.sekyoro.top/2022/02/24/Bomb-lab%E5%AE%9E%E9%AA%8C/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=https://i.loli.net/2021/05/17/YqoavnXdGTpPO9R.jpg itemprop=image> <meta content=Sekyoro itemprop=name> <meta content=什么也无法舍弃的人，什么也做不了. itemprop=description> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=Sekyoro的博客小屋 itemprop=name> </span><header class=post-header><h1 itemprop="name headline" class=post-title>Bomb lab实验</h1><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2022-02-24 15:27:22" datetime=2022-02-24T15:27:22+08:00>2022-02-24</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2022-04-01 17:52:58" datetime=2022-04-01T17:52:58+08:00 itemprop=dateModified>2022-04-01</time> </span><span style="display: none;" class=post-meta-item id=busuanzi_container_page_pv title=阅读次数> <span class=post-meta-item-icon> <i class="fa fa-eye"></i> </span> <span class=post-meta-item-text>阅读次数：</span> <span id=busuanzi_value_page_pv></span> </span><br><span class=post-meta-item title=本文字数> <span class=post-meta-item-icon> <i class="far fa-file-word"></i> </span> <span class=post-meta-item-text>本文字数：</span> <span>17k</span> </span><span class=post-meta-item title=阅读时长> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>阅读时长 ≈</span> <span>15 分钟</span> </span></div></header><div class=post-body itemprop=articleBody><p>csapp的第二个实验.<br>之前稀里糊涂的做过,但是并不是太懂.现在重做一下.<br><span id=more></span><h2 id=开始的准备><a class=headerlink href=#开始的准备 title=开始的准备></a>开始的准备</h2><p><a href=http://csapp.cs.cmu.edu/3e/labs.html rel=noopener target=_blank>CS:APP3e, Bryant and O’Hallaron (cmu.edu)</a><p>实验网址,有好几个lab.选择Bomb lab的self-study就行了.最新版2016年的.<p>原来做的时候老师没有发文档,现在有个bomblab文档,很有用.<p>我还找到了这篇pdf的机翻,不过建议一起看.<a href=https://blog.csdn.net/weixin_43362650/article/details/121047514 rel=noopener target=_blank>《深入理解计算机系统》实验二Bomb Lab下载和官方文档机翻_达的程序员日记-CSDN博客</a><p><del>说实话,到现在我还是有点不懂</del><p>需要一点对于二进制文件和汇编基础.<p><img alt=二进制文件组成 data-src=http://cdn.sekyoro.top/imgs/093711.png><ul><li>ELF文件头：存储文件类型和大小的有关信息，以及文件加载后程序执行的入口信息<li>程序头表：可执行文件的数据在虚拟地址空间中的组织方式，以及段的数目，位置以及用途<li>节：将文件分成一个个节区，每个节区都有其对应的功能，如符号表，哈希表等<li>段：就是将文件分成一段一段映射到内存中。段中通常包括一个或多个节区<li>节头表：存储段的附加信息</ul><p><img alt=类似的 data-src=http://cdn.sekyoro.top/imgs/093713.png><p>大端模式与小端模式<blockquote><p><strong>大端：多字节值的大端存储在该值的起始位置；（老大站排头为大） </strong><p><strong>小端：多字节值的小端存储在该值的起始位置</strong></blockquote><p>我这里是小端<p><img alt=64位cpu data-src=http://cdn.sekyoro.top/imgs/065644.png><h3 id=objdump与gdb常用命令><a class=headerlink href=#objdump与gdb常用命令 title=objdump与gdb常用命令></a>objdump与gdb常用命令</h3><p>(其实我觉得命令太多了记不完的,记住重要的需要时再查就行了)<h4 id=objdump><a class=headerlink href=#objdump title=objdump></a>objdump</h4><blockquote><p>-f 文件头信息<p>-h 节头表信息 输出目标文件中节表（Section Table）中所包含的所有节头（Section Header）的信息<p>-x 所有的头信息 包括文件头,程序头和节头还包括符号表信息<p>-d 反汇编 可执行节(段)信息<p>-D 反汇编所有节(段)信息<p>-S 源代码与汇编混合 编译时需要-g<p>-s 所有节以及二进制<p>-t 显示符号表<p>-T 动态符号表</blockquote><p><strong>文件头</strong><p><img alt=文件头信息 data-src=http://cdn.sekyoro.top/imgs/065645.png><p><strong>节(段)头信息</strong><p><img alt=段头表 data-src=http://cdn.sekyoro.top/imgs/093715.png><p><strong>反汇编结果</strong><p><img alt=反汇编 data-src=http://cdn.sekyoro.top/imgs/093718.png><p><strong>符号表</strong><p><img alt=符号表 data-src=http://cdn.sekyoro.top/imgs/093721.png><p><a href=https://ipcmen.com/objdump rel=noopener target=_blank>Linux objdump 命令用法详解-Linux命令大全（手册） (ipcmen.com)</a><p>节(段)介绍(注意.bss与.data .rodata)<blockquote><ul><li>.text：已编译程序的机器代码。<li>.rodata：只读数据，比如printf语句中的格式串和开关（switch）语句的跳转表。<li>.data：已初始化的全局C变量。局部C变量在运行时被保存在栈中，既不出现在.data中，也不出现在.bss节中。<li>.bss：未初始化的全局C变量。在目标文件中这个节不占据实际的空间，它仅仅是一个占位符。目标文件格式区分初始化和未初始化变量是为了空间效率在：在目标文件中，未初始化变量不需要占据任何实际的磁盘空间。<li>.symtab：一个符号表（symbol table），它存放在程序中被定义和引用的函数和全局变量的信息。一些程序员错误地认为必须通过-g选项来编译一个程序，得到符号表信息。实际上，每个可重定位目标文件在.symtab中都有一张符号表。然而，和编译器中的符号表不同，.symtab符号表不包含局部变量的表目。<li>.rel.text：当链接噐把这个目标文件和其他文件结合时，.text节中的许多位置都需要修改。一般而言，任何调用外部函数或者引用全局变量的指令都需要修改。另一方面调用本地函数的指令则不需要修改。注意，可执行目标文件中并不需要重定位信息，因此通常省略，除非使用者显式地指示链接器包含这些信息。<li>.rel.data：被模块定义或引用的任何全局变量的信息。一般而言，任何已初始化全局变量的初始值是全局变量或者外部定义函数的地址都需要被修改。<li>.debug：一个调试符号表，其有些表目是程序中定义的局部变量和类型定义，有些表目是程序中定义和引用的全局变量，有些是原始的C源文件。只有以-g选项调用编译驱动程序时，才会得到这张表。<li>.line：原始C源程序中的行号和.text节中机器指令之间的映射。只有以-g选项调用编译驱动程序时，才会得到这张表。<li>.strtab：一个字符串表，其内容包括.symtab和.debug节中的符号表，以及节头部中的节名字。字符串表就是以null结尾的字符串序列。</ul></blockquote><h4 id=gdb><a class=headerlink href=#gdb title=gdb></a>gdb</h4><blockquote><p>gdb <file> 运行二进制文件 <p>run 简介r 运行 直到执行整个程序或断点处</p> <p>break 简写b 打断点</p> <p>注意打断点可以在 行号 函数 内存地址处</p> <p>delete 简写d 删除断点</p> <p>x/nfu addr 按照指定的格式而非程序的数据类型考察内存数据(这个指令很有意思)</p> <p>continue 简写c 继续执行被调试程序 直到下一个断点或结束</p> <p>step 简写s 执行一行源程序代码，如果此行代码中有函数调用，则进入该函数</p> <p>next 简写n 执行一行源程序代码，此行代码中的函数调用也一并执行</p> <p>注意对于汇编我们需要使用si,ni代替</p> <p>print 简写p 显示变量值</p> <p>display 设置程序中断后欲显示的数据及其格式 /i 表示以十六进行显示</p> <p>undispaly，取消先前的display设置，编号从1开始递增</p> <p>quit 简写q 退出</p> <p>值得一提的是gdb tui模式,</p> <figure class="highlight sh"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br></pre><td class=code><pre><span class=line>gdb -tui <span class=comment>#进入</span></span><br><span class=line><span class=comment>#或者gdb进入后</span></span><br><span class=line>focous <span class=comment>#进入tui</span></span><br><span class=line>ctrl+x a <span class=comment>#退出tui</span></span><br><span class=line>layout  asm|reg|split|src <span class=comment>#展示相关信息</span></span><br><span class=line>ctrl+p ctrl+n <span class=comment>#gdb上一条 下一条命令</span></span><br><span class=line>Ctrl + L <span class=comment>#刷新窗口</span></span><br><span class=line>Ctrl + x <span class=comment>#再按1：单窗口模式，显示一个窗口</span></span><br><span class=line>Ctrl + x <span class=comment>#再按2：双窗口模式，显示两个窗口</span></span><br></pre></table></figure> <p>先知道这么多吧.</p> <p><a href=https://blog.csdn.net/qq_41071068/article/details/103007550 rel=noopener target=_blank>Linux 调试器gdb命令及TUI模式</a></p> <p><a href=http://csapp.cs.cmu.edu/3e/docs/gdbnotes-x86-64.pdf rel=noopener target=_blank>Enscript Output (cmu.edu)</a></p> <p>注意汇编指令也有格式 可以看出这里是AT&T格式</p> <p><a href=https://www.cnblogs.com/hdk1993/p/4820353.html rel=noopener target=_blank>Intel格式和AT&T格式汇编区别</a></p> <p>同时注意汇编指令 call ret leave</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre><td class=code><pre><span class=line>call addr:</span><br><span class=line>push rip</span><br><span class=line>mov addr rip</span><br><span class=line>#call指令 调用函数</span><br><span class=line>ret :</span><br><span class=line>pop rip</span><br><span class=line>#ret指令  返回</span><br><span class=line>leave :</span><br><span class=line>mov rbp rsp</span><br><span class=line>pop rbp</span><br><span class=line>#leave指令 关闭栈帧</span><br></pre></table></figure> <p><a href=http://c.biancheng.net/view/3537.html rel=noopener target=_blank>汇编语言CALL和RET指令：调用一个过程 (biancheng.net)</a></p> <p>还有vim查看16进制,因为需要修改二进制可执行文件</p> <figure class="highlight tex"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=params>#</span>打开file文件</span><br><span class=line>vim file</span><br><span class=line><span class=params>#</span>在命令模式下输入.. 以16进制显示</span><br><span class=line>:<span class=comment>%!xxd</span></span><br><span class=line><span class=params>#</span>在命令模式下输入.. 切换回默认显示</span><br><span class=line>:<span class=comment>%!xxd -r</span></span><br></pre></table></figure> <h4 id=readelf><a class=headerlink href=#readelf title=readelf></a>readelf</h4><blockquote><p>-h ELF文件开始的文件头信息<p>-l 程序头 节到段的映射<p>-S 显示节头信息<p>-s 符号表信息<p>-r 显示可重定位段的信息<p>-d 显示动态段的信息</blockquote> <h2 id=正式开始><a class=headerlink href=#正式开始 title=正式开始></a>正式开始</h2><h3 id=initial-bomb><a class=headerlink href=#initial-bomb title=initial_bomb></a>initial_bomb</h3><p>首先先看源文件,不得不说这个作者真的很humorous.</p> <p>注意如果运行时无参数就读取输入,否则读取文件.</p> <p><img alt=根据参数确定输入 data-src=http://cdn.sekyoro.top/imgs/093724.png></p> <p>然后进入了initialize_bomb函数,我们尝试看一看.</p> <figure class="highlight sh"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>objdump -d bomb</span><br></pre></table></figure> <p>这样可以查看.text段里的信息.</p> <p>查看initialize_bomb这个函数</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br></pre><td class=code><pre><span class=line>00000000004013a2 &LTinitialize_bomb>:</span><br><span class=line>  4013a2:       48 83 ec 08             sub    $0x8,%rsp</span><br><span class=line>  4013a6:       be a0 12 40 00          mov    $0x4012a0,%esi</span><br><span class=line>  4013ab:       bf 02 00 00 00          mov    $0x2,%edi</span><br><span class=line>  4013b0:       e8 db f7 ff ff          callq  400b90 &LTsignal@plt></span><br><span class=line>  4013b5:       48 83 c4 08             add    $0x8,%rsp</span><br><span class=line>  4013b9:       c3   </span><br></pre></table></figure> <p>首先开栈,注意这是x86_64架构的,mov指令是mov src->dst,这跟intel指令不一样.</p> <div class=table-container><table><thead><tr><th><strong>AT&T</strong> <strong>格式</strong><th><strong>Intel</strong> <strong>格式</strong><tbody><tr><td>movl -4(%ebp), %eax<td>mov eax, [ebp - 4]<tr><td>movl array(, %eax, 4), %eax<td>mov eax, [eax*4 + array]<tr><td>movw array(%ebx, %eax, 4), %cx<td>mov cx, [ebx + 4*eax + array]<tr><td>movb $4, %fs:(%eax)<td>mov fs:eax, 4</table></div> <div class=table-container><table><thead><tr><th>寄存器<th>描述<tbody><tr><td>rdi<td>传递第一个参数<tr><td>rsi<td>传递第二个参数</table></div> <p><a href=https://blog.csdn.net/lidonghat/article/details/70244288 rel=noopener target=_blank>寄存器介绍</a>这个可以看一看</p> <p>这里有一篇很好的文章<a href=https://mengkang.net/1390.html rel=noopener target=_blank>x86-64 规定只有6个寄存器来存参数，那 C 函数为什么还能超过6个参数呢？ (mengkang.net)</a></p> <p>当了解了汇编基础知识(其实可以面向搜索引擎学习,遇到不懂的指令去搜索就可以了)后,我们知道esi值第二个参数,edi是第一个参数.然后callq 400b90转去执行这个函数.</p> <p><img alt=signal@plt函数 data-src=http://cdn.sekyoro.top/imgs/093729.png></p> <p>注意jmpq *0x2024c2(%rip)表示跳转到 %rip+0x2024c2地址所存储的值,即0x603058地址存储的值(是一个地址)</p> <p>这个函数叫signal@plt,我也不懂,我在网上搜索后.这跟链接,重定位相关<a href=https://blog.csdn.net/u012741741/article/details/51870752 rel=noopener target=_blank>重定位和链接</a></p> <p><a href=https://www.cnblogs.com/xingyun/archive/2011/12/10/2283149.html rel=noopener target=_blank>Linux动态链接之GOT与PLT</a></p> <p><a href=https://blog.csdn.net/anzhsoft/article/details/18776111 rel=noopener target=_blank>Linux Debugging（七）: 使用反汇编理解动态库函数调用方式GOT/PLT<em>anzhsoft的技术专栏-CSDN博客</em>动态库反汇编</a></p> <p><a href=https://stackoverflow.com/questions/5469274/what-does-plt-mean-here rel=noopener target=_blank>assembly - What does @plt mean here? - Stack Overflow</a></p> <p>在实际的可执行程序或者共享目标文件中，GOT表在名称为.got.plt的section中，PLT表在名称为.plt的section中</p> <blockquote><p>GOT是Global Offset Table，是保存库函数地址的区域。程序运行时，库函数的地址会设置到GOT中。由于动态库的函数是在使用时才被加载，因此刚开始GOT表是空的。地址的设置就涉及到了PLT，Procedure Linkage Table，它包含了一些代码以调用库函数，它可以被理解成一系列的小函数，这些小函数的数量其实就是库函数的被使用到的函数的数量。<p>简单来说，PLT就是跳转到GOT中所设置的地址而已。如果这个地址是空，那么PLT的跳转会巧妙的调用_dl_runtime_resolve去获取最终地址并设置到GOT中去。由于库函数的地址在运行时不会变，因此GOT一旦设置以后PLT就可以直接跳转到库函数的真实地址了。</blockquote> <p>stack overflow中的解答,类似的</p> <blockquote><p><code>printf@plt</code> is actually a small stub which (eventually) calls the real <code>printf</code> function, modifying things on the way to make subsequent calls faster.<p>The <em>real</em> <code>printf</code> function may be mapped into <em>any</em> location in a given process (virtual address space) as may the code that is trying to call it.<p>So, in order to allow proper code sharing of calling code (left side below) and called code (right side below), you don’t want to apply any fixups to the calling code directly since that will restrict where it can be located in <em>other</em> processes.</blockquote> <p>让我们也试试看吧.</p> <p>首先signal@plt跳转到一个地址(*0x603058),这里需要gdb看一看</p> <p><img alt=0x603058地址上是什么呢 data-src=http://cdn.sekyoro.top/imgs/065647.png></p> <p>所以jmp到了0x00400b96,这个这份地址又是什么呢,有点眼熟？注意signal@plt中的汇编代码,貌似我们又跳回来了.</p> <p><img alt=地址上的指令 data-src=http://cdn.sekyoro.top/imgs/065648.png></p> <p>使用gdb的x指令查看内存的数据,指定x /5i 表示往后五个单位的指令(i表示指令),可以看出先把0x0b压栈,又跳转一个地址0x400ad0</p> <p><img alt=跳转的地方 data-src=http://cdn.sekyoro.top/imgs/093732.png></p> <p>使用gdb执行到0x400ad0处</p> <p><img alt=image-20220225200719489 data-src=http://cdn.sekyoro.top/imgs/065650.png></p> <p>我在这卡了很久,因为我以为跳转的就是这个地址,实际上这是32位的值,是原本64位地址的低地址.jmpq跳转到64位地址.这也跟我gdb使用不熟练有关</p> <p><img alt=image-20220225201622362 data-src=http://cdn.sekyoro.top/imgs/065651.png></p> <p>然后执行函数</p> <p><img alt=动态库函数 data-src=http://cdn.sekyoro.top/imgs/093736.png></p> <p>这中间又跳转执行了很多函数。</p> <p>最后又跳了回来.</p> <p><img alt=流程图 data-src=http://cdn.sekyoro.top/imgs/093738.png></p> <p><a href=https://blog.csdn.net/qq_18661257/article/details/54694748?locationNum=1&fps=1 rel=noopener target=_blank>GOT表和PLT表知识详解_qq_18661257的专栏-CSDN博客_got表</a></p> <p>再来看看传入的参数0x4012a0,可以看到这是函数的地址<img alt=一个函数的地址 data-src=http://cdn.sekyoro.top/imgs/065652.png></p> <p>可以知道在initial_bomb中使用了signal函数,传入信号量2,调用写的sig_handler函数.</p> <p>sig_handler中进行了一些设置,主要捕获中断信号,针对ctrl+c.</p> <p><a href=https://www.runoob.com/cprogramming/c-function-signal.html rel=noopener target=_blank>C 库函数 – signal() | 菜鸟教程 (runoob.com)</a></p> <p>好了,initial_bomb就解析到这吧.</p> <h3 id=phase-1><a class=headerlink href=#phase-1 title=phase_1></a>phase_1</h3><p><img alt=phase_1 data-src=http://cdn.sekyoro.top/imgs/065654.png></p> <p>还是很好理解的,读取输入并传输函数.</p> <p>第一行就不说明了,使用gdb调试第二行.</p> <figure class="highlight sh"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>b phase_1 <span class=comment>#打断点</span></span><br><span class=line>r <span class=comment>#运行</span></span><br></pre></table></figure> <p>随便进行输入,然后进入函数.接下来就是艰难的读汇编代码阶段.</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br></pre><td class=code><pre><span class=line>0x400ee0 &LTphase_1>      sub    $0x8,%rsp                                                                                          </span><br><span class=line>  0x400ee4 &LTphase_1+4>    mov    $0x402400,%esi                                                                                     </span><br><span class=line>  0x400ee9 &LTphase_1+9>    callq  0x401338 &LTstrings_not_equal>                                                                        </span><br><span class=line>  0x400eee &LTphase_1+14>   test   %eax,%eax                                                                                           </span><br><span class=line>  0x400ef0 &LTphase_1+16>   je     0x400ef7 &LTphase_1+23>                                                                               </span><br><span class=line>  0x400ef2 &LTphase_1+18>   callq  0x40143a &LTexplode_bomb>                                                                             </span><br><span class=line>  0x400ef7 &LTphase_1+23>   add    $0x8,%rsp                                                                                           </span><br><span class=line>  0x400efb &LTphase_1+27>   retq  </span><br></pre></table></figure> <p>可以看到首先是开栈,栈顶移动8个字节,然后将$0x402400赋值给函数第二个调用参数,然后调用函数,通过名字就可以知道是判断字符串是否相等.然后测试结果根据结果进行跳转.je 表示相等就跳转否则调用炸弹爆炸.</p> <p>我们到stings_not_equal中看看,其实不用细看,我们主要想知道进行比较的是什么字符串,它们的地址是什么.</p> <p><img alt=stings_not_equal data-src=http://cdn.sekyoro.top/imgs/093741.png></p> <p>首先需要肯定的是,调用字符串比较函数需要参数,%esi是第二个参数.我们看看这个寄存器的值</p> <p>x /s显示地址上的值,以字符串形式.</p> <p><img alt=查看内存地址的字符串 data-src=http://cdn.sekyoro.top/imgs/093745.png></p> <p>使用info r查看寄存器%rdi值<img alt=寄存器值 data-src=http://cdn.sekyoro.top/imgs/065657.png></p> <p>看到了之前随意输入的参数</p> <p><img alt=%rdi所存地址上的值 data-src=http://cdn.sekyoro.top/imgs/093748.png></p> <p>所以字符串修改为0x402400上的字符串即可.</p> <p>参数可以为文件,每行一个题答案.</p> <figure class="highlight sh"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>./bomb myanswers.txt</span><br></pre></table></figure> <p><img alt=解决第一题 data-src=http://cdn.sekyoro.top/imgs/093803.png></p> <p>phase_defused函数,我们也可以看看.估计就是输出一些语句就行了.</p> <p><img alt=phase_defused data-src=http://cdn.sekyoro.top/imgs/093808.png></p> <h3 id=phase-2><a class=headerlink href=#phase-2 title=phase_2></a>phase_2</h3><figure class="highlight c"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=comment>/* The second phase is harder.  No one will ever figure out</span></span><br><span class=line><span class=comment>     * how to defuse this... */</span></span><br><span class=line>    input = read_line();</span><br><span class=line>    phase_2(input);</span><br><span class=line>    phase_defused();</span><br><span class=line>    <span class=built_in>printf</span>(<span class=string>"That's number 2.  Keep going!\n"</span>);</span><br></pre></table></figure> <p>可以在gdb使用set args设置参数为答案文本.</p> <p>然后继续打断点,打在phase_2即可</p> <p><img alt=phase_2代码 data-src=http://cdn.sekyoro.top/imgs/093811.png></p> <p>可以看到先读取了调用函数6个数字,在这之前将栈顶地址移到$rsi中,可以看看这个函数</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br></pre><td class=code><pre><span class=line>0x40145c &LTread_six_numbers>     sub    $0x18,%rsp                                                                                  │</span><br><span class=line>│   0x401460 &LTread_six_numbers+4>   mov    %rsi,%rdx                                                                                   │</span><br><span class=line>│   0x401463 &LTread_six_numbers+7>   lea    0x4(%rsi),%rcx                                                                              │</span><br><span class=line>│   0x401467 &LTread_six_numbers+11>  lea    0x14(%rsi),%rax                                                                             │</span><br><span class=line>│   0x40146b &LTread_six_numbers+15>  mov    %rax,0x8(%rsp)                                                                              │</span><br><span class=line>│   0x401470 &LTread_six_numbers+20>  lea    0x10(%rsi),%rax                                                                             │</span><br><span class=line>│   0x401474 &LTread_six_numbers+24>  mov    %rax,(%rsp)                                                                                 │</span><br><span class=line>│   0x401478 &LTread_six_numbers+28>  lea    0xc(%rsi),%r9                                                                               │</span><br><span class=line>│   0x40147c &LTread_six_numbers+32>  lea    0x8(%rsi),%r8                                                                               │</span><br><span class=line>│   0x401480 &LTread_six_numbers+36>  mov    $0x4025c3,%esi                                                                              │</span><br><span class=line>│   0x401485 &LTread_six_numbers+41>  mov    $0x0,%eax                                                                                   │</span><br><span class=line>│   0x40148a &LTread_six_numbers+46>  callq  0x400bf0 <__isoc99_sscanf@plt>                                                              │</span><br><span class=line>│   0x40148f &LTread_six_numbers+51>  cmp    $0x5,%eax                                                                                   │</span><br><span class=line>│   0x401492 &LTread_six_numbers+54>  jg     0x401499 &LTread_six_numbers+61>                                                              │</span><br><span class=line>│   0x401494 &LTread_six_numbers+56>  callq  0x40143a &LTexplode_bomb>                                                                     │</span><br><span class=line>│   0x401499 &LTread_six_numbers+61>  add    $0x18,%rsp                                                                                  │</span><br><span class=line>│   0x40149d &LTread_six_numbers+65>  retq</span><br></pre></table></figure> <p>可以看到调用了sscanf@plt也就是后面会执行sanf函数,需要两参数,一个格式字符串.看到mov $0x4025c3 %esi,看一下是什么</p> <figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>(gdb) x 0x4025c3</span><br><span class=line>0x4025c3:       "%d %d %d %d %d %d"</span><br></pre></table></figure> <p>也就是六个整数.这一有一个知识点,传函数参数时,如果数量比较多那么就会使用栈.也就是使用%rbp或%rsp指示,同时函数参数是从右往左开始的,也就是最后一个输入的参数会先被传入寄存器或栈中.</p> <p>再看看%edi</p> <figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>(gdb) x /s $edi</span><br><span class=line>0x6037d0 &LTinput_strings+80>:    "1 12 23 34 13 100"</span><br></pre></table></figure> <p>即传入了这个字符串到read_six_numbers函数.</p> <p>注意到后面有jg即大于跳转,也就是输入的正确参数要大于5,即6个(跟函数名称一样就行了).然后跳出这个函数.继续执行</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line> 0x400f05 &LTphase_2+9>    callq  0x40145c &LTread_six_numbers>                                                                         </span><br><span class=line>0x400f0a &LTphase_2+14>   cmpl   $0x1,(%rsp)                                                                                         </span><br><span class=line> 0x400f0e &LTphase_2+18>   je     0x400f30 &LTphase_2+52> </span><br></pre></table></figure> <p>后面又继续跳转到0x400f30(当然这里有条件寄存器rsp值等于1,后面会说)</p> <p><img alt=跳转到这 data-src=http://cdn.sekyoro.top/imgs/093813.png></p> <p>这里进行了赋值后又继续跳转到0x400f17</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line>0x400f17 &LTphase_2+27>   mov    -0x4(%rbx),%eax                                                                                     </span><br><span class=line>  0x400f1a &LTphase_2+30>   add    %eax,%eax                                                                                          </span><br><span class=line> 0x400f1c &LTphase_2+32>   cmp    %eax,(%rbx)                                                                                         </span><br><span class=line>  0x400f1e &LTphase_2+34>   je     0x400f25 &LTphase_2+41>                                                                               </span><br><span class=line> 0x400f20 &LTphase_2+36>   callq  0x40143a &LTexplode_bomb> </span><br></pre></table></figure> <p>可以看出又会进行比较值相等才能避免爆炸,相等的话又会跳转到一个地址0x400f25.</p> <p>0x400f25</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre><td class=code><pre><span class=line>0x400f25 &LTphase_2+41>   add    $0x4,%rbx                                                                                           │</span><br><span class=line>│   0x400f29 &LTphase_2+45>   cmp    %rbp,%rbx                                                                                           │</span><br><span class=line>│   0x400f2c &LTphase_2+48>   jne    0x400f17 &LTphase_2+27>                                                                               │</span><br><span class=line>│   0x400f2e &LTphase_2+50>   jmp    0x400f3c &LTphase_2+64>                                                                               │</span><br><span class=line>│   0x400f30 &LTphase_2+52>   lea    0x4(%rsp),%rbx                                                                                      │</span><br><span class=line>│   0x400f35 &LTphase_2+57>   lea    0x18(%rsp),%rbp                                                                                     │</span><br><span class=line>│   0x400f3a &LTphase_2+62>   jmp    0x400f17 &LTphase_2+27>                                                                               │</span><br><span class=line>│   0x400f3c &LTphase_2+64>   add    $0x28,%rsp                                                                                          │</span><br><span class=line>│   0x400f40 &LTphase_2+68>   pop    %rbx                                                                                                │</span><br><span class=line>│   0x400f41 &LTphase_2+69>   pop    %rbp                                                                                                │</span><br><span class=line>│   0x400f42 &LTphase_2+70>   retq           </span><br></pre></table></figure> <p>可以看到这里又会进行比较如果不等又会跳回去,相等才能脱离苦海.如果你想锻炼你的汇编代码阅读能力可以直接硬读,我这直接设置6个特别的数值然后看看寄存器存储的什么值.</p> <p>跳出读取6个值的函数后,跳回0x400f0a,这里对寄存器$rsp值进行了比较(如果你设置特殊值进行多次测试就知道这个值等于什么了)</p> <p>这里我们回去关注一下%rsp的值(关于寄存器符号我这里%与$混合使用)</p> <p>所以我们需要好好探讨一下read_six_numbers中传给scanf的参数.</p> <p>关于函数传参寄存器中存储的值.</p> <p><a href=https://blog.csdn.net/qq_31917799/article/details/104233427 rel=noopener target=_blank>C语言参数传递所使用的寄存器<em>天马行空-CSDN博客</em>参数寄存器</a></p> <p>由于%edi是phase_2传入read_six_numbers的参数,所以read_six_numbers向scanf传参是从%esi开始,需要七个参数(6个数字与一个格式化参数).rdx,rcx,r8,r9也是传参的寄存器,算上%esi就有五个,还有两个就需要用栈了.</p> <p>可以看到在read_six_numbers中将%rsi传给了%rdx,这是第一个参,然后将0x4(%rsi)存储的值赋给%rcx,就是第二个参数.(一个值4字节,但一个寄存器大小是8字节).也就是说%rcx存储的是第二个参数的地址.</p> <p><img alt=栈与寄存器 data-src=http://cdn.sekyoro.top/imgs/093815.png></p> <p>还是画图好理解.开始的4个用寄存器存,后面的寄存器不够雷人用栈存.当scanf执行完后,%rsp = %rsp’.所以(%rsp)就是输入的第一个值.返回值%eax就是6(正确读取了6个值)</p> <p>所以第一个值为1.至于为什么是第一个而不是最后一个,因为要存储最后两个值寄存器不够所以入栈了,它们值存储在距离phase_2栈帧的栈顶最远的地方.</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line>0x400f30 &LTphase_2+52>   lea    0x4(%rsp),%rbx                                                                                      </span><br><span class=line>   0x400f35 &LTphase_2+57>   lea    0x18(%rsp),%rbp                                                                                    </span><br><span class=line>   0x400f3a &LTphase_2+62>   jmp    0x400f17 &LTphase_2+27>  </span><br></pre></table></figure> <p>然后便是将%rbx赋值为第二个值的地址,栈底赋值为%rsp+24.24个字节是6个int大小.</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line>0x400f17 &LTphase_2+27>   mov    -0x4(%rbx),%eax                                                                                     </span><br><span class=line>   0x400f1a &LTphase_2+30>   add    %eax,%eax                                                                                           </span><br><span class=line>   0x400f1c &LTphase_2+32>   cmp    %eax,(%rbx)</span><br></pre></table></figure> <p>然后将上一个值赋给%eax,再加倍.判断与当前值的大小.相等才能避免爆炸</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>0x400f25 &LTphase_2+41>   add    $0x4,%rbx                                                                                           </span><br><span class=line>0x400f29 &LTphase_2+45>   cmp    %rbp,%rbx</span><br></pre></table></figure> <p>再将当前值指向下一个(4字节是一个int大小),然后将地址与%rbp比较.因为%rbp = 0x18(%rsp).经历五次循环后就结束了.而每循环都需要将当前值设置为前一个值的二倍.</p> <p>所以结果就是1 2 4 8 16 32</p> <h3 id=phase-3><a class=headerlink href=#phase-3 title=phase_3></a>phase_3</h3><p>有空了,开冲.</p> <p><img alt=phase_3 data-src=http://cdn.sekyoro.top/imgs/093817.png></p> <p>代码类似.在这之前</p> <p><img alt=将读取的字符串传参 data-src=http://cdn.sekyoro.top/imgs/065659.png></p> <p>将输入值传入phase_3参数.</p> <p><img alt=phase_3代码 data-src=http://cdn.sekyoro.top/imgs/093818.png></p> <p>进入phase_3函数查看0x4025cf的值</p> <figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>(gdb) x 0x4025cf</span><br><span class=line>0x4025cf:       "%d %d"</span><br></pre></table></figure> <p>后面调用scanf函数,第一个参数就在%esi中,”%d %d”表示传入两个整数,第一个在%rdx,第二个在%rcx.</p> <p>cmp $0x1,%eax表示比较,必须大于一个才能跳转.</p> <p>后面比较第二个参数,ja表示无符号比较.<a href=https://blog.csdn.net/poptar/article/details/111686050 rel=noopener target=_blank>汇编语言—-跳转指令ja、jb、jl<em>poptar的博客-CSDN博客</em>汇编语言ja</a></p> <p><img alt=比较输入的参数 data-src=http://cdn.sekyoro.top/imgs/093821.png></p> <p>0x400fad跳转到一个调用引爆炸弹的地方,所以第一个参数要小于等于7.</p> <figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line><span class=meta>></span><span class=bash>0x400fad &LTphase_3+106>  callq  0x40143a &LTexplode_bomb></span> </span><br></pre></table></figure> <p>后面jmp到一个地址,<em>(0x402470)(,%rax,8) 8表示8个字节,即(0x402470)(,%rax,8)表示0x402470+%rax\</em>8.</p> <p><strong>寻址方式</strong></p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>地址或偏移(%基址或偏移量寄存器, %索引寄存器, 比例因子)</span><br></pre></table></figure> <p>地址的计算公式是:</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>最终地址 = 地址或偏移 + %基址或偏移量寄存器 + %索引寄存器  * 比例因子</span><br></pre></table></figure> <p>这里第一个参数假设为6,地址是400f9f x/10gx 表示查看后面10个giant(8字节)以16进制形式的数据</p> <p><img alt=跳转的地址 data-src=http://cdn.sekyoro.top/imgs/093822.png></p> <p>0x2aa移到%eax值然后与第二个参数进行比较,需要等于才能避免爆炸.</p> <p>所以这就是一个答案,一共应该有0-6七组答案,这里我就不写了.</p> <h3 id=phase-4><a class=headerlink href=#phase-4 title=phase_4></a>phase_4</h3><p>进入phase_4函数,查看x $edi表明是将输入的参数传入函数phase_4.</p> <p>在函数中后面又继续传入参数,x 0x4025cf</p> <p><img alt=phase_4 data-src=http://cdn.sekyoro.top/imgs/093824.png></p> <figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>(gdb) x 0x4025cf</span><br><span class=line>0x4025cf:       "%d %d"</span><br></pre></table></figure> <p>表明需要输入两个整数.0xc(%rsp)是第二个参数,0x8(%rsp)是第一个参数.</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line>>0x40102c &LTphase_4+32>   jne    0x401035 &LTphase_4+41>                                                                               </span><br><span class=line>  0x40102e &LTphase_4+34>   cmpl   $0xe,0x8(%rsp)                                                                                      </span><br><span class=line>  0x401033 &LTphase_4+39>   jbe    0x40103a &LTphase_4+46>                                                                               </span><br><span class=line>  0x401035 &LTphase_4+41>   callq  0x40143a &LTexplode_bomb> </span><br></pre></table></figure> <p>如果不是输入了两个整数jne跳向炸弹爆炸.接着进行比较第一个整数,与0xe(14)比较.jbe表示小于等于.也就是第一个参数如果小于等于14则跳转否则不跳转爆炸.</p> <p>这里我们输入14,后面跳转到0x40103a,将14赋值给%edx. %esi赋值为0.第一个参数赋值给%edi.调用func4.</p> <p>也就是func4(第一个参数(这里我们是14),0,14).</p> <p>查看func4函数</p> <p><img alt=func4函数 data-src=http://cdn.sekyoro.top/imgs/093826.png></p> <p>SHR（右移）指令使目的操作数逻辑右移若干位，最高位用 0 填充。最低位复制到进位标志位，而进位标志位中原来的数值被丢弃.因为%ecx值是0xe,最低位是0.CF=0.</p> <p>sar与shr差别 两者的区别在于SAR右移时保留操作数的符号，即用符号位来补足，而SHR右移时总是用0来补足</p> <p>sar %eax表示将%eax存储的值右移一位,最高位由符号位补齐.14右移一位得到7.</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br></pre><td class=code><pre><span class=line>│   0x400fdf &LTfunc4+17>     lea    (%rax,%rsi,1),%ecx                                                                                  │</span><br><span class=line>│  >0x400fe2 &LTfunc4+20>     cmp    %edi,%ecx                                                                                           │</span><br><span class=line>│   0x400fe4 &LTfunc4+22>     jle    0x400ff2 &LTfunc4+36>                                                                                 │</span><br><span class=line>│   0x400fe6 &LTfunc4+24>     lea    -0x1(%rcx),%edx                                                                                     │</span><br><span class=line>│   0x400fe9 &LTfunc4+27>     callq  0x400fce &LTfunc4>                                                                                    │</span><br><span class=line>│   0x400fee &LTfunc4+32>     add    %eax,%eax                                                                                           │</span><br><span class=line>    0x400ff0 &LTfunc4+34>     jmp    0x401007 &LTfunc4+57> </span><br></pre></table></figure> <p>我们可以先看看函数外的判断</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line>40104d:       85 c0                   test   %eax,%eax</span><br><span class=line>40104f:       75 07                   jne    401058 &LTphase_4+0x4c></span><br><span class=line>401051:       83 7c 24 0c 00          cmpl   $0x0,0xc(%rsp)</span><br><span class=line>401056:       74 05                   je     40105d &LTphase_4+0x51</span><br></pre></table></figure> <p><a href=https://blog.csdn.net/counsellor/article/details/81005101 rel=noopener target=_blank>test和je指令的组合用法_counsellor的专栏-CSDN博客_je指令</a></p> <p>所以我们需要函数结果为0,同时第二个参数也为0.</p> <p>比较简单的处理就是第一个参数等于%ecx,也就是等于7.</p> <p><img alt=大致流程 data-src=http://cdn.sekyoro.top/imgs/093827.png></p> <h3 id=phase-5><a class=headerlink href=#phase-5 title=phase_5></a>phase_5</h3><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>40107a:       e8 9c 02 00 00          callq  40131b &LTstring_length></span><br><span class=line>40107f:       83 f8 06                cmp    $0x6,%eax</span><br></pre></table></figure> <p>输入参数,字符串长度等于6.所以需要输入含有6个字符的字符串.</p> <p>进入phase_5函数.</p> <p>注意后面的代码</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line>4010b3:       be 5e 24 40 00          mov    $0x40245e,%esi</span><br><span class=line>4010b8:       48 8d 7c 24 10          lea    0x10(%rsp),%rdi</span><br><span class=line>4010bd:       e8 76 02 00 00          callq  401338 &LTstrings_not_equal></span><br><span class=line>4010c2:       85 c0                   test   %eax,%eax</span><br><span class=line>4010c4:       74 13                   je     4010d9 &LTphase_5+0x77></span><br><span class=line></span><br></pre></table></figure> <p>可以看到将0x40245e赋值给%esi</p> <p>看一下是什么</p> <figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>(gdb) x /s 0x40245e</span><br><span class=line>0x40245e:       "flyers"</span><br></pre></table></figure> <p>表明我们的%rdi的需要等于这个字符串.</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br></pre><td class=code><pre><span class=line>40108b:       0f b6 0c 03             movzbl (%rbx,%rax,1),%ecx</span><br><span class=line>40108f:       88 0c 24                mov    %cl,(%rsp)</span><br><span class=line>401092:       48 8b 14 24             mov    (%rsp),%rdx</span><br><span class=line>401096:       83 e2 0f                and    $0xf,%edx</span><br><span class=line>401099:       0f b6 92 b0 24 40 00    movzbl 0x4024b0(%rdx),%edx</span><br><span class=line>4010a0:       88 54 04 10             mov    %dl,0x10(%rsp,%rax,1)</span><br><span class=line>4010a4:       48 83 c0 01             add    $0x1,%rax</span><br><span class=line>4010a8:       48 83 f8 06             cmp    $0x6,%rax</span><br><span class=line>4010ac:       75 dd                   jne    40108b &LTphase_5+0x29></span><br><span class=line>4010ae:       c6 44 24 16 00          movb   $0x0,0x16(%rsp)</span><br></pre></table></figure> <p>注意到将0x4024b0后面的字节移动到%edi.而之前的%rdx是由我们输入的字符的ascii码与0xf相与得到的.</p> <figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>(gdb) x 0x4024b0</span><br><span class=line>0x4024b0 &LTarray.3449>:  "maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you?"</span><br></pre></table></figure> <p>所以需要首先得到flyers每个字母在上面字符串中的位置,分别是(从0开始)9 15 14 5 6.</p> <p>我们输入的6个字符的ascii码与0xf相与后必须是以上的值.所以答案有很多.</p> <p>比如0x69 0x6f 0x6e 0x65 0x66.即ionefg</p> <h3 id=phase-6><a class=headerlink href=#phase-6 title=phase_6></a>phase_6</h3><p><img alt=phase_6 data-src=http://cdn.sekyoro.top/imgs/093829.png></p> <p>一开始进行比较</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line> 0x401145 &LTphase_6+81>   add    $0x1,%ebx                                                                                           │</span><br><span class=line>│  >0x401148 &LTphase_6+84>   cmp    $0x5,%ebx                                                                                           │</span><br><span class=line>│   0x40114b &LTphase_6+87>   jle    0x401135 &LTphase_6+65>                                                                               │</span><br><span class=line>│   0x40114d &LTphase_6+89>   add    $0x4,%r13                                                                                           │</span><br><span class=line>│   0x401151 &LTphase_6+93>   jmp    0x401114 &LTphase_6+32>                                                                               │</span><br><span class=line>│   0x401153 &LTphase_6+95>   lea    0x18(%rsp),%rsi  </span><br></pre></table></figure> <p>6个数均小于等于6且不能相等.</p> <p>后面跳转到0x0000000000401153,用7去减去每一个数</p> <p>0x40116f 0x40116f 0x401188</p> <p>0x4011ab这里的代码将链表反向串联,便于比较.</p> <figure class="highlight apache"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line><span class=attribute>x</span> /<span class=number>24</span>wx <span class=number>0</span>x<span class=number>6032</span>d<span class=number>0</span></span><br></pre></table></figure> <p><img alt=链表结构 data-src=http://cdn.sekyoro.top/imgs/093831.png></p> <p><img alt=存储的值 data-src=http://cdn.sekyoro.top/imgs/093832.png></p> <p>执行完后</p> <p><img alt=循环执行完毕 data-src=http://cdn.sekyoro.top/imgs/093836.png></p> <p><img alt=node结构 data-src=http://cdn.sekyoro.top/imgs/065701.png></p> <p><strong>关键代码</strong></p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br></pre><td class=code><pre><span class=line>  0x4011d0 &LTphase_6+220>  jmp    0x4011bd &LTphase_6+201>                                                                              │</span><br><span class=line>│   0x4011d2 &LTphase_6+222>  movq   $0x0,0x8(%rdx)                                                                                      │</span><br><span class=line>│   0x4011da &LTphase_6+230>  mov    $0x5,%ebp                                                                                           │</span><br><span class=line>│   0x4011df &LTphase_6+235>  mov    0x8(%rbx),%rax                                                                                      │</span><br><span class=line>│   0x4011e3 &LTphase_6+239>  mov    (%rax),%eax                                                                                         │</span><br><span class=line>│  >0x4011e5 &LTphase_6+241>  cmp    %eax,(%rbx)                                                                                         │</span><br><span class=line>│   0x4011e7 &LTphase_6+243>  jge    0x4011ee &LTphase_6+250>                                                                              │</span><br><span class=line>│   0x4011e9 &LTphase_6+245>  callq  0x40143a &LTexplode_bomb> </span><br></pre></table></figure> <p>000032d0是node1的地址,这里需要修改二进制文件.</p> <p>将节点值从头到尾依次增大(假设输入 1 2 3 4 5 6).</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br></pre><td class=code><pre><span class=line>0x4011e5 &LTphase_6+241>  cmp    %eax,(%rbx)                                                                                         │</span><br><span class=line>│   0x4011e7 &LTphase_6+243>  jge    0x4011ee &LTphase_6+250>                                                                              │</span><br><span class=line>│   0x4011e9 &LTphase_6+245>  callq  0x40143a &LTexplode_bomb>                                                                             │</span><br><span class=line>│   0x4011ee &LTphase_6+250>  mov    0x8(%rbx),%rbx                                                                                      │</span><br><span class=line>│   0x4011f2 &LTphase_6+254>  sub    $0x1,%ebp                                                                                           │</span><br><span class=line>│   0x4011f5 &LTphase_6+257>  jne    0x4011df &LTphase_6+235>                                                                              │</span><br><span class=line>│   0x4011f7 &LTphase_6+259>  add    $0x50,%rsp                                                                                          │</span><br><span class=line>│  >0x4011fb &LTphase_6+263>  pop    %rbx                                                                                                │</span><br><span class=line>│   0x4011fc &LTphase_6+264>  pop    %rbp                                                                                                │</span><br><span class=line>│   0x4011fd &LTphase_6+265>  pop    %r12 </span><br></pre></table></figure> <h3 id=secret-phase><a class=headerlink href=#secret-phase title=secret_phase></a>secret_phase</h3><p>strings bomb发现有一个secret_phase很可疑.</p> <p>查看反汇编文件发现与phase_defused有关</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br></pre><td class=code><pre><span class=line>00000000004015c4 &LTphase_defused>:</span><br><span class=line>  4015c4:       48 83 ec 78             sub    $0x78,%rsp</span><br><span class=line>  4015c8:       64 48 8b 04 25 28 00    mov    %fs:0x28,%rax</span><br><span class=line>  4015cf:       00 00 </span><br><span class=line>  4015d1:       48 89 44 24 68          mov    %rax,0x68(%rsp)</span><br><span class=line>  4015d6:       31 c0                   xor    %eax,%eax</span><br><span class=line>  4015d8:       83 3d 81 21 20 00 06    cmpl   $0x6,0x202181(%rip)        # 603760 &LTnum_input_strings></span><br><span class=line>  4015df:       75 5e                   jne    40163f &LTphase_defused+0x7b></span><br><span class=line>  4015e1:       4c 8d 44 24 10          lea    0x10(%rsp),%r8</span><br><span class=line>  4015e6:       48 8d 4c 24 0c          lea    0xc(%rsp),%rcx</span><br><span class=line>  4015eb:       48 8d 54 24 08          lea    0x8(%rsp),%rdx</span><br><span class=line>  4015f0:       be 19 26 40 00          mov    $0x402619,%esi</span><br><span class=line>  4015f5:       bf 70 38 60 00          mov    $0x603870,%edi</span><br><span class=line>  4015fa:       e8 f1 f5 ff ff          callq  400bf0 <__isoc99_sscanf@plt></span><br><span class=line>  4015ff:       83 f8 03                cmp    $0x3,%eax</span><br><span class=line>  401602:       75 31                   jne    401635 &LTphase_defused+0x71></span><br><span class=line>  401604:       be 22 26 40 00          mov    $0x402622,%esi</span><br><span class=line>  401609:       48 8d 7c 24 10          lea    0x10(%rsp),%rdi</span><br><span class=line>  40160e:       e8 25 fd ff ff          callq  401338 &LTstrings_not_equal></span><br><span class=line>  401613:       85 c0                   test   %eax,%eax</span><br><span class=line>  401615:       75 1e                   jne    401635 &LTphase_defused+0x71></span><br><span class=line>  401617:       bf f8 24 40 00          mov    $0x4024f8,%edi</span><br><span class=line>  40161c:       e8 ef f4 ff ff          callq  400b10 &LTputs@plt></span><br><span class=line>  401621:       bf 20 25 40 00          mov    $0x402520,%edi</span><br><span class=line>  401626:       e8 e5 f4 ff ff          callq  400b10 &LTputs@plt></span><br></pre></table></figure> <p><img alt=进入secret_phase的方法 data-src=http://cdn.sekyoro.top/imgs/093840.png></p> <p>需要在第四题答案后加上这个字符串.</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line>(gdb) x /s 0x603870</span><br><span class=line>0x603870 &LTinput_strings+240>:   "7 0"</span><br><span class=line>(gdb) x /s 0x402619</span><br><span class=line>0x402619:       "%d %d %s"</span><br></pre></table></figure> <p>比较输入过的答案数量,等于6则进行特殊的测试.</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br></pre><td class=code><pre><span class=line>0x4015d8 &LTphase_defused+20>     cmpl   $0x6,0x202181(%rip)        # 0x603760 &LTnum_input_strings>                                   │</span><br><span class=line>│  >0x4015df &LTphase_defused+27>     jne    0x40163f &LTphase_defused+123>                                                                │</span><br><span class=line>│   0x4015e1 &LTphase_defused+29>     lea    0x10(%rsp),%r8                                                                              │</span><br><span class=line>│   0x4015e6 &LTphase_defused+34>     lea    0xc(%rsp),%rcx                                                                              │</span><br><span class=line>│   0x4015eb &LTphase_defused+39>     lea    0x8(%rsp),%rdx                                                                              │</span><br><span class=line>│   0x4015f0 &LTphase_defused+44>     mov    $0x402619,%esi                                                                              │</span><br><span class=line>│   0x4015f5 &LTphase_defused+49>     mov    $0x603870,%edi     </span><br></pre></table></figure> <p><img alt=secrete_phase data-src=http://cdn.sekyoro.top/imgs/093844.png></p> <p>最后结果需要等于2</p> <figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br></pre><td class=code><pre><span class=line>0000000000401204 &LTfun7>:</span><br><span class=line>  401204:       48 83 ec 08             sub    $0x8,%rsp</span><br><span class=line>  401208:       48 85 ff                test   %rdi,%rdi</span><br><span class=line>  40120b:       74 2b                   je     401238 &LTfun7+0x34></span><br><span class=line>  40120d:       8b 17                   mov    (%rdi),%edx</span><br><span class=line>  40120f:       39 f2                   cmp    %esi,%edx</span><br><span class=line>  401211:       7e 0d                   jle    401220 &LTfun7+0x1c></span><br><span class=line>  401213:       48 8b 7f 08             mov    0x8(%rdi),%rdi</span><br><span class=line>  401217:       e8 e8 ff ff ff          callq  401204 &LTfun7></span><br><span class=line>  40121c:       01 c0                   add    %eax,%eax</span><br><span class=line>  40121e:       eb 1d                   jmp    40123d &LTfun7+0x39></span><br><span class=line>  401220:       b8 00 00 00 00          mov    $0x0,%eax</span><br><span class=line>  401225:       39 f2                   cmp    %esi,%edx</span><br><span class=line>  401227:       74 14                   je     40123d &LTfun7+0x39></span><br><span class=line>  401229:       48 8b 7f 10             mov    0x10(%rdi),%rdi</span><br><span class=line>  40122d:       e8 d2 ff ff ff          callq  401204 &LTfun7></span><br><span class=line>  401232:       8d 44 00 01             lea    0x1(%rax,%rax,1),%eax</span><br><span class=line>  401236:       eb 05                   jmp    40123d &LTfun7+0x39></span><br><span class=line>  401238:       b8 ff ff ff ff          mov    $0xffffffff,%eax</span><br><span class=line>  40123d:       48 83 c4 08             add    $0x8,%rsp</span><br><span class=line>  401241:       c3                      retq</span><br><span class=line></span><br></pre></table></figure> <p>需要等于一个类似二叉树中节点的值才能跳出来.</p> <p><img alt=fun7逻辑 data-src=http://cdn.sekyoro.top/imgs/093846.png></p> <p>同时不能随便等于一个节点值,2 = 1+1,需要等与第二个节点值.如果给的参数值大于等于节点值才能进行进一步等于的比较</p> <p><img alt=全部完成 data-src=http://cdn.sekyoro.top/imgs/093854.png></p> <p>gdb设置汇编代码风格,Linux下是AT&T.</p> <p><a href=https://blog.csdn.net/freezing111/article/details/70576865 rel=noopener target=_blank>Linux下gdb显示intel和at&t汇编_freezing111的博客-CSDN博客</a></p> <p><a href=https://blog.csdn.net/astrotycoon/article/details/8211754 rel=noopener target=_blank>使用vim编辑可执行文件—16进制模式_astrotycoon-CSDN博客</a></p> <h2 id=结束语><a class=headerlink href=#结束语 title=结束语></a>结束语</h2><p>网上搜到的资料</p> <p><a href=https://www.jianshu.com/p/c219e4df2521 rel=noopener target=_blank>CSAPP: Bomb Lab 实验解析 - 简书 (jianshu.com)</a></p> <p>IDA反汇编工具</p> <p>做到后面不想写了…核心还是函数的一些知识和循环分支语句的汇编代码,传参用的寄存器.</p> <p>注意第六题其实并不需要改变可执行文件,需要按顺序排列1-6,这里我直接改变的可执行文件…</p> <link href=/css/spoiler.css rel=stylesheet><script async src=/js/spoiler.js></script> <div><div><div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div> <div class=reward-container><div>感谢阅读.</div><button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">打赏</button><div style="display: none;" id=qr><div style="display: inline-block;"><img alt="Sekyoro 微信支付" src=/images/wechatpay.png><p>微信支付</div></div></div> <div><ul class=post-copyright><li class=post-copyright-author><strong>本文作者： </strong>Sekyoro<li class=post-copyright-link><strong>本文链接：</strong> <a title="Bomb lab实验" href=https://www.sekyoro.top/2022/02/24/Bomb-lab%E5%AE%9E%E9%AA%8C/>https://www.sekyoro.top/2022/02/24/Bomb-lab实验/</a><li class=post-copyright-license><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ rel=noopener target=_blank><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</ul></div> <div class=followme><p>欢迎关注我的其它发布渠道<div class=social-list><div class=social-item><a class=social-link href=/images/wxqrcode.png target=_blank> <span class=icon> <i class="fab fa-weixin"></i> </span> <span class=label>WeChat</span> </a></div><div class=social-item><a class=social-link href=/images/website.png target=_blank> <span class=icon> <i class="fa fa-user"></i> </span> <span class=label>PersonalWebsite</span> </a></div><div class=social-item><a class=social-link href=https://my-astro-git-main-drowning-in-codes.vercel.app target=_blank> <span class=icon> <i class="fas fa-share"></i> </span> <span class=label>杂鱼分享</span> </a></div><div class=social-item><a class=social-link href=/atom.xml target=_blank> <span class=icon> <i class="fa fa-rss"></i> </span> <span class=label>RSS</span> </a></div></div></div> <footer class=post-footer><div class=post-tags><a href=/tags/csapp/ rel=tag><i class="fa fa-tag"></i> csapp</a><a href=/tags/bomb-lab/ rel=tag><i class="fa fa-tag"></i> bomb lab</a></div><div class=post-nav><div class=post-nav-item><a href=/2022/02/22/%E7%96%AB%E6%83%85%E5%A1%AB%E6%8A%A5%E5%AD%97%E6%AE%B5%E8%A7%A3%E6%9E%90/ rel=prev title=疫情填报字段解析> <i class="fa fa-chevron-left"></i> 疫情填报字段解析 </a></div><div class=post-nav-item><a href=/2022/03/05/nginx%E5%AD%A6%E4%B9%A0/ rel=next title=nginx学习> nginx学习 <i class="fa fa-chevron-right"></i> </a></div></div></footer> <!-- 评论区 --> <div class=comments><div data-id=city data-uid=MTAyMC81MzE5Ny8yOTY3Mg== id=lv-container></div></div> <script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script> <div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div> <aside class=sidebar><div class=sidebar-inner><!-- canvas粒子时钟 --><div><canvas id=canvas style=width:60%;>当前浏览器不支持canvas，请更换浏览器后再试</canvas></div><script>(function(){

   var digit=
    [
        [
            [0,0,1,1,1,0,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,0,1,1,0],
            [0,0,1,1,1,0,0]
        ],//0
        [
            [0,0,0,1,1,0,0],
            [0,1,1,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [1,1,1,1,1,1,1]
        ],//1
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,1,1],
            [1,1,1,1,1,1,1]
        ],//2
        [
            [1,1,1,1,1,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//3
        [
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,0],
            [0,0,1,1,1,1,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,1,1,0],
            [1,1,1,1,1,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,1]
        ],//4
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,1,1,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//5
        [
            [0,0,0,0,1,1,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//6
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0]
        ],//7
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//8
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,1,1,0,0,0,0]
        ],//9
        [
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0]
        ]//:
    ];

var canvas = document.getElementById('canvas');

if(canvas.getContext){
    var cxt = canvas.getContext('2d');
    //声明canvas的宽高
    var H = 100,W = 700;
    canvas.height = H;
    canvas.width = W;
    cxt.fillStyle = '#f00';
    cxt.fillRect(10,10,50,50);

    //存储时间数据
    var data = [];
    //存储运动的小球
    var balls = [];
    //设置粒子半径
    var R = canvas.height/20-1;
    (function(){
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        //存储时间数字，由十位小时、个位小时、冒号、十位分钟、个位分钟、冒号、十位秒钟、个位秒钟这7个数字组成
        data.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
    })();

    /*生成点阵数字*/
    function renderDigit(index,num){
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    cxt.beginPath();
                    cxt.arc(14*(R+2)*index + j*2*(R+1)+(R+1),i*2*(R+1)+(R+1),R,0,2*Math.PI);
                    cxt.closePath();
                    cxt.fill();
                }
            }
        }
    }

    /*更新时钟*/
    function updateDigitTime(){
        var changeNumArray = [];
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        var NewData = [];
        NewData.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
        for(var i = data.length-1; i >=0 ; i--){
            //时间发生变化
            if(NewData[i] !== data[i]){
                //将变化的数字值和在data数组中的索引存储在changeNumArray数组中
                changeNumArray.push(i+'_'+(Number(data[i])+1)%10);
            }
        }
        //增加小球
        for(var i = 0; i< changeNumArray.length; i++){
            addBalls.apply(this,changeNumArray[i].split('_'));
        }
        data = NewData.concat();
    }

    /*更新小球状态*/
    function updateBalls(){
        for(var i = 0; i < balls.length; i++){
            balls[i].stepY += balls[i].disY;
            balls[i].x += balls[i].stepX;
            balls[i].y += balls[i].stepY;
            if(balls[i].x > W + R || balls[i].y > H + R){
                balls.splice(i,1);
                i--;
            }
        }
    }

    /*增加要运动的小球*/
    function addBalls(index,num){
        var numArray = [1,2,3];
        var colorArray =  ["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"];
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    var ball = {
                        x:14*(R+2)*index + j*2*(R+1)+(R+1),
                        y:i*2*(R+1)+(R+1),
                        stepX:Math.floor(Math.random() * 4 -2),
                        stepY:-2*numArray[Math.floor(Math.random()*numArray.length)],
                        color:colorArray[Math.floor(Math.random()*colorArray.length)],
                        disY:1
                    };
                    balls.push(ball);
                }
            }
        }
    }

    /*渲染*/
    function render(){
        //重置画布宽度，达到清空画布的效果
        canvas.height = 100;
        //渲染时钟
        for(var i = 0; i < data.length; i++){
            renderDigit(i,data[i]);
        }
        //渲染小球
        for(var i = 0; i < balls.length; i++){
            cxt.beginPath();
            cxt.arc(balls[i].x,balls[i].y,R,0,2*Math.PI);
            cxt.fillStyle = balls[i].color;
            cxt.closePath();
            cxt.fill();
        }
    }

    clearInterval(oTimer);
    var oTimer = setInterval(function(){
        //更新时钟
        updateDigitTime();
        //更新小球状态
        updateBalls();
        //渲染
        render();
    },50);
}

})();</script><!-- require APlayer --><link href=https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js></script><!-- require MetingJS --><script src=/js/meting-js.js></script><ul class="sidebar-nav motion-element"><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class=nav><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%BC%80%E5%A7%8B%E7%9A%84%E5%87%86%E5%A4%87><span class=nav-number>1.</span> <span class=nav-text>开始的准备</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#objdump%E4%B8%8Egdb%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4><span class=nav-number>1.1.</span> <span class=nav-text>objdump与gdb常用命令</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#objdump><span class=nav-number>1.1.1.</span> <span class=nav-text>objdump</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#gdb><span class=nav-number>1.1.2.</span> <span class=nav-text>gdb</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#readelf><span class=nav-number>1.1.3.</span> <span class=nav-text>readelf</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%AD%A3%E5%BC%8F%E5%BC%80%E5%A7%8B><span class=nav-number>2.</span> <span class=nav-text>正式开始</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#initial-bomb><span class=nav-number>2.1.</span> <span class=nav-text>initial_bomb</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#phase-1><span class=nav-number>2.2.</span> <span class=nav-text>phase_1</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#phase-2><span class=nav-number>2.3.</span> <span class=nav-text>phase_2</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#phase-3><span class=nav-number>2.4.</span> <span class=nav-text>phase_3</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#phase-4><span class=nav-number>2.5.</span> <span class=nav-text>phase_4</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#phase-5><span class=nav-number>2.6.</span> <span class=nav-text>phase_5</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#phase-6><span class=nav-number>2.7.</span> <span class=nav-text>phase_6</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#secret-phase><span class=nav-number>2.8.</span> <span class=nav-text>secret_phase</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E7%BB%93%E6%9D%9F%E8%AF%AD><span class=nav-number>3.</span> <span class=nav-text>结束语</span></a></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop=author itemscope itemtype=http://schema.org/Person><img alt=Sekyoro class=site-author-image itemprop=image src=https://i.loli.net/2021/05/17/YqoavnXdGTpPO9R.jpg><p class=site-author-name itemprop=name>Sekyoro<div class=site-description itemprop=description>什么也无法舍弃的人，什么也做不了.</div></div><div class="site-state-wrap motion-element"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>236</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>16</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>211</span> <span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class=links-of-author-item> <a title="Personal Website → http://proanimer.com" href=http://proanimer.com/ rel=noopener target=_blank><i class="fab fa-internet-explorer fa-fw"></i>Personal Website</a> </span><span class=links-of-author-item> <a title="GitHub → https://github.com/drowning-in-codes" href=https://github.com/drowning-in-codes rel=noopener target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item> <a title="E-Mail → mailto:bukalala174@gmail.com" href=mailto:bukalala174@gmail.com rel=noopener target=_blank><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span><span class=links-of-author-item> <a title="wxPublicAccount → https://mp.weixin.qq.com/s?__biz=Mzg3ODY1MDkzMg==&mid=2247483770&idx=1&sn=fdf88faab01d5c219ac609570a21c9d6&chksm=cf113221f866bb373938cfca03cf095ff4fe1e4dc37d68ef5de4cd4876ee1260fca0c015a4d6&token=1096259873&lang=zh_CN#rd" href=https://mp.weixin.qq.com/s?__biz=Mzg3ODY1MDkzMg==&mid=2247483770&idx=1&sn=fdf88faab01d5c219ac609570a21c9d6&chksm=cf113221f866bb373938cfca03cf095ff4fe1e4dc37d68ef5de4cd4876ee1260fca0c015a4d6&token=1096259873&lang=zh_CN#rd rel=noopener target=_blank><i class="fab fa-weixin fa-fw"></i>wxPublicAccount</a> </span><span class=links-of-author-item> <a title="RSS → /atom.xml" href=/atom.xml><i class="fa fa-rss fa-fw"></i>RSS</a> </span><span class=links-of-author-item> <a title="CSDN → https://blog.csdn.net/aqwca" href=https://blog.csdn.net/aqwca rel=noopener target=_blank><i class="fa fa-handshake fa-fw"></i>CSDN</a> </span><span class=links-of-author-item> <a title="杂鱼分享 → https://my-astro-git-main-drowning-in-codes.vercel.app" href=https://my-astro-git-main-drowning-in-codes.vercel.app/ rel=noopener target=_blank><i class="fas fa-share fa-fw"></i>杂鱼分享</a> </span></div><div class="links-of-blogroll motion-element"><div class=links-of-blogroll-title><i class="fa fa-link fa-fw"></i> 友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=http://myqhs.top/ rel=noopener target=_blank title=http://myqhs.top/>myqhs</a><li class=links-of-blogroll-item><a href=https://www.lllomh.com/ rel=noopener target=_blank title=https://www.lllomh.com/>芈渡</a><li class=links-of-blogroll-item><a href=https://protool-ten.vercel.app/ rel=noopener target=_blank title=https://protool-ten.vercel.app/>protools</a></ul></div><div class="motion-element announcement"><div class=title></div><p class=content><p class=date></div></div><meting-js id=6856787487 order=random server=netease type=playlist> </meting-js><div class=widget-wrap><h3 class=widget-title style=margin:0>文章词云</h3><div class="widget tagcloud" id=myCanvasContainer><canvas height=250 id=resCanvas style=width:100% width=250><ul class=tag-list itemprop=keywords><li class=tag-list-item><a class=tag-list-link href=/tags/bomb-lab/ rel=tag>bomb lab</a><span class=tag-list-count>1</span><li class=tag-list-item><a class=tag-list-link href=/tags/csapp/ rel=tag>csapp</a><span class=tag-list-count>1</span></ul></canvas></div></div><script id=clustrmaps src=https://clustrmaps.com/map_v2.js?d=xQdGTxqARTBiNIwX2aUban-ixkj2s6VaZQWo-aVCgY8&cl=ffffff&w=a></script><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i><span>0%</span></div><!-- 边栏 --></div></aside> <div id=sidebar-dimmer></div> <footer class=footer><div class=footer-inner><div class=copyright>© Wed Apr 08 2020 08:00:00 GMT+0800 (中国标准时间) – <span itemprop=copyrightYear>2025</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>Sekyoro</span><span class=post-meta-divider>|</span><span class=post-meta-item-icon> <i class="fa fa-chart-area"></i> </span><span title=站点总字数>2.4m</span><span class=post-meta-divider>|</span><span class=post-meta-item-icon> <i class="fa fa-coffee"></i> </span><span title=站点阅读时长>36:57</span></div><script async src=https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js></script><span id=busuanzi_container_site_pv>总访问量<span id=busuanzi_value_site_pv></span>次</span><span class=post-meta-divider>|</span><span id=busuanzi_container_site_uv>总访客数<span id=busuanzi_value_site_uv></span>人</span><span class=post-meta-divider>|</span><!-- 不蒜子计数初始值纠正 --><script>$(document).ready(function() {

    var int = setInterval(fixCount, 50);  // 50ms周期检测函数
    var countOffset = 20000;  // 初始化首次数据

    function fixCount() {            
       if (document.getElementById("busuanzi_container_site_pv").style.display != "none")
        {
            $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + countOffset); 
            clearInterval(int);
        }                  
        if ($("#busuanzi_container_site_pv").css("display") != "none")
        {
            $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + countOffset); // 加上初始数据 
            clearInterval(int); // 停止检测
        }  
    }
       	
});</script><div><span id=timeDate>载入天数...</span><span id=times>载入时分秒...</span><script>var now = new Date();
    function createtime() {
        var grt= new Date("04/08/2021 20:00:00");
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
    }
setInterval("createtime()",250);</script></div><div class=busuanzi-count><script async data-pjax src=https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><span style="display: none;" class=post-meta-item id=busuanzi_container_site_uv> <span class=post-meta-item-icon> <i class="fa fa-user"></i> </span> <span class=site-uv title=总访客量> <span id=busuanzi_value_site_uv></span> </span> </span><span class=post-meta-divider>|</span><span style="display: none;" class=post-meta-item id=busuanzi_container_site_pv> <span class=post-meta-item-icon> <i class="fa fa-eye"></i> </span> <span class=site-pv title=总访问量> <span id=busuanzi_value_site_pv></span> </span> </span></div></div></footer> <script color=0,0,255 count=99 opacity=0.5 src=/lib/canvas-nest/canvas-nest.min.js zindex=-1></script> <script src=/lib/anime.min.js></script> <script src=https://cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0/pjax.min.js></script> <script src=https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js></script> <script src=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js></script> <script src=https://cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js></script> <script src=https://cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js></script> <script src=https://cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js></script> <script src=/js/utils.js></script> <script src=/js/motion.js></script> <script src=/js/schemes/pisces.js></script> <script src=/js/next-boot.js></script> <script src=/js/bookmark.js></script> <script>var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax',
	'.widget-wrap'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
 
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});</script> <script data-pjax>(function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();</script> <script src=https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js></script> <script src=https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js></script> <script src=/js/algolia-search.js></script> <script data-pjax>document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});</script> <div id=pjax><script charset=utf-8 defer src=/js/outdate.js></script></div> <script charset=utf-8 defer src=/js/tagcanvas.js></script> <script charset=utf-8 defer src=/js/tagcloud.js></script> <script>NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});</script> <script>var OriginTitile = document.title;
  var titleTime;
  document.addEventListener("visibilitychange", function() {
    if (document.hidden) {
      document.title = "(つェ⊂)我藏好了哦~" + OriginTitile;
      clearTimeout(titleTime);
    } else {
      document.title = "(*´∇｀*) 被你发现啦~" + OriginTitile;
      titleTime = setTimeout(function() {
        document.title = OriginTitile;
      }, 2000);
    }
  });</script> <script src=/js/src/activate-power-mode.min.js></script> <script>POWERMODE.colorful = true;
    POWERMODE.shake = false;
    document.body.addEventListener('input', POWERMODE);</script> 